(self.webpackJsonp=self.webpackJsonp||[]).push([[5],{11:function(e,t,n){"use strict";n.r(t);var r=n(77),i=n(24),o=n(34),u=n(78),a=n(8),c=n(21),s={power:1,chroma:0,tempo:.5,onset:1},l=96;function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class h{constructor(e,t){this.dbMin=e,this.dbMax=t}}f(h,"octave",e=>Math.floor(e/12)),f(h,"chroma",e=>e%12),f(h,"f",e=>{var t=h.octave(e),n=h.chroma(e);return 16.35*2**t*Math.pow(2,1/12)**n});var d=n(72),p=n.n(d),v=n(14);function b(e,t,n,r,i,o,u){try{var a=e[o](u),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}var y=function(){var e,t=(e=function*(e){e instanceof Error?a.error(e):a.error(Object(v.a)(e))},function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function u(e){b(o,r,i,u,a,"next",e)}function a(e){b(o,r,i,u,a,"throw",e)}u(void 0)}))});return function(e){return t.apply(this,arguments)}}();function w(e,t,n,r,i,o,u){try{var a=e[o](u),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class g{constructor(e,t,n){this.ctx=e,m(this,"close",()=>this.ctx.close());var r=new AudioWorkletNode(e,"power",{numberOfInputs:l,channelCountMode:"explicit",channelCount:1});r.port.onmessage=e=>{c.a.mic.value?n.next(e.data):n.next(s)},r.onprocessorerror=e=>{y(e),c.a.mic.value=!1},r.connect(e.destination),c.a.allowedDbs.stream.subscribe(t=>{var{newValue:[n,i]}=t;r.parameters.get("dbMin").setValueAtTime(n,e.currentTime),r.parameters.get("dbMax").setValueAtTime(i,e.currentTime)});for(var i=0;i<l;i++){var o=h.f(i),u=new BiquadFilterNode(e,{type:"bandpass",frequency:o,Q:o/2});t.connect(u).connect(r,0,i)}}}function x(e,t,n,r,i,o,u){try{var a=e[o](u),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}m(g,"create",function(){var e,t=(e=function*(e,t){var n=new AudioContext;yield n.audioWorklet.addModule(p.a);var r=new MediaStreamAudioSourceNode(n,{mediaStream:e});return new g(n,r,t)},function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function u(e){w(o,r,i,u,a,"next",e)}function a(e){w(o,r,i,u,a,"throw",e)}u(void 0)}))});return function(e,n){return t.apply(this,arguments)}}());var O,j=Object(a.getLogger)("Audio"),P=new u.a(s),S=P.asObservable();c.a.mic.stream.subscribe(function(){var e,t=(e=function*(e){var{newValue:t,event:n}=e;if(t){j.info("getting user media");var r=yield navigator.mediaDevices.getUserMedia({audio:!0});j.info("starting new audio graph"),O=yield g.create(r,P)}else j.info("closing audio graph"),O&&(yield O.close()),P.next(s)},function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function u(e){x(o,r,i,u,a,"next",e)}function a(e){x(o,r,i,u,a,"throw",e)}u(void 0)}))});return function(e){return t.apply(this,arguments)}}());var A=n(13);var k=n(30),D=n(15),I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return A.a(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(D.a),M=function(e){function t(t,n,r){var i=e.call(this)||this;return i.parent=t,i.outerValue=n,i.outerIndex=r,i.index=0,i}return A.a(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(D.a),_=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}},E=n(28);function q(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var C=q(),N=n(31);var R=n(44),T=function(e){if(e&&"function"==typeof e[N.a])return i=e,function(e){var t=i[N.a]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if((r=e)&&"number"==typeof r.length&&"function"!=typeof r)return _(e);if(function(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}(e))return n=e,function(e){return n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,E.a),e};if(e&&"function"==typeof e[C])return t=e,function(e){for(var n=t[C]();;){var r=n.next();if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add((function(){n.return&&n.return()})),e};var t,n,r,i,o=Object(R.a)(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+o+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")},V=n(16);function L(e,t,n,r,i){if(void 0===i&&(i=new M(e,n,r)),!i.closed)return t instanceof V.a?t.subscribe(i):T(t)(i)}var B=n(17);function F(e,t){return t?function(e,t){return new V.a((function(n){var r=new B.a,i=0;return r.add(t.schedule((function(){i!==e.length?(n.next(e[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}(e,t):new V.a(_(e))}var J={};var W=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new Y(e,this.resultSelector))},e}(),Y=function(e){function t(t,n){var r=e.call(this,t)||this;return r.resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return A.a(t,e),t.prototype._next=function(e){this.values.push(J),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var n=0;n<t;n++){var r=e[n];this.add(L(this,r,r,n))}}},t.prototype.notifyComplete=function(e){0==(this.active-=1)&&this.destination.complete()},t.prototype.notifyNext=function(e,t,n,r,i){var o=this.values,u=o[n],a=this.toRespond?u===J?--this.toRespond:this.toRespond:0;o[n]=t,0===a&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))},t.prototype._tryResultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(I),Q=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return A.a(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(e){n=!0,r=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,n){return e.call(this)||this}return A.a(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(B.a)),U=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}(),z=new(function(e){function t(n,r){void 0===r&&(r=U.now);var i=e.call(this,n,(function(){return t.delegate&&t.delegate!==i?t.delegate.now():r()}))||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return A.a(t,e),t.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,r,i):e.prototype.schedule.call(this,n,r,i)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(U))(Q);function G(e){var t=e.subscriber,n=e.counter,r=e.period;t.next(n),this.schedule({subscriber:t,counter:n+1,period:r},r)}Math.floor(512);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var X,Z,$,ee=(e,t)=>(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e})({pipe:c.a.pipe.value,theta:c.a.theta.value,h:c.a.h.value,v:c.a.v.value,t:e},t),te=new u.a(ee(0,s)),ne=te.asObservable(),re=0;(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,r=null,i=null;return(n=e[e.length-1])&&"function"==typeof n.schedule&&(i=e.pop()),"function"==typeof e[e.length-1]&&(r=e.pop()),1===e.length&&Object(k.a)(e[0])&&(e=e[0]),F(e,i).lift(new W(r))})(S,(X=1e3/60,void 0===X&&(X=0),void 0===Z&&(Z=z),$=X,(Object(k.a)($)||!($-parseFloat($)+1>=0)||X<0)&&(X=0),Z&&"function"==typeof Z.schedule||(Z=z),new V.a((function(e){return e.add(Z.schedule(G,X,{subscriber:e,counter:0,period:X})),e})))).subscribe(e=>{var[t]=e;c.a.animate.value&&te.next(ee(re++/60,t))},y);var ie=n(2);function oe(e,t,n,r,i,o,u){try{var a=e[o](u),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function ue(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function u(e){oe(o,r,i,u,a,"next",e)}function a(e){oe(o,r,i,u,a,"throw",e)}u(void 0)}))}}n.d(t,"dataStream",(function(){return se}));var ae=Object(a.getLogger)("Data");ae.setDefaultLevel("info");var ce=new r.a,se=ce.asObservable(),le=function(){var e=ue((function*(){console.info("starting web worker data source"),yield Object(o.c)();return{getData:e=>Object(o.b)(e).then(i.a.fromBuffer)}}));return function(){return e.apply(this,arguments)}}();ue((function*(){var e,{getData:t}=yield le(),n=0;ne.subscribe(function(){var r=ue((function*(r){if(!e){Object(ie.a)("params",r),ae.debug("requesting data with params",r),Date.now()-n>=1e3&&(ae.debug("sending request for data with params ".concat(Object(v.a)(r))),n=Date.now()),e=t(r);try{ce.next(yield e)}catch(e){y(e)}finally{e=null}}}));return function(e){return r.apply(this,arguments)}}(),e=>y(e))}))()},72:function(e,t,n){e.exports=n.p+"ee535caaa9d379b9b466.worklet.js"}}]);
//# sourceMappingURL=5.a7d98888401f605434a0.js.map