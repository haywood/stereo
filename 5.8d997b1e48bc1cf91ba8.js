(self.webpackJsonp=self.webpackJsonp||[]).push([[5],{11:function(e,t,n){"use strict";n.r(t);var r=n(74),i=n(21),a=n(30),o=n(75),s=n(8),u=n(18),c={power:.5,chroma:.5},h=96;function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class d{constructor(e,t){this.dbMin=e,this.dbMax=t,l(this,"process",e=>e.map((e,t)=>this.processFrame(e.length?Array.from(e):[0]))),l(this,"processFrame",e=>{var t=this.ampMax(e),n=this.dbs(t),r=this.thresholdAndShift(n);return 1/Math.abs(r)}),l(this,"ampMax",e=>Math.max(...e.map(Math.abs))),l(this,"dbs",e=>10*Math.log2(e)),l(this,"thresholdAndShift",e=>this.dbMax===this.dbMin?e===this.dbMax?-1:-1/0:((e=Math.min(this.dbMax,Math.max(this.dbMin,e)))-this.dbMax)/(e-this.dbMin)-1)}}l(d,"octave",e=>Math.floor(e/12)),l(d,"chroma",e=>e%12),l(d,"f",e=>{var t=d.octave(e),n=d.chroma(e);return 16.35*2**t*Math.pow(2,1/12)**n});var f=n(69),v=n.n(f),p=n(14);function b(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}var y=function(){var e,t=(e=function*(e){e instanceof Error?s.error(e):s.error(Object(p.a)(e))},function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){b(a,r,i,o,s,"next",e)}function s(e){b(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}();function w(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class g{constructor(e,t,n){this.ctx=e,m(this,"close",()=>this.ctx.close());var r=new AudioWorkletNode(e,"power",{numberOfInputs:h,channelCountMode:"explicit",channelCount:1});r.port.onmessage=e=>n.next(e.data),r.onprocessorerror=e=>{y(e),u.a.mic.value=!1},r.connect(e.destination),u.a.allowedDbs.stream.subscribe(t=>{var{newValue:[n,i]}=t;r.parameters.get("dbMin").setValueAtTime(n,e.currentTime),r.parameters.get("dbMax").setValueAtTime(i,e.currentTime)});for(var i=0;i<h;i++){var a=d.f(i),o=new BiquadFilterNode(e,{type:"bandpass",frequency:a,Q:h/a});t.connect(o).connect(r,0,i)}}}function x(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}m(g,"create",function(){var e,t=(e=function*(e,t){var n=new AudioContext;yield n.audioWorklet.addModule(v.a);var r=new MediaStreamAudioSourceNode(n,{mediaStream:e});return new g(n,r,t)},function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){w(a,r,i,o,s,"next",e)}function s(e){w(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(e,n){return t.apply(this,arguments)}}());var M,A=Object(s.getLogger)("Audio"),O=new o.a(c),j=O.asObservable();u.a.mic.stream.subscribe(function(){var e,t=(e=function*(e){var{newValue:t,event:n}=e;if(t){A.info("getting user media");var r=yield navigator.mediaDevices.getUserMedia({audio:!0});A.info("starting new audio graph"),M=yield g.create(r,O)}else A.info("closing audio graph"),M&&(yield M.close()),O.next(c)},function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){x(a,r,i,o,s,"next",e)}function s(e){x(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}());var k=n(42),P=n(13),D=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return P.a(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(e){n=!0,r=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,n){return e.call(this)||this}return P.a(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(n(19).a)),I=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}(),S=new(function(e){function t(n,r){void 0===r&&(r=I.now);var i=e.call(this,n,(function(){return t.delegate&&t.delegate!==i?t.delegate.now():r()}))||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return P.a(t,e),t.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,r,i):e.prototype.schedule.call(this,n,r,i)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(I))(D),q=n(40);function F(e){var t=e.subscriber,n=e.counter,r=e.period;t.next(n),this.schedule({subscriber:t,counter:n+1,period:r},r)}Math.floor(512);var T,V=(e,t)=>{var{power:n,chroma:r}=t;return{pipe:u.a.pipe.value,theta:u.a.theta.value,h:u.a.h.value,v:u.a.v.value,t:e,power:n,chroma:r}},C=new o.a(V(0,c)),E=C.asObservable(),L=0;j.subscribe(e=>T=e,y);var N,_,B;(N=1e3/60,void 0===N&&(N=0),void 0===_&&(_=S),B=N,(Object(q.a)(B)||!(B-parseFloat(B)+1>=0)||N<0)&&(N=0),_&&"function"==typeof _.schedule||(_=S),new k.a((function(e){return e.add(_.schedule(F,N,{subscriber:e,counter:0,period:N})),e}))).subscribe(()=>{u.a.animate.value&&C.next(V(L++/60,T))},y);var J=n(2);function W(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Q(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){W(a,r,i,o,s,"next",e)}function s(e){W(a,r,i,o,s,"throw",e)}o(void 0)}))}}n.d(t,"dataStream",(function(){return G}));var U=Object(s.getLogger)("Data");U.setDefaultLevel("info");var z=new r.a,G=z.asObservable(),H=function(){var e=Q((function*(){console.info("starting web worker data source"),yield Object(a.c)();return{getData:e=>Object(a.b)(e).then(i.a.fromBuffer)}}));return function(){return e.apply(this,arguments)}}();Q((function*(){var e,{getData:t}=yield H(),n=0;E.subscribe(function(){var r=Q((function*(r){if(!e){Object(J.a)("params",r),U.debug("requesting data with params",r),Date.now()-n>=1e3&&(U.debug("sending request for data with params ".concat(Object(p.a)(r))),n=Date.now()),e=t(r);try{z.next(yield e)}catch(e){y(e)}finally{e=null}}}));return function(e){return r.apply(this,arguments)}}(),e=>y(e))}))()},69:function(e,t,n){e.exports=n.p+"748f54fc65a876917a4a.worklet.js"}}]);
//# sourceMappingURL=5.8d997b1e48bc1cf91ba8.js.map