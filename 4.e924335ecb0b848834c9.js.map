{"version":3,"sources":["webpack:///./src/web/overlay/index.ts","webpack:///./src/web/overlay/overlay.scss?78d5","webpack:///./src/web/overlay/overlay.scss","webpack:///./src/web/overlay/overlay.html"],"names":["overlay","constructor","document","createElement","this","hasHover","contains","activeElement","domElement","style","opacity","node","input","Object","values","inputs","el","querySelector","id","assert","setup","fullscreen","disabled","stream","subscribe","newValue","body","requestFullscreen","fullscreenElement","exitFullscreen","selector","onkeydown","event","repeat","target","key","animate","value","mic","innerHTML","html","setupInputs","setupKeyboardShortcuts","querySelectorAll","forEach","onmouseover","onmouseout","api","content","__esModule","default","module","i","options","exported","locals","exports","___CSS_LOADER_API_IMPORT___","push"],"mappings":"gTA2EO,IAAMA,EAAU,IApEvB,MAIEC,cAAc,oBAHQC,SAASC,cAAc,QAG/B,mBAFK,GAEL,sBAiBC,IAAMC,KAAKC,UAAYD,KAAKE,SAASJ,SAASK,gBAjB/C,cAmBP,IAAOH,KAAKI,WAAWC,MAAMC,QAAU,KAnBhC,cAqBP,IAAON,KAAKI,WAAWC,MAAMC,QAAU,KArBhC,kBAuBMC,GAAeP,KAAKI,WAAWF,SAASK,IAvB9C,qBAyBQ,KACpB,IAAK,IAAMC,KAASC,OAAOC,OAAOC,KAAS,CACzC,IAAMC,EAAKZ,KAAKa,cAAL,WAAyCL,EAAMM,KAC1DC,IAAOH,EAAD,0CAAwCJ,EAAMM,KACpDN,EAAMQ,MAAMJ,GAGTD,IAAOM,WAAWC,UACrBP,IAAOM,WAAWE,OAAOC,UAAW,IAAiB,IAAjB,SAAEC,GAAe,EAC/CA,EAAUvB,SAASwB,KAAKC,oBACnBzB,SAAS0B,mBAAmB1B,SAAS2B,qBAnCtC,uBAwC4CC,GACxD1B,KAAKI,WAAWS,cAAiBa,IAzCrB,gCA2CmB,KAC/B5B,SAAS6B,UAAaC,IACpB,IAAIA,EAAMC,SACN7B,KAAKI,WAAWF,SAAS0B,EAAME,QAEnC,OAAQF,EAAMG,KACZ,IAAK,IACHpB,IAAOqB,QAAQC,OAAStB,IAAOqB,QAAQC,MACvC,MACF,IAAK,IACL,IAAK,IACHtB,IAAOuB,IAAID,OAAStB,IAAOuB,IAAID,MAC/B,MACF,IAAK,QACHtB,IAAOM,WAAWgB,OAAStB,IAAOM,WAAWgB,UAxDnDjC,KAAKI,WAAWU,GAAK,UACrBd,KAAKI,WAAW+B,UAAYC,IAE5BpC,KAAKqC,cACLrC,KAAKsC,yBAELtC,KAAKI,WACFmC,iBACC,wDAEDC,QAAQ5B,IACPA,EAAG6B,YAAc,IAAOzC,KAAKC,UAAW,EACxCW,EAAG8B,WAAa,IAAO1C,KAAKC,UAAW,O,mBCxB/C,IAAI0C,EAAM,EAAQ,GACFC,EAAU,EAAQ,IAIC,iBAFvBA,EAAUA,EAAQC,WAAaD,EAAQE,QAAUF,KAG/CA,EAAU,CAAC,CAACG,EAAOC,EAAIJ,EAAS,MAG9C,IAAIK,EAAU,CAEd,OAAiB,OACjB,WAAoB,GAIhBC,GAFSP,EAAII,EAAOC,EAAIJ,EAASK,GAEtBL,EAAQO,OAASP,EAAQO,OAAS,IAIjDJ,EAAOK,QAAUF,G,oBClBjBE,EADkC,EAAQ,EAChCC,EAA4B,IAC9BC,KAAK,CAACP,EAAOC,EAAI,0EAEzBI,EAAQE,KAAK,CAACP,EAAOC,EAAI,2lCAA4lC,KAErnCD,EAAOK,QAAUA,G,iBCPjBL,EAAOK,QAAU","file":"4.e924335ecb0b848834c9.js","sourcesContent":["import './overlay.scss';\n\nimport assert from 'assert';\n\nimport { inputs } from '../inputs';\nimport html from './overlay.html';\n\nclass Overlay {\n  readonly domElement = document.createElement('div');\n  private hasHover = false;\n\n  constructor() {\n    this.domElement.id = 'overlay';\n    this.domElement.innerHTML = html;\n\n    this.setupInputs();\n    this.setupKeyboardShortcuts();\n\n    this.domElement\n      .querySelectorAll<HTMLElement>(\n        'input, textarea, label, i, h2, h1, #allowed_db_range'\n      )\n      .forEach(el => {\n        el.onmouseover = () => (this.hasHover = true);\n        el.onmouseout = () => (this.hasHover = false);\n      });\n  }\n\n  hasAttention = () => this.hasHover || this.contains(document.activeElement);\n\n  show = () => (this.domElement.style.opacity = '1');\n\n  hide = () => (this.domElement.style.opacity = '0');\n\n  private contains = (node: Node) => this.domElement.contains(node);\n\n  private setupInputs = () => {\n    for (const input of Object.values(inputs)) {\n      const el = this.querySelector<HTMLInputElement>(`#${input.id}`);\n      assert(el, `Did not find element for input #${input.id}`);\n      input.setup(el);\n    }\n\n    if (!inputs.fullscreen.disabled) {\n      inputs.fullscreen.stream.subscribe(({ newValue }) => {\n        if (newValue) document.body.requestFullscreen();\n        else if (document.fullscreenElement) document.exitFullscreen();\n      });\n    }\n  };\n\n  private querySelector = <E extends Element = HTMLElement>(selector: string) =>\n    this.domElement.querySelector<E>(selector);\n\n  private setupKeyboardShortcuts = () => {\n    document.onkeydown = (event: KeyboardEvent) => {\n      if (event.repeat) return;\n      if (this.domElement.contains(event.target as Node)) return;\n\n      switch (event.key) {\n        case ' ':\n          inputs.animate.value = !inputs.animate.value;\n          break;\n        case 'm':\n        case 'M':\n          inputs.mic.value = !inputs.mic.value;\n          break;\n        case 'Enter':\n          inputs.fullscreen.value = !inputs.fullscreen.value;\n          break;\n      }\n    };\n  };\n}\n\nexport const overlay = new Overlay();\n","var api = require(\"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js!./overlay.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(module.id, content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\nexports.push([module.id, \"@import url(https://fonts.googleapis.com/icon?family=Material+Icons);\"]);\n// Module\nexports.push([module.id, \"@media print{#overlay{display:none}@page{margin:0;size:landscape}}#overlay{opacity:0}#overlay [title]{cursor:help}#overlay .disabled{cursor:not-allowed}#overlay .disabled i.material-icons{color:gray;cursor:not-allowed}#overlay input:disabled,#overlay textarea:disabled{cursor:not-allowed}#inputs{align-items:flex-end;box-sizing:border-box;display:flex;flex-flow:column wrap;justify-content:flex-start;padding:0px 16px;position:absolute;right:0;top:0}#inputs span,#inputs i{padding-bottom:8px}#inputs section{align-items:flex-end;display:flex;flex-flow:column wrap;justify-content:flex-start}#inputs #pipe{resize:none}#media{bottom:0;box-sizing:border-box;display:flex;flex-flow:row wrap;padding:32px;position:absolute;width:100%}#media i.material-icons{cursor:pointer;display:'none';font-size:36px;margin:0 8px}#allowed_db_range{align-items:center;display:flex;flex-flow:row}#allowed_db_range_input{align-items:center;display:flex;flex-flow:row;margin:0 8px}.spacer{flex:1}a.help{font-size:small;vertical-align:super}a.help::before{content:'?'}a.help:link,a.help:visited,a.help:hover,a.help:active{color:white}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n","module.exports = \"<h1>Stereo</h1>\\n\\n<div id=\\\"inputs\\\">\\n  <section>\\n    <h2 title=\\\"Settings for point generation.\\\">\\n      Point Generation\\n    </h2>\\n    <span>\\n      <label\\n        for=\\\"pipe\\\"\\n        title=\\\"A sequence of operations that determines how the points are initialized and change over time.\\\"\\n      >\\n        Pipe\\n      </label>\\n      <textarea id=\\\"pipe\\\"></textarea>\\n    </span>\\n\\n    <span>\\n      <label\\n        for=\\\"theta\\\"\\n        title=\\\"Intended for use in functions of an angle (e.g. sin, cos, tan, R) to avoid repeating the same expression in multiple places.\\\"\\n      >\\n        Theta\\n      </label>\\n      <input id=\\\"theta\\\" />\\n    </span>\\n  </section>\\n\\n  <section>\\n    <h2 title=\\\"Settings for point color, represented in HSV.\\\">\\n      Color\\n      <a\\n        class=\\\"help\\\"\\n        target=\\\"_blank\\\"\\n        href=\\\"https://en.wikipedia.org/wiki/HSL_and_HSV#/media/File:HSV_color_solid_cylinder_saturation_gray.png\\\"\\n      ></a>\\n    </h2>\\n\\n    <span>\\n      <label for=\\\"h\\\" title=\\\"An expression to determine the HSV hue of a point.\\\">\\n        Hue\\n      </label>\\n      <input id=\\\"h\\\" />\\n    </span>\\n\\n    <span>\\n      <label\\n        for=\\\"v\\\"\\n        title=\\\"An expression to determine the HSV value of a point.\\\"\\n      >\\n        Value\\n      </label>\\n      <input id=\\\"v\\\" />\\n    </span>\\n  </section>\\n</div>\\n\\n<div id=\\\"media\\\">\\n  <span id=\\\"animate\\\">\\n    <i class=\\\"material-icons on\\\">play_arrow</i>\\n    <i class=\\\"material-icons off\\\">pause</i>\\n  </span>\\n\\n  <span id=\\\"mic\\\">\\n    <i\\n      title=\\\"Enable audio analysis. The page will use the browser's microphone to compute the value power and chroma, which describe the volume and musical note of the audio. Each value ranges from 0 to 1.\\\"\\n      class=\\\"material-icons on\\\"\\n    >\\n      mic\\n    </i>\\n    <i title=\\\"Disable audio analysis.\\\" class=\\\"material-icons off\\\">\\n      mic_off\\n    </i>\\n  </span>\\n\\n  <span id=\\\"allowed_db_range\\\">\\n    <div\\n      title=\\\"Minimum volume of analyzed sound. Values below this will be evaluated to 0.\\\"\\n    >\\n      <span class=\\\"min\\\"></span>dB\\n    </div>\\n\\n    <div id=\\\"allowed_db_range_input\\\">\\n      <input type=\\\"range\\\" multiple min=\\\"-200\\\" max=\\\"0\\\" />\\n    </div>\\n\\n    <div\\n      title=\\\"Maximum volumne of analyzed sound. Values above this will be evaluated to 1.\\\"\\n    >\\n      <span class=\\\"max\\\"></span>dB\\n    </div>\\n  </span>\\n\\n  <div class=\\\"spacer\\\"></div>\\n\\n  <span id=\\\"save\\\">\\n    <i class=\\\"material-icons\\\">save_alt</i>\\n  </span>\\n\\n  <span id=\\\"fullscreen\\\">\\n    <i title=\\\"Enter fullscreen.\\\" class=\\\"material-icons on\\\">\\n      fullscreen\\n    </i>\\n    <i title=\\\"Exit fullscreen.\\\" class=\\\"material-icons off\\\">\\n      fullscreen_exit\\n    </i>\\n  </span>\\n</div>\\n\";"],"sourceRoot":""}