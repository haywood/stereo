parcelRequire=function(e){var r="function"==typeof parcelRequire&&parcelRequire,n="function"==typeof require&&require,i={};function u(e,u){if(e in i)return i[e];var t="function"==typeof parcelRequire&&parcelRequire;if(!u&&t)return t(e,!0);if(r)return r(e,!0);if(n&&"string"==typeof e)return n(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return u.register=function(e,r){i[e]=r},i=e(u),u.modules=i,u}(function (require) {function f(a){return a&&a.__esModule?{d:a.default}:{d:a}}var s=this;var e={};const H=Symbol("Comlink.proxy"),fa=Symbol("Comlink.endpoint"),ga=Symbol("Comlink.releaseProxy"),I=new WeakSet,J=new Map([["proxy",{canHandle:e=>e&&e[H],serialize(e){const{port1:r,port2:t}=new MessageChannel;return w(e,r),[t,[t]]},deserialize:e=>(e.start(),ia(e))}],["throw",{canHandle:e=>I.has(e),serialize(e){const r=e instanceof Error;let t=e;return r&&(t={isError:r,message:e.message,stack:e.stack}),[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error,e);throw e}}]]);function w(e,r=self){r.addEventListener("message",function t($){if(!$||!$.data)return;const{id:a,type:n,path:o}=Object.assign({path:[]},$.data),s=($.data.argumentList||[]).map(i);let p;try{const r=o.slice(0,-1).reduce((e,r)=>e[r],e),t=o.reduce((e,r)=>e[r],e);switch(n){case 0:p=t;break;case 1:r[o.slice(-1)[0]]=i($.data.value),p=!0;break;case 2:p=t.apply(r,s);break;case 3:p=ma(new t(...s));break;case 4:{const{port1:r,port2:t}=new MessageChannel;w(e,t),p=la(r,[r])}break;case 5:p=void 0;}}catch(i){p=i,I.add(i)}Promise.resolve(p).catch(e=>(I.add(e),e)).then(e=>{const[$,o]=L(e);r.postMessage(Object.assign(Object.assign({},$),{id:a}),o),5===n&&(r.removeEventListener("message",t),ha(r))})}),r.start&&r.start()}function Va(e){return"MessagePort"===e.constructor.name}function ha(e){Va(e)&&e.close()}function ia(e,r){return K(e,[],r)}function x(e){if(e)throw new Error("Proxy has been released and is not useable")}function K(e,r=[],t=function(){}){let $=!1;const a=new Proxy(t,{get(t,n){if(x($),n===ga)return()=>q(e,{type:5,path:r.map(e=>e.toString())}).then(()=>{ha(e),$=!0});if("then"===n){if(0===r.length)return{then:()=>a};const t=q(e,{type:0,path:r.map(e=>e.toString())}).then(i);return t.then.bind(t)}return K(e,[...r,n])},set(t,a,n){x($);const[o,s]=L(n);return q(e,{type:1,path:[...r,a].map(e=>e.toString()),value:o},s).then(i)},apply(t,a,n){x($);const o=r[r.length-1];if(o===fa)return q(e,{type:4}).then(i);if("bind"===o)return K(e,r.slice(0,-1));const[s,p]=ja(n);return q(e,{type:2,path:r.map(e=>e.toString()),argumentList:s},p).then(i)},construct(t,a){x($);const[n,o]=ja(a);return q(e,{type:3,path:r.map(e=>e.toString()),argumentList:n},o).then(i)}});return a}function Wa(e){return Array.prototype.concat.apply([],e)}function ja(e){const r=e.map(L);return[r.map(e=>e[0]),Wa(r.map(e=>e[1]))]}const ka=new WeakMap;function la(e,r){return ka.set(e,r),e}function ma(e){return Object.assign(e,{[H]:!0})}function Xa(e,r=self,t="*"){return{postMessage:(r,$)=>e.postMessage(r,t,$),addEventListener:r.addEventListener.bind(r),removeEventListener:r.removeEventListener.bind(r)}}function L(e){for(const[r,t]of J)if(t.canHandle(e)){const[$,a]=t.serialize(e);return[{type:3,name:r,value:$},a]}return[{type:0,value:e},ka.get(e)||[]]}function i(e){switch(e.type){case 3:return J.get(e.name).deserialize(e.value);case 0:return e.value;}}function q(e,r,t){return new Promise($=>{const a=Ya();e.addEventListener("message",function r(t){t.data&&t.data.id&&t.data.id===a&&(e.removeEventListener("message",r),$(t.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:a},r),t)})}function Ya(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}e.wrap=ia,e.windowEndpoint=Xa,e.transferHandlers=J,e.transfer=la,e.releaseProxy=ga,e.proxyMarker=H,e.proxy=ma,e.expose=w,e.createEndpoint=fa;var Za={},na=Object.getOwnPropertySymbols,$a=Object.prototype.hasOwnProperty,_a=Object.prototype.propertyIsEnumerable;function ab(r){if(null==r)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(r)}function bb(){try{if(!Object.assign)return!1;var r=new String("abc");if(r[5]="de","5"===Object.getOwnPropertyNames(r)[0])return!1;for(var e={},t=0;t<10;t++)e["_"+String.fromCharCode(t)]=t;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(r){return e[r]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(r){n[r]=r}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(o){return!1}}Za=bb()?Object.assign:function(r,e){for(var t,n,o=ab(r),a=1;a<arguments.length;a++){for(var $ in t=Object(arguments[a]))$a.call(t,$)&&(o[$]=t[$]);if(na){n=na(t);for(var s=0;s<n.length;s++)_a.call(t,n[s])&&(o[n[s]]=t[n[s]])}}return o};var cb={};cb=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8};var oa={};oa="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};var n,o,t={},c=t={};function M(){throw new Error("setTimeout has not been defined")}function N(){throw new Error("clearTimeout has not been defined")}function pa($){if(n===setTimeout)return setTimeout($,0);if((n===M||!n)&&setTimeout)return n=setTimeout,setTimeout($,0);try{return n($,0)}catch(e){try{return n.call(null,$,0)}catch(e){return n.call(this,$,0)}}}function db($){if(o===clearTimeout)return clearTimeout($);if((o===N||!o)&&clearTimeout)return o=clearTimeout,clearTimeout($);try{return o($)}catch(e){try{return o.call(null,$)}catch(e){return o.call(this,$)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:M}catch($){n=M}try{o="function"==typeof clearTimeout?clearTimeout:N}catch($){o=N}}();var r,l=[],O=!1,qa=-1;function eb(){O&&r&&(O=!1,r.length?l=r.concat(l):qa=-1,l.length&&ra())}function ra(){if(!O){var $=pa(eb);O=!0;for(var e=l.length;e;){for(r=l,l=[];++qa<e;)r&&r[qa].run();qa=-1,e=l.length}r=null,O=!1,db($)}}function sa($,e){this.fun=$,this.array=e}function h(){}c.nextTick=function($){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];l.push(new sa($,e)),1!==l.length||O||pa(ra)},sa.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.env={},c.argv=[],c.version="",c.versions={},c.on=h,c.addListener=h,c.once=h,c.off=h,c.removeListener=h,c.removeAllListeners=h,c.emit=h,c.prependListener=h,c.prependOnceListener=h,c.listeners=function($){return[]},c.binding=function($){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function($){throw new Error("process.chdir is not supported")},c.umask=function(){return 0};var a={},fb=/%[sdj%]/g,P=function(r){if(!B(r)){for(var $=[],e=0;e<arguments.length;e++)$.push(k(arguments[e]));return $.join(" ")}e=1;for(var t=arguments,n=t.length,i=String(r).replace(fb,function(r){if("%%"===r)return"%";if(e>=n)return r;switch(r){case"%s":return String(t[e++]);case"%d":return Number(t[e++]);case"%j":try{return JSON.stringify(t[e++])}catch($){return"[Circular]"}default:return r;}}),o=t[e];e<n;o=t[++e])z(o)||!p(o)?i+=" "+o:i+=" "+k(o);return i};a.format=P;var ta=function(r,$){if(j(s.process))return function(){return ta(r,$).apply(this,arguments)};if(!0===t.noDeprecation)return r;var e=!1;return function(){if(!e){if(t.throwDeprecation)throw new Error($);t.traceDeprecation?console.trace($):console.error($),e=!0}return r.apply(this,arguments)}};a.deprecate=ta;var ua,y={},gb=function(r){if(j(ua)&&(ua=""),r=r.toUpperCase(),!y[r])if(new RegExp("\\b"+r+"\\b","i").test(ua)){var $=t.pid;y[r]=function(){var e=P.apply(a,arguments);console.error("%s %d: %s",r,$,e)}}else y[r]=function(){};return y[r]};function k(r,$){var e={seen:[],stylize:ib};return arguments.length>=3&&(e.depth=arguments[2]),arguments.length>=4&&(e.colors=arguments[3]),T($)?e.showHidden=$:$&&ya(e,$),j(e.showHidden)&&(e.showHidden=!1),j(e.depth)&&(e.depth=2),j(e.colors)&&(e.colors=!1),j(e.customInspect)&&(e.customInspect=!0),e.colors&&(e.stylize=hb),A(e,r,e.depth)}a.debuglog=gb;var Q=k;function hb(r,$){var e=k.styles[$];return e?"\x1B["+k.colors[e][0]+"m"+r+"\x1B["+k.colors[e][1]+"m":r}function ib(r,$){return r}function jb(r){var $={};return r.forEach(function(r,e){$[r]=!0}),$}function A(r,$,e){if(r.customInspect&&$&&F($.inspect)&&$.inspect!==Q&&(!$.constructor||$.constructor.prototype!==$)){var t=$.inspect(e,r);return B(t)||(t=A(r,t,e)),t}var n=kb(r,$);if(n)return n;var i=Object.keys($),o=jb(i);if(r.showHidden&&(i=Object.getOwnPropertyNames($)),E($)&&(i.indexOf("message")>=0||i.indexOf("description")>=0))return R($);if(0===i.length){if(F($)){var a=$.name?": "+$.name:"";return r.stylize("[Function"+a+"]","special")}if(C($))return r.stylize(RegExp.prototype.toString.call($),"regexp");if(V($))return r.stylize(Date.prototype.toString.call($),"date");if(E($))return R($)}var s,z="",p=!1,D=["{","}"];(va($)&&(p=!0,D=["[","]"]),F($))&&(z=" [Function"+($.name?": "+$.name:"")+"]");return C($)&&(z=" "+RegExp.prototype.toString.call($)),V($)&&(z=" "+Date.prototype.toUTCString.call($)),E($)&&(z=" "+R($)),0!==i.length||p&&0!=$.length?e<0?C($)?r.stylize(RegExp.prototype.toString.call($),"regexp"):r.stylize("[Object]","special"):(r.seen.push($),s=p?lb(r,$,e,o,i):i.map(function(t){return S(r,$,e,o,t,p)}),r.seen.pop(),mb(s,z,D)):D[0]+z+D[1]}function kb(r,$){if(j($))return r.stylize("undefined","undefined");if(B($)){var e="'"+JSON.stringify($).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,"\"")+"'";return r.stylize(e,"string")}return wa($)?r.stylize(""+$,"number"):T($)?r.stylize(""+$,"boolean"):z($)?r.stylize("null","null"):void 0}function R(r){return"["+Error.prototype.toString.call(r)+"]"}function lb(r,$,e,t,n){for(var i=[],o=0,a=$.length;o<a;++o)za($,String(o))?i.push(S(r,$,e,t,String(o),!0)):i.push("");return n.forEach(function(n){n.match(/^\d+$/)||i.push(S(r,$,e,t,n,!0))}),i}function S(r,$,e,t,n,i){var o,a,s;if((s=Object.getOwnPropertyDescriptor($,n)||{value:$[n]}).get?a=s.set?r.stylize("[Getter/Setter]","special"):r.stylize("[Getter]","special"):s.set&&(a=r.stylize("[Setter]","special")),za(t,n)||(o="["+n+"]"),a||(r.seen.indexOf(s.value)<0?(a=z(e)?A(r,s.value,null):A(r,s.value,e-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map(function(r){return"  "+r}).join("\n").substr(2):"\n"+a.split("\n").map(function(r){return"   "+r}).join("\n")):a=r.stylize("[Circular]","special")),j(o)){if(i&&n.match(/^\d+$/))return a;(o=JSON.stringify(""+n)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=r.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,"\"").replace(/(^"|"$)/g,"'"),o=r.stylize(o,"string"))}return o+": "+a}function mb(r,$,e){return r.reduce(function(r,$){return 0,$.indexOf("\n")>=0&&0,r+$.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?e[0]+(""===$?"":$+"\n ")+" "+r.join(",\n  ")+" "+e[1]:e[0]+$+" "+r.join(", ")+" "+e[1]}function va(r){return Array.isArray(r)}a.inspect=Q,k.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},k.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var nb=va;function T(r){return"boolean"==typeof r}a.isArray=nb;var ob=T;function z(r){return null===r}a.isBoolean=ob;var pb=z;function qb(r){return null==r}a.isNull=pb;var rb=qb;function wa(r){return"number"==typeof r}a.isNullOrUndefined=rb;var sb=wa;function B(r){return"string"==typeof r}a.isNumber=sb;var tb=B;function ub(r){return"symbol"==typeof r}a.isString=tb;var vb=ub;function j(r){return void 0===r}a.isSymbol=vb;var wb=j;function C(r){return p(r)&&"[object RegExp]"===Z(r)}a.isUndefined=wb;var U=C;function p(r){return"object"==typeof r&&null!==r}a.isRegExp=U;var xb=p;function V(r){return p(r)&&"[object Date]"===Z(r)}a.isObject=xb;var W=V;function E(r){return p(r)&&("[object Error]"===Z(r)||r instanceof Error)}a.isDate=W;var xa=E;function F(r){return"function"==typeof r}a.isError=xa;var X=F;function yb(r){return null===r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||"symbol"==typeof r||void 0===r}a.isFunction=X;var Y=yb;a.isPrimitive=Y;function Z(r){return Object.prototype.toString.call(r)}function _(r){return r<10?"0"+r.toString(10):r.toString(10)}a.isBuffer=cb;var zb=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Ab(){var r=new Date,$=[_(r.getHours()),_(r.getMinutes()),_(r.getSeconds())].join(":");return[r.getDate(),zb[r.getMonth()],$].join(" ")}var Bb=function(){console.log("%s - %s",Ab(),P.apply(a,arguments))};a.log=Bb;a.inherits=oa;var ya=function(r,$){if(!$||!p($))return r;for(var e=Object.keys($),t=e.length;t--;)r[e[t]]=$[e[t]];return r};function za(r,$){return Object.prototype.hasOwnProperty.call(r,$)}a._extend=ya;var d={};function Aa(r,$){if(r===$)return 0;for(var t=r.length,e=$.length,a=0,i=Math.min(t,e);a<i;++a)if(r[a]!==$[a]){t=r[a],e=$[a];break}return t<e?-1:e<t?1:0}function u(r){return s.Buffer&&"function"==typeof s.Buffer.isBuffer?s.Buffer.isBuffer(r):!(null==r||!r._isBuffer)}var Cb=Object.prototype.hasOwnProperty,Ba=Array.prototype.slice,Ca="foo"===function(){}.name;function Da(r){return Object.prototype.toString.call(r)}function Ea(r){return!u(r)&&"function"==typeof s.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(r):!!r&&(r instanceof DataView||!!(r.buffer&&r.buffer instanceof ArrayBuffer)))}var b=d=Ia,Db=/\s*function\s+([^\(\s]*)\s*/;function Fa(r){if(X(r)){if(Ca)return r.name;var $=r.toString().match(Db);return $&&$[1]}}function Ga(r,$){return"string"==typeof r?r.length<$?r:r.slice(0,$):r}function Ha(r){if(Ca||!X(r))return Q(r);var $=Fa(r);return"[Function"+($?": "+$:"")+"]"}function Eb(r){return Ga(Ha(r.actual),128)+" "+r.operator+" "+Ga(Ha(r.expected),128)}function g(r,$,t,e,a){throw new b.AssertionError({message:t,actual:r,expected:$,operator:e,stackStartFunction:a})}function Ia(r,$){r||g(r,!0,$,"==",b.ok)}function v(r,$,t,e){if(r===$)return!0;if(u(r)&&u($))return 0===Aa(r,$);if(W(r)&&W($))return r.getTime()===$.getTime();if(U(r)&&U($))return r.source===$.source&&r.global===$.global&&r.multiline===$.multiline&&r.lastIndex===$.lastIndex&&r.ignoreCase===$.ignoreCase;if(null!==r&&"object"==typeof r||null!==$&&"object"==typeof $){if(Ea(r)&&Ea($)&&Da(r)===Da($)&&!(r instanceof Float32Array||r instanceof Float64Array))return 0===Aa(new Uint8Array(r.buffer),new Uint8Array($.buffer));if(u(r)!==u($))return!1;var a=(e=e||{actual:[],expected:[]}).actual.indexOf(r);return-1!==a&&a===e.expected.indexOf($)||(e.actual.push(r),e.expected.push($),Fb(r,$,t,e))}return t?r===$:r==$}function Ja(r){return"[object Arguments]"==Object.prototype.toString.call(r)}function Fb(r,$,t,e){if(null==r||null==$)return!1;if(Y(r)||Y($))return r===$;if(t&&Object.getPrototypeOf(r)!==Object.getPrototypeOf($))return!1;var a=Ja(r),i=Ja($);if(a&&!i||!a&&i)return!1;if(a)return v(r=Ba.call(r),$=Ba.call($),t);var n,s,u=Oa(r),o=Oa($);if(u.length!==o.length)return!1;for(u.sort(),o.sort(),s=u.length-1;s>=0;s--)if(u[s]!==o[s])return!1;for(s=u.length-1;s>=0;s--)if(!v(r[n=u[s]],$[n],t,e))return!1;return!0}function Ka(r,$,t){v(r,$,!0)&&g(r,$,t,"notDeepStrictEqual",Ka)}function La(r,$){if(!r||!$)return!1;if("[object RegExp]"==Object.prototype.toString.call($))return $.test(r);try{if(r instanceof $)return!0}catch(t){}return!Error.isPrototypeOf($)&&!0===$.call({},r)}function Gb(r){var $;try{r()}catch(t){$=t}return $}function Ma(r,$,t,e){var a;if("function"!=typeof $)throw new TypeError("\"block\" argument must be a function");"string"==typeof t&&(e=t,t=null),a=Gb($),e=(t&&t.name?" ("+t.name+").":".")+(e?" "+e:"."),r&&!a&&g(a,t,"Missing expected exception"+e);var i="string"==typeof e,n=!r&&a&&!t;if((!r&&xa(a)&&i&&La(a,t)||n)&&g(a,t,"Got unwanted exception"+e),r&&a&&t&&!La(a,t)||!r&&a)throw a}function Na(r,$){r||g(r,!0,$,"==",Na)}b.AssertionError=function(r){this.name="AssertionError",this.actual=r.actual,this.expected=r.expected,this.operator=r.operator,r.message?(this.message=r.message,this.generatedMessage=!1):(this.message=Eb(this),this.generatedMessage=!0);var $=r.stackStartFunction||g;if(Error.captureStackTrace)Error.captureStackTrace(this,$);else{var t=new Error;if(t.stack){var e=t.stack,a=Fa($),i=e.indexOf("\n"+a);if(i>=0){var n=e.indexOf("\n",i+1);e=e.substring(n+1)}this.stack=e}}},oa(b.AssertionError,Error),b.fail=g,b.ok=Ia,b.equal=function(r,$,t){r!=$&&g(r,$,t,"==",b.equal)},b.notEqual=function(r,$,t){r==$&&g(r,$,t,"!=",b.notEqual)},b.deepEqual=function(r,$,t){v(r,$,!1)||g(r,$,t,"deepEqual",b.deepEqual)},b.deepStrictEqual=function(r,$,t){v(r,$,!0)||g(r,$,t,"deepStrictEqual",b.deepStrictEqual)},b.notDeepEqual=function(r,$,t){v(r,$,!1)&&g(r,$,t,"notDeepEqual",b.notDeepEqual)},b.notDeepStrictEqual=Ka,b.strictEqual=function(r,$,t){r!==$&&g(r,$,t,"===",b.strictEqual)},b.notStrictEqual=function(r,$,t){r===$&&g(r,$,t,"!==",b.notStrictEqual)},b.throws=function(r,$,t){Ma(!0,r,$,t)},b.doesNotThrow=function(r,$,t){Ma(!1,r,$,t)},b.ifError=function(r){if(r)throw r},b.strict=Za(Na,b,{equal:b.strictEqual,deepEqual:b.deepStrictEqual,notEqual:b.notStrictEqual,notDeepEqual:b.notDeepStrictEqual}),b.strict.strict=b.strict;var Oa=Object.keys||function(r){var $=[];for(var t in r)Cb.call(r,t)&&$.push(t);return $};var $={};function aa(e,r,s){if(!e)throw{message:s(),scope:r}}var ba={};const Pa=Math.pow(2,32)-1;ba.inf=Pa;class D{constructor(t){var $VCAb$$interop$default=f(d);this.fns=t,this.sample=function*(t,s,e){const{fns:n,d:r}=this,[i,...o]=n;if(0==n.length)return[];for(const a of i.sample(t,s,e))this.x.set(a),o.length?$YDUe$export$CompositeFn.apply(o,this.x,this.y):this.y.set(a),yield this.y.subarray(0,r)},this.fn=(t,s=new Float32Array(this.d))=>{const{fns:e,domain:n,d:r}=this;var $VCAb$$interop$default=f(d);return $VCAb$$interop$default.d.equal(t.length,n),$VCAb$$interop$default.d.equal(s.length,r),this.x.set(t),$YDUe$export$CompositeFn.apply(e,this.x,this.y),s.set(this.y.subarray(0,r)),s},$VCAb$$interop$default.d(t.length,"fns cannot be empty");const s=Math.max(this.domainMax,this.dMax);this.x=new Float32Array(s),this.y=new Float32Array(s)}get first(){return this.fns[0]}get last(){return this.fns[this.fns.length-1]}get domain(){return this.first.domain}get d(){return this.last.d}get domainMax(){return this.fns.reduce((t,s)=>Math.max(s.domain,t),0)}get dMax(){return this.fns.reduce((t,s)=>Math.max(s.d,t),0)}}D.apply=(t,s,e)=>{var $VCAb$$interop$default=f(d);$VCAb$$interop$default.d.equal(s.length,e.length);for(const n of t){n.fn(s.subarray(0,n.domain),e.subarray(0,n.d));for(let t=0;t<e.length;t++)isFinite(e[t])||(e[t]=Math.sign(e[t])*Pa),isNaN(e[t])&&(e[t]=0);s.set(e)}},D.Builder=class{constructor(){this.fns=[],this.add=t=>{const{fns:s,last:e}=this;if(e&&t.domain!==e.d)throw new Error(`Cannot add ${t} to composite, because its domain is not ${e.d}`);return s.push(t),this},this.build=()=>new D(this.fns)}get d(){return this.last.d}get last(){return this.fns[this.fns.length-1]}};class ca{constructor(t,e,r){var $VCAb$$interop$default=f(d);this.d=t,this.a=e,this.b=r,this.fn=(t,e=new Float32Array(this.d))=>{const{domain:r,d:a,a:o,b:s}=this;var $VCAb$$interop$default=f(d);$VCAb$$interop$default.d.equal(t.length,r),$VCAb$$interop$default.d.equal(e.length,a);for(let $=0;$<a;$++)e[$]=o[$]+t[$]*(s[$]-o[$]);return e},this.sample=function*(t,e,r){const{d:a,fn:o}=this,s=Math.round(Math.pow(t,1/a)),$=new Float32Array(a);for(let u=e;u<r;u++){for(let t=0;t<a;t++){const e=a-t-1,r=Math.round(u/Math.pow(s,e));$[t]=r%s/(s-1)}yield o($)}},$VCAb$$interop$default.d.equal(e.length,t),$VCAb$$interop$default.d.equal(r.length,t),this.domain=t}}ca.nPerLevel=(t,e)=>Math.round(Math.pow(e,1/t));class m{constructor(t,e){this.d=t,this.l=e,this.fn=(t,e)=>this.interval.fn(t,e),this.interval=new ca(t,new Array(t).fill(-e/2),new Array(t).fill(e/2)),this.sample=this.interval.sample}get domain(){return this.d}}class Hb{constructor(t,e){this.d=t,this.l=e,this.fn=(t,e=new Float32Array(this.d))=>{const{domain:r,d:s,l:a}=this;var $VCAb$$interop$default=f(d);$VCAb$$interop$default.d.equal(t.length,r),$VCAb$$interop$default.d.equal(e.length,s);for(let o=0;o<s;o++)e[o]=a*(t[o]-.5);return e},this.sample=function*(t,e,r){const{d:s}=this,a=1/s/2,o=Math.round(t*a),n=Math.round(e*a),i=Math.round((r-e)*a);let l=0;for(let $=0;$<s;$++)for(const e of[1,-1]){const r=n+Math.min(i,t-l);yield*this.sampleFace($,e,o,n,r),l+=r-n}},this.sampleFace=function*(t,e,r,s,a){const{d:o,l:n}=this,i=new m(o-1,n),l=n/2;for(const $ of i.sample(r,s,a)){const r=new Float32Array(o);r.set($.subarray(0,t)),r.set($.subarray(t),t+1),r[t]=e*l,yield r}}}get domain(){return this.d}}class Qa{static from(r,t,e=new Float32Array(t.length+1)){var $VCAb$$interop$default=f(d);$VCAb$$interop$default.d.equal(e.length,t.length+1),e[0]=r;for(let $=1;$<e.length;$++){const r=Math.sin(t[$-1]),a=Math.cos(t[$-1]);e[$]=e[0]*r,e[0]*=a}return e}}class G{constructor(t,r){this.d=t,this.r=r,this.sample=function*(t,r,e){const $=new m(this.domain,2*Math.PI);for(const s of $.sample(t,r,e))yield this.fn(s)},this.fn=(t,r=new Float32Array(this.d))=>{const{d:e,r:$}=this;var $VCAb$$interop$default=f(d);return $VCAb$$interop$default.d.equal(t.length,e-1),$VCAb$$interop$default.d.equal(r.length,e),Qa.from($,t,r)}}get domain(){return this.d-1}}class Ib{constructor(e,t,r){this.d=e,this.r=t,this.t=r,this.sample=function*(e,t,r){const s=new m(this.domain,2*Math.PI);for(const $ of s.sample(e,t,r))yield this.fn($)},this.fn=(e,t=new Float32Array(this.d))=>{const{domain:r,d:s,sphere:$,circle:i}=this;var $VCAb$$interop$default=f(d);$VCAb$$interop$default.d.equal(e.length,r),$VCAb$$interop$default.d.equal(t.length,s),$.fn(e,t);const a=i.fn(e.subarray(s-2));return t[0]+=a[0],t[s-1]+=a[1],t},this.sphere=new G(e,r),this.circle=new G(2,t)}get domain(){return this.d-1}}class Ra{constructor(t,s,e,r,i=Math.cos,a=Math.sin){this.d=t,this.theta=s,this.d0=e,this.d1=r,this.f0=i,this.f1=a,this.sample=function*(t,s,e){const r=new m(this.domain,2);for(const i of r.sample(t,s,e))yield this.fn(i)},this.fn=(t,s=new Float32Array(this.d))=>{const{d:e,d0:r,d1:i,r0:a,r1:$}=this;var $VCAb$$interop$default=f(d);$VCAb$$interop$default.d.equal(t.length,e),$VCAb$$interop$default.d.equal(s.length,e),s.set(t);const h=t[r],o=t[i];return s[r]=h*a-o*$,s[i]=h*$+o*a,s},this.r0=i(s),this.r1=a(s)}get domain(){return this.d}}class Jb{constructor(t,e,i){var $VCAb$$interop$default=f(d);this.d=t,this.theta=e,this.a=i,this.sample=function*(t,e,i){const r=new ca(this.domain,new Array(this.domain).fill(0),new Array(this.domain).fill(1));for(const a of r.sample(t,e,i))yield this.fn(a)},this.fn=(t,e=new Float32Array(this.d))=>{const{domain:i,d:r,theta:a,a:s}=this;var $VCAb$$interop$default=f(d);$VCAb$$interop$default.d.equal(t.length,i),$VCAb$$interop$default.d.equal(e.length,r);const $=t.map(t=>t*a);Qa.from(1,$,e),e[0]*=s[0]*$[0];for(let o=1;o<r;o++)e[o]*=s[o]*$[o-1];return e},$VCAb$$interop$default.d.equal(i.length,t,`spiral: Expected a to be of dimension ${t}, but was ${i.length}`)}get domain(){return this.d-1}}class da{constructor(t,e){this.from=t,this.to=e,this.sample=function*(t,e,r){const a=new m(this.domain,2);for(const o of a.sample(t,e,r))yield this.fn(o)},this.fn=(t,e=new Float32Array(this.to))=>{let{from:r,to:a,fromTemp:o,toTemp:$}=this;var $VCAb$$interop$default=f(d);if($VCAb$$interop$default.d.equal(t.length,r),$VCAb$$interop$default.d.equal(e.length,a),r===a)return e.set(t),e;for(o.set(t);r<a;)$LUcK$export$default.up(o.subarray(0,r),$.subarray(0,++r)),o.set($);for(;r>a;)$LUcK$export$default.down(o.subarray(0,r),$.subarray(0,--r)),o.set($);return e.set($.subarray(0,a)),e},this.fromTemp=new Float32Array(Math.max(t,e)),this.toTemp=new Float32Array(Math.max(t,e))}get domain(){return this.from}get d(){return this.to}}da.up=(t,e)=>{var $VCAb$$interop$default=f(d);$VCAb$$interop$default.d.equal(e.length,t.length+1);const r=Kb(t),a=r+1;e[0]=(r-1)/a;for(let o=1;o<=t.length;o++)e[o]=2*t[o-1]/a},da.down=(t,e)=>{var $VCAb$$interop$default=f(d);$VCAb$$interop$default.d.equal(e.length,t.length-1);for(let r=0;r<e.length;r++)e[r]=t[r+1]/(1-t[0])};const Kb=t=>{let e=0;for(let r=0;r<t.length;r++)e+=t[r]*t[r];return e};class Lb{constructor(t,r){var $VCAb$$interop$default=f(d);this.d=t,this.r=r,this.sample=function*(t,r,e){const $=new m(this.domain,2*Math.PI);for(const s of $.sample(t,r,e))yield this.fn(s)},this.fn=(t,r=new Float32Array(this.d))=>{const{d:e,domain:$,r:s}=this;new G(2,s[0]).fn(t.subarray(0,1),r.subarray(0,2));for(let a=1;a<$;a++){r[0]+=s[a],new Ra(e,t[a],a-1,a+1).fn(r,r)}return r},$VCAb$$interop$default.d(t>2,`torus: expected d = ${t} > 2`),$VCAb$$interop$default.d(r.length==this.domain,`torus: expected r.length = ${r.length} == ${this.domain}`)}get domain(){return this.d-1}}var ea={};const Sa=(p,$=2)=>JSON.stringify(p,null,$);ea.pp=Sa;class Ta{constructor(e){this.scope=e,this.resolvePipe=e=>{const[r,...s]=e.steps,t=this.resolve(e.n,"number");this.expect(t>0,"n","be positive",`was ${t}`);const a=new D.Builder().add(this.resolveStep(e.d0,r));for(let i=0;i<s.length;i++){const e=s[i],r=a.d,t=Ob[e.type](r);a.add(this.resolveStep(t,e))}return{n:t,fn:a.build()}},this.resolveStep=(e,{type:r,args:s})=>Nb[r](e,...s.map(e=>this.resolve(e))),this.resolveFn=({name:e,args:r})=>{const s=Math[e],t=typeof s;return this.expect("function"===t,e,"resolve to a function",`was ${t}`),s(...r.map(e=>this.resolve(e)))},this.resolveAccess=({id:e,index:r})=>{const s=this.scope[e];return this.assert(s,()=>`failed to resolve access target ${e}`),"id"===r.kind&&r.id in s?s[r.id]:s[this.resolve(r)]},this.resolveId=e=>{let r;if(e in this.scope)r=this.scope[e];else if(e in Math)r=Math[e];else{const s=e.toUpperCase();s in Math&&(r=Math[s])}return this.assert(r,()=>`failed to resolve id ${e}`),r},this.resolveArith=({op:e,operands:r})=>{const[s,t]=r.map(e=>this.resolve(e,"number"));return Mb[e](s,t)},this.isNodeDynamic=e=>{switch(e.kind){case"fn":return e.args.some(this.isNodeDynamic);case"id":return"number"==typeof this.resolve(e);case"arith":return e.operands.some(this.isNodeDynamic);default:return!1;}}}resolve(e,r){let s;switch(e.kind){case"pipe":s=this.resolvePipe(e);break;case"arith":s=this.resolveArith(e);break;case"number":s=e.value;break;case"fn":s=this.resolveFn(e);break;case"access":s=this.resolveAccess(e);break;case"id":s=this.resolveId(e.id);break;case"paren":s=this.resolve(e.scalar);}if(r){const t=typeof s;this.expect(t===r,e,`be a ${r}`,`was ${t}`)}return"number"===r&&this.expect(!isNaN(s),e,"be a number","was NaN"),s}assert(e,r){aa(e,this.scope,r)}expect(e,r,s,t){this.assert(e,()=>`Expected ${Sa(r,0)} to ${s}, but ${t}`)}}$.Resolver=Ta;const Mb={"+":(e,r)=>e+r,"-":(e,r)=>null==r?-e:e-r,"*":(e,r)=>e*r,"/":(e,r)=>e/r,"**":(e,r)=>Math.pow(e,r),"^":(e,r)=>Math.pow(e,r)},Nb={cube:(e,r)=>new Hb(e,r),lattice:(e,r)=>new m(e,r),sphere:(e,r)=>new G(e,r),spiral:(e,r,...s)=>new Jb(e,r,s),torus:(e,...r)=>new Lb(e,new Float32Array(r)),fucked_up_torus:(e,r,s)=>new Ib(e,r,s),rotate:(e,r,s,t,a=Math.cos,i=Math.sin)=>(aa(0<=s&&s<e,null,()=>`rotate: Expected 0 <= d0 = ${s} < d = ${e}`),aa(0<=t&&t<e,null,()=>`rotate: Expected 0 <= d1 = ${t} < d = ${e}`),new Ra(e,r,s,t,a,i)),stereo:(e,r)=>new da(e,r)},Ob={cube:e=>e,lattice:e=>e,sphere:e=>e+1,spiral:e=>e+1,torus:e=>e+1,fucked_up_torus:e=>e+1,rotate:e=>e,r:e=>e,stereo:e=>e};const{abs:Ua,min:Pb,sign:Qb}=Math;class Ub extends Error{constructor(t,e){var s;super(null===(s=e)||void 0===s?void 0:s.message),this.context=t,this.cause=e}get name(){return"EvaluationError"}}class Rb{constructor(t,e,s,r){this.scope=t,this.hsv=s,this.iterate=()=>{const t=this.computePosition(),e=this.computeColor(t);return{d:this.d,position:t,color:e}},this.computePosition=()=>{const{fn:t,n:e,d:s,offset:r,size:o}=this,a=new Float32Array(s*o);let i=0;for(const $ of t.sample(e,r,r+o))a.set($,s*i++);return a},this.computeColor=t=>{const{d:e,hsv:s,size:r}=this,o=new Float32Array(3*r),{extent:a}=this.scope;for(let i=0;i<r;i++){const r=t.subarray(i*e,(i+1)*e);this.scope.p=r.map((t,e)=>{const s=a[e];return s?Qb(t)*Pb(1,Ua(t)/s):0}),this.scope.i=i;const $=Sb(360*this.resolveNumber("h",s.h),this.resolveNumber("s",s.s),this.resolveNumber("v",s.v));o.set($,3*i)}return o},this.resolver=new Ta(t);const{n:o,fn:a}=this.resolvePipe(e),i=r.offset,$=r.size,n=i+$;var $VCAb$$interop$default=f(d);$VCAb$$interop$default.d(i>=0,`offset must be non-negative; got ${i}`),$VCAb$$interop$default.d(n<=o,`offset + size must be <= n; got ${i} + ${$} = ${n} > ${o}`),this.n=o,this.fn=a,this.offset=i,this.size=n-i}get d(){return this.fn.d}resolvePipe(t){try{return this.resolver.resolve(t)}catch({message:e,scope:s}){throw{context:"pipe",message:e,scope:s}}}resolveNumber(t,e){try{return this.resolver.resolve(e,"number")}catch({message:s,scope:r}){throw{context:t,message:s,scope:r}}}}function Sb(t,e,s){t=Math.max(0,Math.min(360,t)),e=Math.max(0,Math.min(1,e));const r=t/60,o=(s=Math.max(0,Math.min(1,s)))*e,a=o*(1-Ua(r%2-1)),i=s-o;let $;return($=r<=1?[o,a,0]:r<=2?[a,o,0]:r<=3?[0,o,a]:r<=4?[0,a,o]:r<=5?[a,0,o]:r<=6?[o,0,a]:[0,0,0]).forEach((t,e)=>$[e]=t+i),$}const Tb={iterate:(e,r)=>{return new Rb(e.scope,e.pipe,e.hsv,r).iterate()}};w(Tb);e.__esModule=true;$.__esModule=true;ba.__esModule=true;ea.__esModule=true;return{"eR6i":{},"JZPE":e,"VCAb":d,"Ek7W":$,"eKDL":ba,"SQvK":ea};});