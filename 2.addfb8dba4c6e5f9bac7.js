(self.webpackJsonp=self.webpackJsonp||[]).push([[2,6],{14:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return JSON.stringify(t,null,e)}},18:function(t,e,r){"use strict";r.d(e,"a",(function(){return b}));var n=r(76),i=r(30),a=r(2),s=r(69),o=r.n(s),u=r(9);function c(t,e,r,n,i,a,s){try{var o=t[a](s),u=o.value}catch(t){return void r(t)}o.done?e(u):Promise.resolve(u).then(n,i)}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h,f="0"!=new URLSearchParams(window.location.search).get("p"),d=(h=window.location.hash.substr(1),new URLSearchParams(h?atob(h):""));class p{constructor(t,e,r){this.id=t,this._value=e,this.persistent=r,l(this,"subject",void 0),l(this,"el",void 0),l(this,"initFromOrWriteToHash",()=>{this.persistent&&d.has(this.id)?this._value=this.parse(d.get(this.id)):this.persistent&&this.updateHash()}),l(this,"newSubject",()=>new n.a({newValue:this._value})),l(this,"setup",t=>{this.el=t,this._setup()}),l(this,"updateHash",()=>{var t=this.stringify(this.value);d.set(this.id,t),document.location.hash=btoa(d.toString())}),f?this.initFromOrWriteToHash():this.persistent=!1,this.subject=this.newSubject()}parse(t){throw new Error("parse unsupported")}stringify(t){throw new Error("stringify unsupported")}get stream(){return this.subject.asObservable()}get value(){return this._value}set value(t){var e=this.value;this._value=t,this.subject.next({newValue:t,oldValue:e,event:window.event}),this.persistent&&this.updateHash()}}class v extends p{constructor(t,e){super(t,e,!(arguments.length>2&&void 0!==arguments[2])||arguments[2]),this.id=t,l(this,"disabled",!1),l(this,"_setup",()=>{this.el.onchange=()=>this.value=this.el.value,this.el.oninput=()=>this.el.size=this.el.value.length,this.stream.subscribe(t=>{var{newValue:e}=t;this.el.value=e,this.el.size=e.length})})}parse(t){return t}stringify(t){return t}}class m extends p{constructor(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(t,e,!(arguments.length>3&&void 0!==arguments[3])||arguments[3]),this.id=t,this.disabled=r,l(this,"_setup",()=>{var t=this.el.querySelector(".on");t.onclick=()=>this.value=!0;var e=this.el.querySelector(".off");e.onclick=()=>this.value=!1,this.stream.subscribe(r=>{var{newValue:n}=r;n?(t.style.display="none",e.style.display="inline"):(t.style.display="inline",e.style.display="none")})})}parse(t){if(/1|true/i.test(t))return!0;if(/0|false/i.test(t))return!1;throw new Error("invalid boolean value for input ".concat(this.id,": ").concat(t))}stringify(t){return t?"1":"0"}}var g=1e3*i.a,b={pipe:new v("pipe","".concat(g,"->sphere(4, 1)->R(theta, 0, 1, cos, tan)->R(theta, 0, 2)->R(theta, 0, 3)->stereo(3)")),theta:new v("theta","pi * (t + power) / 20"),h:new v("h","chroma * i / (n - 1)"),v:new v("v","power"),animate:new m("animate",!0,!1,!0),mic:new m("mic",!1,!1,!1),fullscreen:new m("fullscreen",!1,!document.fullscreenEnabled,!1),allowedDbs:new class extends p{constructor(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(t,e,!(arguments.length>3&&void 0!==arguments[3])||arguments[3]),this.id=t,this.disabled=r,l(this,"_setup",()=>{var t=this.el.querySelector("input");o()(t);var e=this.el.querySelector(".min"),r=this.el.querySelector(".max");t.onchange=()=>{this.value=[+t.valueLow,+t.valueHigh]},this.el.querySelector("input.ghost").oninput=t.oninput=()=>{e.innerText=t.valueLow.toString(),r.innerText=t.valueHigh.toString()},this.stream.subscribe(n=>{var{newValue:i}=n;t.value=this.stringify(i),e.innerText=t.valueLow.toString(),r.innerText=t.valueHigh.toString()})})}parse(t){var[e,r]=t.split(/,/);return[parseInt(e),parseInt(r)]}stringify(t){var[e,r]=t;return"".concat(e,",").concat(r)}}("allowed_db_range",[-100,-30]),save:new class extends p{constructor(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(t,null,!1),this.action=e,this.disabled=r,l(this,"_setup",()=>{this.el.onclick=t=>this.action(t,this.el)})}}("save",function(){var t,e=(t=function*(t,e){var r=u.renderer.domElement;u.renderer.render();var n=yield new Promise(t=>r.toBlob(t)),i=URL.createObjectURL(n);try{var a=document.createElement("a");a.download="stereo".concat(document.location.hash),a.href=i,a.click()}finally{URL.revokeObjectURL(i)}},function(){var e=this,r=arguments;return new Promise((function(n,i){var a=t.apply(e,r);function s(t){c(a,n,i,s,o,"next",t)}function o(t){c(a,n,i,s,o,"throw",t)}s(void 0)}))});return function(t,r){return e.apply(this,arguments)}}())};Object(a.a)("inputs",b)},22:function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n=r(12),i=r.n(n);function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class s{constructor(t,e,r,n){this.n=t,this.d=e,this.position=r,this.color=n}}a(s,"fromBuffer",t=>{var e=new Float32Array(t),r=e[s.nOffset],n=e[s.positionOffset(e)],i=s.position(e),a=s.color(e);return new s(r,n,i,a)}),a(s,"bufferFor",(t,e,r)=>{var n=new SharedArrayBuffer(4*(3+t*(e+r+3))),i=new Float32Array(n);return i[s.nOffset]=t,i[s.inputOffset]=e,i[s.positionOffset(i)]=r,n}),a(s,"input",t=>{var e=s.inputOffset+1;return t.subarray(e,e+s.inputLength(t))}),a(s,"position",t=>{var e=s.positionOffset(t)+1;return t.subarray(e,e+s.positionLength(t))}),a(s,"color",t=>{var e=s.colorOffset(t);return t.subarray(e)}),a(s,"nOffset",0),a(s,"inputOffset",s.nOffset+1),a(s,"inputLength",t=>{return t[s.nOffset]*t[s.inputOffset]}),a(s,"positionOffset",t=>s.inputOffset+s.inputLength(t)+1),a(s,"positionLength",t=>{return t[s.nOffset]*t[s.positionOffset(t)]}),a(s,"colorOffset",t=>s.positionOffset(t)+s.positionLength(t)+1),a(s,"get",(t,e,r)=>{var n=e*r;return t.subarray(n,n+r)}),a(s,"set",(t,e,r,n)=>{i()(e.length<=n);var a=r*n;return t.set(e,a)})},30:function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return d})),r.d(e,"c",(function(){return p})),r.d(e,"b",(function(){return w}));var n=r(49),i=r(8),a=r(74),s=r(22),o=r(42);function u(t,e,r,n,i,a,s){try{var o=t[a](s),u=o.value}catch(t){return void r(t)}o.done?e(u):Promise.resolve(u).then(n,i)}function c(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var a=t.apply(e,r);function s(t){u(a,n,i,s,o,"next",t)}function o(t){u(a,n,i,s,o,"throw",t)}s(void 0)}))}}var l,h,f=Object(i.getLogger)("PipelinePool");f.setLevel("info");var d=2*navigator.hardwareConcurrency,p=function(){var e=c((function*(){f.info("starting worker pool");var e=0;l=Object(n.Pool)(()=>Object(n.spawn)(new n.Worker(t,{name:"pipe".concat(e++)})),d),h=new Map;for(var r=[],i=0;i<d;i++)r.push(l.queue(c((function*(){}))));yield Promise.all(r)}));return function(){return e.apply(this,arguments)}}(),v=(t,e,r)=>y("initialization")(c((function*(){return b(e,function(){var e=c((function*(e){return l.queue(n=>n.initialize(t,e,r))}));return function(t){return e.apply(this,arguments)}}())}))),m=(t,e,r)=>y("iteration")(c((function*(){return b(e,function(){var e=c((function*(e){return l.queue(n=>n.iterate(t,e,r))}));return function(t){return e.apply(this,arguments)}}())}))),g=function(){var t=c((function*(t,e,r,n){var i=(t=>JSON.stringify({pipe:t.pipe,theta:t.theta,h:t.h,l:t.v}))(t);if(!h.has(i)){var a=s.a.bufferFor(e,r,n);yield v(t,e,a),h.set(i,a)}return h.get(i)}));return function(e,r,n,i){return t.apply(this,arguments)}}(),b=function(){var t=c((function*(t,e){for(var r=Math.round(t/d),n=[],i=0;i<t;i+=r){var a={offset:i,size:Math.min(t-i,r)};n.push(e(a))}yield Promise.all(n)}));return function(e,r){return t.apply(this,arguments)}}(),y=t=>(function(){var e=c((function*(e){var r=Date.now(),n=yield e(),i=Date.now()-r;return f.debug("".concat(t," took ").concat(i,"ms")),n}));return function(t){return e.apply(this,arguments)}})(),w=function(){var t=c((function*(t){var e=a.a.compile(t),r=new o.a(a.a.scopeFor(t,e.n)),{n:n,staticFn:i,dynamicFn:s}=r.resolve(e),u=yield g(t,n,i.d,s.d);return yield m(t,n,u),u.slice(0)}));return function(e){return t.apply(this,arguments)}}()}).call(this,r(48))},36:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=2**32-1},42:function(t,e,r){"use strict";var n=r(12),i=r.n(n),a=r(14),s=r(36);function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var u=Math.cos,c=Math.sin,l=(Math.tan,Math.tanh,Math.exp),h=t=>Array.from(new Array(t).keys());class f{constructor(t){var e=this;this.fns=t,o(this,"x",void 0),o(this,"y",void 0),o(this,"sample",(function*(t,e,r){var{fns:n,d:i}=this,[a,...s]=n;if(0==n.length)return[];for(var o of a.sample(t,e,r))this.x.set(o),s.length?f.apply(s,this.x,this.y):this.y.set(o),yield this.y.subarray(0,i)})),o(this,"fn",(function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(e.d),{fns:n,domain:a,d:s}=e;return i.a.equal(t.length,a),i.a.equal(r.length,s),e.x.set(t),f.apply(n,e.x,e.y),r.set(e.y.subarray(0,s)),r})),i()(t.length,"fns cannot be empty");var r=Math.max(this.domainMax,this.dMax);this.x=new Float32Array(r),this.y=new Float32Array(r)}get first(){return this.fns[0]}get last(){return this.fns[this.fns.length-1]}get domain(){return this.first.domain}get d(){return this.last.d}get domainMax(){return this.fns.reduce((t,e)=>Math.max(e.domain,t),0)}get dMax(){return this.fns.reduce((t,e)=>Math.max(e.d,t),0)}}function d(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}o(f,"apply",(t,e,r)=>{for(var n of(i.a.equal(e.length,r.length),t))n.fn(e.subarray(0,n.domain),r.subarray(0,n.d)),e.set(r);for(var a=0;a<r.length;a++)isFinite(r[a])||(r[a]=Math.sign(r[a])*s.a)}),o(f,"Builder",class{constructor(){o(this,"fns",[]),o(this,"add",t=>{var{fns:e,last:r}=this;if(r&&t.domain!==r.d)throw new Error("Cannot add ".concat(t," to composite, because its domain is not ").concat(r.d));return e.push(t),this}),o(this,"build",()=>new f(this.fns))}get d(){return this.last.d}get last(){return this.fns[this.fns.length-1]}});class p{constructor(t,e,r){var n=this;this.d=t,this.a=e,this.b=r,d(this,"domain",void 0),d(this,"fn",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(n.d),{a:r,b:a,d:s}=n;i.a.equal(t.length,s),i.a.equal(e.length,s);for(var o=0;o<s;o++)e[o]=r[o]+t[o]*(a[o]-r[o]);return e})),d(this,"sample",(function*(t,e,r){var{d:n,fn:i}=this;t=p.nPerLevel(n,t);for(var a=[[]],s=0;a.length&&s<r;){var o=a.pop();o.length<n?a.push(...u(o)):s++>=e&&(yield i(o))}function*u(e){for(var r=0;r<t;r++)yield[...e,r/t]}})),i.a.equal(e.length,t),i.a.equal(r.length,t),this.domain=t}}function v(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}d(p,"nPerLevel",(t,e)=>Math.round(Math.pow(e,1/t))),d(p,"n",(t,e)=>p.nPerLevel(t,e)**t);class m{constructor(t,e){this.d=t,this.l=e,v(this,"interval",void 0),v(this,"fn",(t,e)=>this.interval.fn(t,e)),v(this,"sample",(t,e,r)=>this.interval.sample(t,e,r)),this.interval=new p(t,new Array(t).fill(-e/2),new Array(t).fill(e/2))}get domain(){return this.d}}function g(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class b{constructor(t,e,r,n){var a=this,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:u,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:c;this.d=t,this.theta=e,this.d0=r,this.d1=n,this.f0=s,this.f1=o,g(this,"r0",void 0),g(this,"r1",void 0),g(this,"sample",(function*(t,e,r){var n=new m(this.domain,2);for(var i of n.sample(t,e,r))yield this.fn(i)})),g(this,"fn",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(a.d),{d:r,d0:n,d1:s,r0:o,r1:u}=a;i.a.equal(t.length,r),i.a.equal(e.length,r),e.set(t);var c=t[n],l=t[s];return e[n]=c*o-l*u,e[s]=c*u+l*o,e})),this.r0=s(e),this.r1=o(e)}get domain(){return this.d}}function y(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class w{constructor(t,e){var r=this;this.d=t,y(this,"root",void 0),y(this,"sample",(function*(t,e,r){var n=new m(this.domain,2*Math.PI);for(var i of n.sample(t,e,r))yield this.fn(i)})),y(this,"fn",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(r.d),{d:n,root:a}=r;i.a.equal(t.length,n-1),i.a.equal(e.length,n);var s=new f(h(n-1).map(e=>new b(n,t[e],0,e+1)));return s.fn(a,e),e})),this.root=new Float32Array(t),this.root[0]=e}get domain(){return this.d-1}}function A(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class O{constructor(t,e,r){var n=this;this.d=t,this.a=e,this.k=r,A(this,"sphere",void 0),A(this,"sample",(function*(t,e,r){var n=new m(this.domain,4*Math.PI);for(var i of n.sample(t,e,r))yield this.fn(i)})),A(this,"fn",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(n.d),{a:r,k:a,domain:s,d:o}=n;i.a.equal(t.length,o-1),i.a.equal(e.length,o),n.sphere.fn(t,e);for(var u=0,c=0;c<s;c++)u+=a[c]*t[c];for(var h=l(u),f=0;f<o;f++)e[f]=e[f]*r[f]*h;return e})),this.sphere=new w(t,1)}get domain(){return this.d-1}}function F(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class x{constructor(t,e,r){var n=this;this.d=t,this.r=e,this.t=r,F(this,"cross",void 0),F(this,"sample",(function*(t,e,r){var n=new m(this.domain,2*Math.PI);for(var i of n.sample(t,e,r))yield this.fn(i)})),F(this,"fn",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(n.d),{cross:r,d:a,r:s}=n;i.a.equal(t.length,a-1,"torus expects an input of ".concat(a-1,"; got ").concat(t.length));var o=new b(a,t[a-2],0,a-1);return r.fn(t.subarray(0,a-2),e.subarray(0,a-1)),e[0]+=s,o.fn(e,e),e})),i()(t>2,"torus is only defined for d > 2; got ".concat(t)),this.cross=new w(t-1,r)}get domain(){return this.d-1}}function j(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class P{constructor(t,e,r){var n=this;this.d=t,this.r=e,this.t=r,j(this,"sphere",void 0),j(this,"circle",void 0),j(this,"sample",(function*(t,e,r){var n=new m(this.domain,2*Math.PI);for(var i of n.sample(t,e,r))yield this.fn(i)})),j(this,"fn",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(n.d),{domain:r,d:a,sphere:s,circle:o}=n;i.a.equal(t.length,r),i.a.equal(e.length,a),s.fn(t,e);var u=o.fn(t.subarray(a-2));return e[0]+=u[0],e[a-1]+=u[1],e})),this.sphere=new w(t,r),this.circle=new w(2,e)}get domain(){return this.d-1}}function S(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class k{constructor(t,e){var r=this;this.from=t,this.to=e,S(this,"fromTemp",void 0),S(this,"toTemp",void 0),S(this,"sample",(function*(t,e,r){var n=new m(this.domain,2);for(var i of n.sample(t,e,r))yield this.fn(i)})),S(this,"fn",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(r.to),{from:n,to:a,fromTemp:s,toTemp:o}=r;if(i.a.equal(t.length,n),i.a.equal(e.length,a),n===a)return e.set(t),e;for(s.set(t);n<a;)k.up(s.subarray(0,n),o.subarray(0,++n)),s.set(o);for(;n>a;)k.down(s.subarray(0,n),o.subarray(0,--n)),s.set(o);return e.set(o.subarray(0,a)),e})),this.fromTemp=new Float32Array(Math.max(t,e)),this.toTemp=new Float32Array(Math.max(t,e))}get domain(){return this.from}get d(){return this.to}}S(k,"up",(t,e)=>{i.a.equal(e.length,t.length+1);var r=M(t),n=r+1;e[0]=(r-1)/n;for(var a=1;a<=t.length;a++)e[a]=2*t[a-1]/n}),S(k,"down",(t,e)=>{i.a.equal(e.length,t.length-1);for(var r=0;r<e.length;r++)e[r]=t[r+1]/(1-t[0])});var M=t=>{for(var e=0,r=0;r<t.length;r++)e+=t[r]*t[r];return e};function q(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class z{constructor(t){var e=this;this.d=t,q(this,"domain",void 0),q(this,"fn",(function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Float32Array(e.d),{d:n}=e;return i.a.equal(t.length,n),i.a.equal(r.length,n),r.set(t),r})),q(this,"sample",(function*(t,e,r){throw new Error("identity function does not support sampling")})),this.domain=t}}function C(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function L(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?C(Object(r),!0).forEach((function(e){N(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function N(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,"a",(function(){return E}));class E{constructor(t){var e=this;this.scope=t,N(this,"resolve",(function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.kind){case"pipe":return e.resolvePipe(t);case"number":return t.value;case"fn":return e.resolveFn(t,r);case"access":return e.resolveAccess(t,r);case"id":return e.resolveIdToNumber(t.id,r);case"arith":return e.resolveArith(t,r)}})),N(this,"resolvePipe",t=>{var e=t.chain,r=[],n=e.shift(),i=n.args.shift().value,a=this.resolveFirstStep(i,n),s=p.n(a.fn.domain,t.n);r.push(a);for(var o=0;o<e.length;o++){var u=e[o],c=this.resolveStep(r[o].fn,u);r.push(c)}var[l,h]=this.buildComposites(r);return{n:s,staticFn:l,dynamicFn:h}}),N(this,"buildComposites",t=>{for(var e=new f.Builder;t.length&&!t[0].isDynamic;)e.add(t.shift().fn);var r=e.build();for(e=(new f.Builder).add(new z(r.d));t.length;)e.add(t.shift().fn);return[r,e.build()]}),N(this,"resolveFirstStep",(t,e)=>{var{type:r,args:n}=e;return{fn:R[r](t,...n.map(t=>this.resolveScalar(t))),isDynamic:n.some(T)}}),N(this,"resolveStep",(t,e)=>{var{type:r,args:n}=e,i=D[r](t.d);return{fn:R[r](i,...n.map(t=>this.resolveScalar(t))),isDynamic:n.some(T)}}),N(this,"resolveScalar",(function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.kind){case"number":return t.value;case"fn":return e.resolveFn(t,r);case"access":return e.resolveAccess(t,r);case"id":return e.resolveId(t.id,r);case"arith":return e.resolveArith(t,r)}})),N(this,"resolveFn",(t,e)=>{var{name:r,args:n}=t,s=Math[r];return i()("function"==typeof s,"Expected ".concat(r," to be a Math function in ").concat(Object(a.a)({name:r,args:n}))),s(...n.map(t=>this.resolveScalar(t,e)))}),N(this,"resolveAccess",(t,e)=>{var{id:r,index:n}=t,s=L({},this.scope,{},e),o=s[r];return i()(o,"Unable to resolve ".concat(r," in scope ").concat(Object(a.a)(s,2))),o[this.resolveScalar(n,e)]}),N(this,"resolveId",(t,e)=>t in Math&&"function"==typeof Math[t]?Math[t]:this.resolveIdToNumber(t,e)),N(this,"resolveIdToNumber",(t,e)=>{var r=t.toUpperCase();return t in e?e[t]:t in this.scope?this.scope[t]:r in Math&&"number"==typeof Math[r]?Math[r]:void i.a.fail("unable to resolve id ".concat(t," in scope ").concat(Object(a.a)(L({},this.scope,{},e),2)))}),N(this,"resolveArith",(t,e)=>{var{op:r,operands:n}=t,[s,o]=n.map(t=>this.resolveScalar(t,e));if("number"==typeof s&&"number"==typeof o)return I[r](s,o);i.a.fail("One or more arithmetic operands evaluate to a non-number in ".concat(Object(a.a)({op:r,operands:n},2)))})}}var T=t=>{switch(t.kind){case"fn":return t.args.some(T);case"id":return["t","power","chroma"].includes(t.id);case"arith":return t.operands.some(T);default:return!1}},I={"+":(t,e)=>t+e,"-":(t,e)=>t-e,"*":(t,e)=>t*e,"/":(t,e)=>t/e,"**":(t,e)=>t**e,"^":(t,e)=>t**e},_=function(t,e,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Math.cos,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Math.sin;return new b(t,e,r,n,i,a)},R={cube:(t,e)=>new m(t,e),sphere:(t,e)=>new w(t,e),spiral:(t,e,r)=>new O(t,new Array(t).fill(e),new Array(t-1).fill(r)),torus:(t,e,r)=>new x(t,e,r),fucked_up_torus:(t,e,r)=>new P(t,e,r),rotate:_,r:_,stereo:(t,e)=>new k(t,e)},D={cube:t=>t,sphere:t=>t+1,spiral:t=>t+1,torus:t=>t+1,fucked_up_torus:t=>t+1,rotate:t=>t,r:t=>t,stereo:t=>t}},48:function(t,e,r){t.exports=r.p+"0.51285ae3b78c6fbf003c.worker.js"},65:function(t,e,r){"use strict";function n(t,e,r,i){this.message=t,this.expected=e,this.found=r,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,n)}!function(t,e){function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r}(n,Error),n.buildMessage=function(t,e){var r={literal:function(t){return'"'+i(t.text)+'"'},class:function(t){var e,r="";for(e=0;e<t.parts.length;e++)r+=t.parts[e]instanceof Array?a(t.parts[e][0])+"-"+a(t.parts[e][1]):a(t.parts[e]);return"["+(t.inverted?"^":"")+r+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function i(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function a(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}return"Expected "+function(t){var e,n,i,a=new Array(t.length);for(e=0;e<t.length;e++)a[e]=(i=t[e],r[i.type](i));if(a.sort(),a.length>0){for(e=1,n=1;e<a.length;e++)a[e-1]!==a[e]&&(a[n]=a[e],n++);a.length=n}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(t)+" but "+function(t){return t?'"'+i(t)+'"':"end of input"}(e)+" found."},t.exports={SyntaxError:n,parse:function(t,e){e=void 0!==e?e:{};var r,i={},a={pipe:yt,arith:At},s=yt,o=function(t,e){return{kind:"pipe",n:parseInt(t),chain:e}},u=function(t,e){return[t,...e]},c=function(t){return[t]},l=function(t,e){return{kind:"step",type:t.toLowerCase(),args:e}},h=function(t){return[t]},f=function(t,e,r){return{kind:"arith",op:e,operands:[t,r]}},d=function(t){return{kind:"number",value:t}},p=function(t,e){return{kind:"fn",name:t.toLowerCase(),args:e}},v="[",m=dt("[",!1),g="]",b=dt("]",!1),y=function(t,e){return{kind:"access",id:t,index:e}},w=function(t){return{kind:"id",id:t.toLowerCase()}},A=function(t){return t},O=function(t){return parseFloat(t)},F=function(t){return parseInt(t)},x=/^[a-zA-Z]/,j=pt([["a","z"],["A","Z"]],!1,!1),P=/^[a-zA-Z0-9]/,S=pt([["a","z"],["A","Z"],["0","9"]],!1,!1),k=function(t){return t},M=/^[+\-]/,q=pt(["+","-"],!1,!1),z=/^[0-9]/,C=pt([["0","9"]],!1,!1),L=/^[eE]/,N=pt(["e","E"],!1,!1),E=".",T=dt(".",!1),I="+",_=dt("+",!1),R="-",D=dt("-",!1),H="*",U=dt("*",!1),V="/",B=dt("/",!1),J="**",W=dt("**",!1),Z="^",G=dt("^",!1),K=function(t){return t},Q="(",X=dt("(",!1),Y=")",$=dt(")",!1),tt=",",et=dt(",",!1),rt="->",nt=dt("->",!1),it="=>",at=dt("=>",!1),st=/^[ \t\n\r]/,ot=pt([" ","\t","\n","\r"],!1,!1),ut=0,ct=[{line:1,column:1}],lt=0,ht=[],ft=0;if("startRule"in e){if(!(e.startRule in a))throw new Error("Can't start parsing from rule \""+e.startRule+'".');s=a[e.startRule]}function dt(t,e){return{type:"literal",text:t,ignoreCase:e}}function pt(t,e,r){return{type:"class",parts:t,inverted:e,ignoreCase:r}}function vt(e){var r,n=ct[e];if(n)return n;for(r=e-1;!ct[r];)r--;for(n={line:(n=ct[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return ct[e]=n,n}function mt(t,e){var r=vt(t),n=vt(e);return{start:{offset:t,line:r.line,column:r.column},end:{offset:e,line:n.line,column:n.column}}}function gt(t){ut<lt||(ut>lt&&(lt=ut,ht=[]),ht.push(t))}function bt(t,e,r){return new n(n.buildMessage(t,e),t,e,r)}function yt(){var t,e,r;return t=ut,(e=jt())!==i&&qt()!==i&&(r=function t(){var e,r,n;e=ut,(r=wt())!==i&&qt()!==i&&(n=t())!==i?(e,r=u(r,n),e=r):(ut=e,e=i);e===i&&(e=ut,(r=wt())!==i&&(e,r=c(r)),e=r);return e}())!==i?(t,t=e=o(e,r)):(ut=t,t=i),t}function wt(){var t,e,r;return t=ut,(e=Ft())!==i&&St()!==i&&(r=function t(){var e,r,n;e=ut,(r=At())!==i&&Mt()!==i&&(n=t())!==i?(e,r=u(r,n),e=r):(ut=e,e=i);e===i&&(e=ut,(r=At())!==i&&(e,r=h(r)),e=r);return e}())!==i&&kt()!==i?(t,t=e=l(e,r)):(ut=t,t=i),t}function At(){var e,r,n,a;return e=ut,(r=Ot())!==i&&(n=function(){var e,r,n,a;e=ut,(r=zt())!==i?(n=ut,43===t.charCodeAt(ut)?(a=I,ut++):(a=i,0===ft&&gt(_)),a===i&&(45===t.charCodeAt(ut)?(a=R,ut++):(a=i,0===ft&&gt(D)),a===i&&(42===t.charCodeAt(ut)?(a=H,ut++):(a=i,0===ft&&gt(U)),a===i&&(47===t.charCodeAt(ut)?(a=V,ut++):(a=i,0===ft&&gt(B)),a===i&&(t.substr(ut,2)===J?(a=J,ut+=2):(a=i,0===ft&&gt(W)),a===i&&(94===t.charCodeAt(ut)?(a=Z,ut++):(a=i,0===ft&&gt(G))))))),(n=a!==i?t.substring(n,ut):a)!==i&&(a=zt())!==i?(e,r=K(n),e=r):(ut=e,e=i)):(ut=e,e=i);return e}())!==i&&(a=At())!==i?(e,e=r=f(r,n,a)):(ut=e,e=i),e===i&&(e=Ot()),e}function Ot(){var e,r,n,a,s;return e=ut,(r=function(){var e,r,n;e=ut,(r=zt())!==i&&(n=function(){var e,r,n,a,s,o,u;e=ut,r=ut,M.test(t.charAt(ut))?(n=t.charAt(ut),ut++):(n=i,0===ft&&gt(q));n===i&&(n=null);n!==i?(z.test(t.charAt(ut))?(a=t.charAt(ut),ut++):(a=i,0===ft&&gt(C)),a!==i&&(s=Pt())!==i?(L.test(t.charAt(ut))?(o=t.charAt(ut),ut++):(o=i,0===ft&&gt(N)),o!==i&&(u=xt())!==i?r=n=[n,a,s,o,u]:(ut=r,r=i)):(ut=r,r=i)):(ut=r,r=i);e=r!==i?t.substring(e,ut):r;e===i&&(e=ut,r=ut,(n=xt())===i&&(n=null),n!==i&&(a=Pt())!==i?r=n=[n,a]:(ut=r,r=i),e=r!==i?t.substring(e,ut):r);return e}())!==i&&zt()!==i?(e,r=O(n),e=r):(ut=e,e=i);e===i&&(e=ut,(r=zt())!==i&&(n=xt())!==i&&zt()!==i?(e,r=F(n),e=r):(ut=e,e=i));return e}())!==i&&(e,r=d(r)),(e=r)===i&&(e=ut,(r=Ft())!==i&&(n=St())!==i&&(a=function t(){var e,r,n;e=ut,(r=At())!==i&&Mt()!==i&&(n=t())!==i?(e,r=u(r,n),e=r):(ut=e,e=i);e===i&&(e=ut,(r=At())!==i&&(e,r=h(r)),e=r);return e}())!==i&&(s=kt())!==i?(e,e=r=p(r,a)):(ut=e,e=i),e===i&&(e=ut,(r=Ft())!==i?(91===t.charCodeAt(ut)?(n=v,ut++):(n=i,0===ft&&gt(m)),n!==i&&(a=Ot())!==i?(93===t.charCodeAt(ut)?(s=g,ut++):(s=i,0===ft&&gt(b)),s!==i?(e,e=r=y(r,a)):(ut=e,e=i)):(ut=e,e=i)):(ut=e,e=i),e===i&&(e=ut,(r=Ft())!==i&&(e,r=w(r)),(e=r)===i&&(e=ut,(r=St())!==i&&(n=At())!==i&&(a=kt())!==i?(e,e=r=A(n)):(ut=e,e=i))))),e}function Ft(){var e,r,n,a,s,o;if(e=ut,zt()!==i){if(r=ut,n=ut,x.test(t.charAt(ut))?(a=t.charAt(ut),ut++):(a=i,0===ft&&gt(j)),a!==i){for(s=[],P.test(t.charAt(ut))?(o=t.charAt(ut),ut++):(o=i,0===ft&&gt(S));o!==i;)s.push(o),P.test(t.charAt(ut))?(o=t.charAt(ut),ut++):(o=i,0===ft&&gt(S));s!==i?n=a=[a,s]:(ut=n,n=i)}else ut=n,n=i;(r=n!==i?t.substring(r,ut):n)!==i&&(n=zt())!==i?(e,e=k(r)):(ut=e,e=i)}else ut=e,e=i;return e}function xt(){var e,r,n,a;return e=ut,r=ut,M.test(t.charAt(ut))?(n=t.charAt(ut),ut++):(n=i,0===ft&&gt(q)),n===i&&(n=null),n!==i&&(a=jt())!==i?r=n=[n,a]:(ut=r,r=i),e=r!==i?t.substring(e,ut):r}function jt(){var e,r,n;if(e=ut,r=[],z.test(t.charAt(ut))?(n=t.charAt(ut),ut++):(n=i,0===ft&&gt(C)),n!==i)for(;n!==i;)r.push(n),z.test(t.charAt(ut))?(n=t.charAt(ut),ut++):(n=i,0===ft&&gt(C));else r=i;return e=r!==i?t.substring(e,ut):r}function Pt(){var e,r,n,a;return e=ut,r=ut,46===t.charCodeAt(ut)?(n=E,ut++):(n=i,0===ft&&gt(T)),n!==i&&(a=jt())!==i?r=n=[n,a]:(ut=r,r=i),e=r!==i?t.substring(e,ut):r}function St(){var e,r,n,a;return e=ut,(r=zt())!==i?(40===t.charCodeAt(ut)?(n=Q,ut++):(n=i,0===ft&&gt(X)),n!==i&&(a=zt())!==i?e=r=[r,n,a]:(ut=e,e=i)):(ut=e,e=i),e}function kt(){var e,r,n,a;return e=ut,(r=zt())!==i?(41===t.charCodeAt(ut)?(n=Y,ut++):(n=i,0===ft&&gt($)),n!==i&&(a=zt())!==i?e=r=[r,n,a]:(ut=e,e=i)):(ut=e,e=i),e}function Mt(){var e,r,n,a;return e=ut,(r=zt())!==i?(44===t.charCodeAt(ut)?(n=tt,ut++):(n=i,0===ft&&gt(et)),n!==i&&(a=zt())!==i?e=r=[r,n,a]:(ut=e,e=i)):(ut=e,e=i),e}function qt(){var e,r,n,a;return e=ut,(r=zt())!==i?(n=ut,t.substr(ut,2)===rt?(a=rt,ut+=2):(a=i,0===ft&&gt(nt)),a===i&&(a=function(){var e,r,n;e=ut,r=[],st.test(t.charAt(ut))?(n=t.charAt(ut),ut++):(n=i,0===ft&&gt(ot));if(n!==i)for(;n!==i;)r.push(n),st.test(t.charAt(ut))?(n=t.charAt(ut),ut++):(n=i,0===ft&&gt(ot));else r=i;e=r!==i?t.substring(e,ut):r;return e}())===i&&(t.substr(ut,2)===it?(a=it,ut+=2):(a=i,0===ft&&gt(at))),(n=a!==i?t.substring(n,ut):a)!==i&&(a=zt())!==i?e=r=[r,n,a]:(ut=e,e=i)):(ut=e,e=i),e}function zt(){var e,r;for(e=[],st.test(t.charAt(ut))?(r=t.charAt(ut),ut++):(r=i,0===ft&&gt(ot));r!==i;)e.push(r),st.test(t.charAt(ut))?(r=t.charAt(ut),ut++):(r=i,0===ft&&gt(ot));return e}if((r=s())!==i&&ut===t.length)return r;throw r!==i&&ut<t.length&&gt({type:"end"}),bt(ht,lt<t.length?t.charAt(lt):null,lt<t.length?mt(lt,lt+1):mt(lt,lt))}}},74:function(t,e,r){"use strict";var n=r(8),i=r(65),a=r(14);function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=Object(n.getLogger)("Parser");o.setDefaultLevel("info");var u=(t,e)=>{try{var r=Object(i.parse)(t,e);return o.debug("parsed ".concat(t," into node ").concat(Object(a.a)(r))),r}catch(e){throw o.error("error parsing ".concat(t," at ").concat(Object(a.a)(e.location),": ").concat(e.message)),e}};class c{}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}s(c,"parsePipe",t=>u(t)),s(c,"parseArith",t=>u(t,{startRule:"arith"}));class h{constructor(t){l(this,"simplifier",void 0),l(this,"compilePipe",t=>{var e=c.parsePipe(t);return this.simplifier.simplify(e)}),l(this,"compileArith",t=>{var e=c.parseArith(t);return this.simplifier.simplifyArithNode(e)}),this.simplifier=new f({theta:c.parseArith(t.theta)})}}class f{constructor(t){this.substitutions=t,l(this,"simplify",t=>{var e=t.n,r=t.chain;return{kind:t.kind,n:e,chain:r.map(this.simplifyStepNode)}}),l(this,"simplifyArithNode",t=>{var{kind:e,op:r,operands:n}=t,[i,a]=n.map(this.simplifyScalar);return{kind:e,op:r,operands:[i,a]}}),l(this,"simplifyStepNode",t=>{var{kind:e,type:r,args:n}=t;return{kind:e,type:r,args:n.map(this.simplifyScalar)}}),l(this,"simplifyScalar",t=>{switch(t.kind){case"number":return t;case"fn":return this.simplifyFnNode(t);case"access":return this.simplifyAccessNode(t);case"id":return this.simplifyIdNode(t);case"arith":return this.simplifyArithNode(t)}}),l(this,"simplifyFnNode",t=>{var{kind:e,name:r,args:n}=t;return{kind:e,name:r,args:n.map(this.simplifyIdNode)}}),l(this,"simplifyAccessNode",t=>{var{kind:e,id:r,index:n}=t;return{kind:e,id:r,index:this.simplifyScalar(n)}}),l(this,"simplifyIdNode",t=>{var{id:e}=t;return e in this.substitutions?this.simplifyScalar(this.substitutions[e]):t})}}var d=r(22),p=r(12),v=r.n(p),m=r(21),g=r(66),b=r(42);function y(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var w=Object(n.getLogger)("Evaluator");class A{constructor(t,e,r,n){this.scope=t,this.hv=r,y(this,"n",void 0),y(this,"staticFn",void 0),y(this,"dynaicFn",void 0),y(this,"offset",void 0),y(this,"limit",void 0),y(this,"resolver",void 0),y(this,"initialize",t=>{var e=new Float32Array(t),{n:r,staticFn:n,offset:i,limit:a}=this,s=d.a.input(e),o=i;for(var u of n.sample(r,i,a))d.a.set(s,u,o++,n.d)}),y(this,"iterate",t=>{var e=new Float32Array(t),{staticFn:r,dynaicFn:n,scope:i,n:s,offset:o,limit:u}=this,c=d.a.input(e),l=d.a.position(e),h=Date.now();v.a.equal(e[d.a.nOffset],s,"n(data) != n(evaluator)"),v.a.equal(e[d.a.inputOffset],r.d,"d0(data) != d0(evaluator)"),v.a.equal(e[d.a.positionOffset(e)],n.d,"d(data) != d(evaluator)"),w.debug("iterating using ".concat(Object(a.a)(i),", ").concat(Object(a.a)(n)));for(var f=o;f<u;f++)n.fn(d.a.get(c,f,r.d),d.a.get(l,f,n.d));this.computeColors(e),w.debug("iteration complete in ".concat(Date.now()-h,"ms"))}),y(this,"computeColors",t=>{w.debug("computing colors");for(var{d:e,hv:r,offset:n,limit:i,resolver:a}=this,s=d.a.position(t),o=d.a.color(t),u=n;u<i;u++){var c=d.a.get(s,u,e),[l,h,f]=g.hsv.hsl([Math.round(a.resolve(r.h,{p:c,i:u})),100,Math.round(a.resolve(r.v,{p:c,i:u}))]),p=new m.c("hsl(".concat(l,", ").concat(h,"%, ").concat(f,"%)"));d.a.set(o,[p.r,p.g,p.b],u,3)}});var i=new b.a(t),{n:s,staticFn:o,dynamicFn:u}=i.resolve(e),c=n.offset,l=n.size,h=c+l;v()(c>=0,"offset must be non-negative; got ".concat(c)),v()(h<=s,"offset + size must be <= n; got ".concat(c," + ").concat(l," = ").concat(h," > ").concat(s)),this.n=s,this.staticFn=o,this.dynaicFn=u,this.offset=c,this.limit=h,this.resolver=i}get d(){return this.dynaicFn.d}}var O=r(36);function F(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,"a",(function(){return x})),Object(n.getLogger)("Pipe").setLevel("info");class x{}F(x,"compile",t=>new h(x.normalized(t)).compilePipe(t.pipe)),F(x,"evaluatorFor",(t,e)=>x.evaluatorForNormal(x.normalized(t),e)),F(x,"scopeFor",(t,e)=>x.scopeForNormal(x.normalized(t),e)),F(x,"evaluatorForNormal",(t,e)=>{var r=new h(t),n=r.compilePipe(t.pipe),i=x.compileHV(t,r);return new A(x.scopeForNormal(t,n.n),n,i,e)}),F(x,"normalized",t=>({pipe:t.pipe,theta:t.theta||"t",h:t.h||"1",v:t.v||"0.5",t:t.t||0,power:t.power||0,chroma:t.chroma||0})),F(x,"scopeForNormal",(t,e)=>{var{power:r,t:n,chroma:i}=t;return{t:n,power:r,chroma:i,n:e,inf:O.a}}),F(x,"compileHV",(t,e)=>({h:e.compileArith("359 * (".concat(t.h,")")),v:e.compileArith("100 * (".concat(t.v,")"))}))},9:function(t,e,r){"use strict";r.r(e),r.d(e,"renderer",(function(){return o}));var n=r(21),i=r(12),a=r.n(i);function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=new class{constructor(){s(this,"renderer",void 0),s(this,"scene",void 0),s(this,"camera",void 0),s(this,"points",void 0),s(this,"z",5),s(this,"setSize",()=>{var t=window.innerWidth,e=window.innerHeight,r=t/e;this.renderer.setSize(t,e),this.camera=new n.d(100,r,.01,1e3),this.camera.position.z=this.z}),s(this,"render",()=>{this.renderer.render(this.scene,this.camera)}),s(this,"update",t=>{var{d:e,position:r,color:i}=t,{points:s}=this,o=s.geometry;a.a.equal(r.length%e,0),a.a.equal(i.length%3,0),r.forEach((t,e)=>{isNaN(t)&&console.warn("found NaN value at index ".concat(e))}),o.setAttribute("position",new n.a(r,e)),o.setAttribute("color",new n.a(i,3));var u=5;if(e>2){o.computeBoundingSphere();var c=o.boundingSphere;u=Math.min(5,c.center.z+c.radius+1)}this.camera.position.z=this.z=u,requestAnimationFrame(this.render)}),this.renderer=new n.i,this.setSize(),window.onresize=()=>{this.setSize(),requestAnimationFrame(this.render)},this.points=new n.e(new n.b,new n.f({vertexColors:n.h,size:.001})),this.scene=new n.g,this.scene.add(this.points)}get domElement(){return this.renderer.domElement}}}}]);
//# sourceMappingURL=2.addfb8dba4c6e5f9bac7.js.map