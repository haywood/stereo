{"version":3,"sources":["webpack:///./src/web/error.ts","webpack:///./node_modules/rxjs/_esm5/internal/OuterSubscriber.js","webpack:///./node_modules/rxjs/_esm5/internal/InnerSubscriber.js","webpack:///./node_modules/rxjs/_esm5/internal/util/subscribeToArray.js","webpack:///./node_modules/rxjs/_esm5/internal/symbol/iterator.js","webpack:///./node_modules/rxjs/_esm5/internal/util/subscribeTo.js","webpack:///./node_modules/rxjs/_esm5/internal/util/subscribeToObservable.js","webpack:///./node_modules/rxjs/_esm5/internal/util/isArrayLike.js","webpack:///./node_modules/rxjs/_esm5/internal/util/isPromise.js","webpack:///./node_modules/rxjs/_esm5/internal/util/subscribeToPromise.js","webpack:///./node_modules/rxjs/_esm5/internal/util/subscribeToIterable.js","webpack:///./node_modules/rxjs/_esm5/internal/util/subscribeToResult.js","webpack:///./node_modules/rxjs/_esm5/internal/observable/fromArray.js","webpack:///./node_modules/rxjs/_esm5/internal/scheduled/scheduleArray.js","webpack:///./node_modules/rxjs/_esm5/internal/observable/combineLatest.js","webpack:///./node_modules/rxjs/_esm5/internal/scheduler/AsyncAction.js","webpack:///./node_modules/rxjs/_esm5/internal/scheduler/Action.js","webpack:///./node_modules/rxjs/_esm5/internal/Scheduler.js","webpack:///./node_modules/rxjs/_esm5/internal/scheduler/async.js","webpack:///./node_modules/rxjs/_esm5/internal/scheduler/AsyncScheduler.js","webpack:///./node_modules/rxjs/_esm5/internal/observable/interval.js","webpack:///./node_modules/rxjs/_esm5/internal/util/isNumeric.js","webpack:///./src/pipe/simplifier.ts","webpack:///./src/web/audio/constants.ts","webpack:///./src/web/audio/spectrum.ts","webpack:///./src/web/audio/graph.ts","webpack:///./src/web/audio/index.ts","webpack:///./src/web/constants.ts","webpack:///./src/web/params/index.ts","webpack:///./node_modules/rxjs/_esm5/internal/util/isScheduler.js","webpack:///./src/web/data.ts","webpack:///./src/web/audio/power.worklet.ts"],"names":["error","err","Error","log","pp","_super","OuterSubscriber","apply","this","arguments","prototype","notifyNext","outerValue","innerValue","outerIndex","innerIndex","innerSub","destination","next","notifyError","notifyComplete","complete","Subscriber","InnerSubscriber","parent","_this","call","index","_next","value","_error","unsubscribe","_complete","subscribeToArray","array","subscriber","i","len","length","closed","getSymbolIterator","Symbol","iterator","subscribeTo","result","obj","obs","subscribe","TypeError","x","then","isPromise","promise","hostReportError","iterable","item","done","return","add","isObject","subscribeToResult","outerSubscriber","Observable","fromArray","input","scheduler","sub","Subscription","schedule","scheduleArray","NONE","CombineLatestOperator","resultSelector","source","CombineLatestSubscriber","active","values","observables","observable","push","toRespond","unused","oldVal","_tryResultSelector","slice","AsyncAction","work","pending","state","delay","id","recycleAsyncId","requestAsyncId","setInterval","flush","bind","clearInterval","execute","_execute","errored","errorValue","undefined","e","_unsubscribe","actions","indexOf","splice","Action","Scheduler","SchedulerAction","now","Date","AsyncScheduler","delegate","scheduled","action","shift","interval","period","val","isArray","parseFloat","dispatch","counter","Simplifier","constructor","substitutions","pipe","n","d0","steps","kind","map","simplifyStepNode","node","simplifyFnNode","simplifyAccessNode","simplifyIdNode","simplifyArithNode","type","fn","args","simplifyScalar","op","operands","a","b","name","AUDIO_PLACEHOLDER","power","chroma","tempo","onset","binCount","octaveCount","Spectrum","dbMin","dbMax","k","Math","floor","octave","pow","AudioGraph","ctx","subject","close","AudioWorkletNode","numberOfInputs","channelCountMode","channelCount","port","onmessage","msg","inputs","mic","data","onprocessorerror","connect","allowedDbs","stream","newValue","min","max","parameters","get","setValueAtTime","currentTime","f","filter","BiquadFilterNode","frequency","Q","mediaStream","AudioContext","audioWorklet","addModule","processorUrl","MediaStreamAudioSourceNode","graph","logger","getLogger","BehaviorSubject","audioStream","asObservable","event","info","navigator","mediaDevices","getUserMedia","audio","create","fftSize","Subject","paramsStream","params","options","theta","simplify","scope","t","inf","hv","h","v","count","emit","maybeEmit","animate","_i","pop","lift","combineLatest","setDefaultLevel","dataStream","webWorkerSource","console","startPool","getData","runPipeline","Data","fromBuffer","inFlight","logged","debug","module","exports"],"mappings":"8IAIaA,EAASC,IAChBA,aAAeC,MACjBC,QAAUF,GAEVE,QAAUC,YAAGH,K,4BCLb,EAAiC,SAAUI,GAE3C,SAASC,IACL,OAAkB,OAAXD,GAAmBA,EAAOE,MAAMC,KAAMC,YAAcD,KAW/D,OAbA,IAAkBF,EAAiBD,GAInCC,EAAgBI,UAAUC,WAAa,SAAUC,EAAYC,EAAYC,EAAYC,EAAYC,GAC7FR,KAAKS,YAAYC,KAAKL,IAE1BP,EAAgBI,UAAUS,YAAc,SAAUnB,EAAOgB,GACrDR,KAAKS,YAAYjB,MAAMA,IAE3BM,EAAgBI,UAAUU,eAAiB,SAAUJ,GACjDR,KAAKS,YAAYI,YAEdf,EAdyB,CAelCgB,EAAA,GCfE,EAAiC,SAAUjB,GAE3C,SAASkB,EAAgBC,EAAQZ,EAAYE,GACzC,IAAIW,EAAQpB,EAAOqB,KAAKlB,OAASA,KAKjC,OAJAiB,EAAMD,OAASA,EACfC,EAAMb,WAAaA,EACnBa,EAAMX,WAAaA,EACnBW,EAAME,MAAQ,EACPF,EAaX,OApBA,IAAkBF,EAAiBlB,GASnCkB,EAAgBb,UAAUkB,MAAQ,SAAUC,GACxCrB,KAAKgB,OAAOb,WAAWH,KAAKI,WAAYiB,EAAOrB,KAAKM,WAAYN,KAAKmB,QAASnB,OAElFe,EAAgBb,UAAUoB,OAAS,SAAU9B,GACzCQ,KAAKgB,OAAOL,YAAYnB,EAAOQ,MAC/BA,KAAKuB,eAETR,EAAgBb,UAAUsB,UAAY,WAClCxB,KAAKgB,OAAOJ,eAAeZ,MAC3BA,KAAKuB,eAEFR,EArByB,CAsBlCD,EAAA,GCxBSW,EAAmB,SAAUC,GACpC,OAAO,SAAUC,GACb,IAAK,IAAIC,EAAI,EAAGC,EAAMH,EAAMI,OAAQF,EAAIC,IAAQF,EAAWI,OAAQH,IAC/DD,EAAWjB,KAAKgB,EAAME,IAE1BD,EAAWd,a,QCLZ,SAASmB,IACZ,MAAsB,mBAAXC,QAA0BA,OAAOC,SAGrCD,OAAOC,SAFH,aAIR,IAAI,EAAyBF,I,oBCGzBG,EAAc,SAAUC,GAC/B,GAAMA,GAA+C,mBAA9BA,EAAO,KAC1B,OCVqCC,EDURD,ECT1B,SAAUT,GACb,IAAIW,EAAMD,EAAI,OACd,GAA6B,mBAAlBC,EAAIC,UACX,MAAM,IAAIC,UAAU,kEAGpB,OAAOF,EAAIC,UAAUZ,IDKxB,IEb2Bc,EFaXL,IEbgD,iBAAbK,EAAEX,QAAoC,mBAANW,EFcpF,OAAOhB,EAAiBW,GAEvB,GGhBF,SAAmBf,GACtB,QAASA,GAAoC,mBAApBA,EAAMkB,WAAkD,mBAAflB,EAAMqB,KHe/DC,CAAUP,GACf,OIhBkCQ,EJgBRR,EIfvB,SAAUT,GAQb,OAPAiB,EAAQF,MAAK,SAAUrB,GACdM,EAAWI,SACZJ,EAAWjB,KAAKW,GAChBM,EAAWd,eAEhB,SAAUpB,GAAO,OAAOkC,EAAWnC,MAAMC,MACvCiD,KAAK,KAAMG,EAAA,GACTlB,GJSN,GAAMS,GAA6C,mBAA5BA,EAAO,GAC/B,OKnBmCU,ELmBRV,EKlBxB,SAAUT,GAEb,IADA,IAAIO,EAAWY,EAAS,OACrB,CACC,IAAIC,EAAOb,EAASxB,OACpB,GAAIqC,EAAKC,KAAM,CACXrB,EAAWd,WACX,MAGJ,GADAc,EAAWjB,KAAKqC,EAAK1B,OACjBM,EAAWI,OACX,MAUR,MAP+B,mBAApBG,EAASe,QAChBtB,EAAWuB,KAAI,WACPhB,EAASe,QACTf,EAASe,YAIdtB,GLCP,IKtBmCmB,EDADF,EFDNH,EDCSJ,EDsBjChB,EAAQ,OAAA8B,EAAA,GAASf,GAAU,oBAAsB,IAAMA,EAAS,IAGpE,MAAM,IAAII,UAFA,gBAAkBnB,EAAQ,8F,QMrBrC,SAAS+B,EAAkBC,EAAiBjB,EAAQhC,EAAYE,EAAYG,GAI/E,QAHoB,IAAhBA,IACAA,EAAc,IAAI,EAAgB4C,EAAiBjD,EAAYE,KAE/DG,EAAYsB,OAGhB,OAAIK,aAAkBkB,EAAA,EACXlB,EAAOG,UAAU9B,GAErB0B,EAAYC,EAAZD,CAAoB1B,G,YCVxB,SAAS8C,EAAUC,EAAOC,GAC7B,OAAKA,ECFF,SAAuBD,EAAOC,GACjC,OAAO,IAAIH,EAAA,GAAW,SAAU3B,GAC5B,IAAI+B,EAAM,IAAIC,EAAA,EACV/B,EAAI,EAWR,OAVA8B,EAAIR,IAAIO,EAAUG,UAAS,WACnBhC,IAAM4B,EAAM1B,QAIhBH,EAAWjB,KAAK8C,EAAM5B,MACjBD,EAAWI,QACZ2B,EAAIR,IAAIlD,KAAK4D,aALbjC,EAAWd,eAQZ6C,KDRAG,CAAcL,EAAOC,GAHrB,IAAIH,EAAA,EAAW7B,EAAiB+B,IEC/C,IAAIM,EAAO,GAmBX,IAAIC,EAAuC,WACvC,SAASA,EAAsBC,GAC3BhE,KAAKgE,eAAiBA,EAK1B,OAHAD,EAAsB7D,UAAUgB,KAAO,SAAUS,EAAYsC,GACzD,OAAOA,EAAO1B,UAAU,IAAI,EAAwBZ,EAAY3B,KAAKgE,kBAElED,EAP+B,GAUtC,EAAyC,SAAUlE,GAEnD,SAASqE,EAAwBzD,EAAauD,GAC1C,IAAI/C,EAAQpB,EAAOqB,KAAKlB,KAAMS,IAAgBT,KAK9C,OAJAiB,EAAM+C,eAAiBA,EACvB/C,EAAMkD,OAAS,EACflD,EAAMmD,OAAS,GACfnD,EAAMoD,YAAc,GACbpD,EAqDX,OA5DA,IAAkBiD,EAAyBrE,GAS3CqE,EAAwBhE,UAAUkB,MAAQ,SAAUkD,GAChDtE,KAAKoE,OAAOG,KAAKT,GACjB9D,KAAKqE,YAAYE,KAAKD,IAE1BJ,EAAwBhE,UAAUsB,UAAY,WAC1C,IAAI6C,EAAcrE,KAAKqE,YACnBxC,EAAMwC,EAAYvC,OACtB,GAAY,IAARD,EACA7B,KAAKS,YAAYI,eAEhB,CACDb,KAAKmE,OAAStC,EACd7B,KAAKwE,UAAY3C,EACjB,IAAK,IAAID,EAAI,EAAGA,EAAIC,EAAKD,IAAK,CAC1B,IAAI0C,EAAaD,EAAYzC,GAC7B5B,KAAKkD,IAAIE,EAAkBpD,KAAMsE,EAAYA,EAAY1C,OAIrEsC,EAAwBhE,UAAUU,eAAiB,SAAU6D,GAC9B,IAAtBzE,KAAKmE,QAAU,IAChBnE,KAAKS,YAAYI,YAGzBqD,EAAwBhE,UAAUC,WAAa,SAAUC,EAAYC,EAAYC,EAAYC,EAAYC,GACrG,IAAI4D,EAASpE,KAAKoE,OACdM,EAASN,EAAO9D,GAChBkE,EAAaxE,KAAKwE,UAEhBE,IAAWZ,IAAS9D,KAAKwE,UAAYxE,KAAKwE,UAD1C,EAENJ,EAAO9D,GAAcD,EACH,IAAdmE,IACIxE,KAAKgE,eACLhE,KAAK2E,mBAAmBP,GAGxBpE,KAAKS,YAAYC,KAAK0D,EAAOQ,WAIzCV,EAAwBhE,UAAUyE,mBAAqB,SAAUP,GAC7D,IAAIhC,EACJ,IACIA,EAASpC,KAAKgE,eAAejE,MAAMC,KAAMoE,GAE7C,MAAO3E,GAEH,YADAO,KAAKS,YAAYjB,MAAMC,GAG3BO,KAAKS,YAAYC,KAAK0B,IAEnB8B,EA7DiC,CA8D1C,GC/FE,EAA6B,SAAUrE,GAEvC,SAASgF,EAAYpB,EAAWqB,GAC5B,IAAI7D,EAAQpB,EAAOqB,KAAKlB,KAAMyD,EAAWqB,IAAS9E,KAIlD,OAHAiB,EAAMwC,UAAYA,EAClBxC,EAAM6D,KAAOA,EACb7D,EAAM8D,SAAU,EACT9D,EAiFX,OAvFA,IAAkB4D,EAAahF,GAQ/BgF,EAAY3E,UAAU0D,SAAW,SAAUoB,EAAOC,GAI9C,QAHc,IAAVA,IACAA,EAAQ,GAERjF,KAAK+B,OACL,OAAO/B,KAEXA,KAAKgF,MAAQA,EACb,IAAIE,EAAKlF,KAAKkF,GACVzB,EAAYzD,KAAKyD,UAOrB,OANU,MAANyB,IACAlF,KAAKkF,GAAKlF,KAAKmF,eAAe1B,EAAWyB,EAAID,IAEjDjF,KAAK+E,SAAU,EACf/E,KAAKiF,MAAQA,EACbjF,KAAKkF,GAAKlF,KAAKkF,IAAMlF,KAAKoF,eAAe3B,EAAWzD,KAAKkF,GAAID,GACtDjF,MAEX6E,EAAY3E,UAAUkF,eAAiB,SAAU3B,EAAWyB,EAAID,GAI5D,YAHc,IAAVA,IACAA,EAAQ,GAELI,YAAY5B,EAAU6B,MAAMC,KAAK9B,EAAWzD,MAAOiF,IAE9DJ,EAAY3E,UAAUiF,eAAiB,SAAU1B,EAAWyB,EAAID,GAI5D,QAHc,IAAVA,IACAA,EAAQ,GAEE,OAAVA,GAAkBjF,KAAKiF,QAAUA,IAA0B,IAAjBjF,KAAK+E,QAC/C,OAAOG,EAEXM,cAAcN,IAGlBL,EAAY3E,UAAUuF,QAAU,SAAUT,EAAOC,GAC7C,GAAIjF,KAAK+B,OACL,OAAO,IAAIrC,MAAM,gCAErBM,KAAK+E,SAAU,EACf,IAAIvF,EAAQQ,KAAK0F,SAASV,EAAOC,GACjC,GAAIzF,EACA,OAAOA,GAEe,IAAjBQ,KAAK+E,SAAgC,MAAX/E,KAAKkF,KACpClF,KAAKkF,GAAKlF,KAAKmF,eAAenF,KAAKyD,UAAWzD,KAAKkF,GAAI,QAG/DL,EAAY3E,UAAUwF,SAAW,SAAUV,EAAOC,GAC9C,IAAIU,GAAU,EACVC,OAAaC,EACjB,IACI7F,KAAK8E,KAAKE,GAEd,MAAOc,GACHH,GAAU,EACVC,IAAeE,GAAKA,GAAK,IAAIpG,MAAMoG,GAEvC,GAAIH,EAEA,OADA3F,KAAKuB,cACEqE,GAGff,EAAY3E,UAAU6F,aAAe,WACjC,IAAIb,EAAKlF,KAAKkF,GACVzB,EAAYzD,KAAKyD,UACjBuC,EAAUvC,EAAUuC,QACpB7E,EAAQ6E,EAAQC,QAAQjG,MAC5BA,KAAK8E,KAAO,KACZ9E,KAAKgF,MAAQ,KACbhF,KAAK+E,SAAU,EACf/E,KAAKyD,UAAY,MACF,IAAXtC,GACA6E,EAAQE,OAAO/E,EAAO,GAEhB,MAAN+D,IACAlF,KAAKkF,GAAKlF,KAAKmF,eAAe1B,EAAWyB,EAAI,OAEjDlF,KAAKiF,MAAQ,MAEVJ,EAxFqB,CCAJ,SAAUhF,GAElC,SAASsG,EAAO1C,EAAWqB,GACvB,OAAOjF,EAAOqB,KAAKlB,OAASA,KAQhC,OAVA,IAAkBmG,EAAQtG,GAI1BsG,EAAOjG,UAAU0D,SAAW,SAAUoB,EAAOC,GAIzC,YAHc,IAAVA,IACAA,EAAQ,GAELjF,MAEJmG,EAXgB,CAYzBxC,EAAA,ICfEyC,EAA2B,WAC3B,SAASA,EAAUC,EAAiBC,QACpB,IAARA,IACAA,EAAMF,EAAUE,KAEpBtG,KAAKqG,gBAAkBA,EACvBrG,KAAKsG,IAAMA,EASf,OAPAF,EAAUlG,UAAU0D,SAAW,SAAUkB,EAAMG,EAAOD,GAIlD,YAHc,IAAVC,IACAA,EAAQ,GAEL,IAAIjF,KAAKqG,gBAAgBrG,KAAM8E,GAAMlB,SAASoB,EAAOC,IAEhEmB,EAAUE,IAAM,WAAc,OAAOC,KAAKD,OACnCF,EAfmB,GCGnB,EAAsB,ICAG,SAAUvG,GAE1C,SAAS2G,EAAeH,EAAiBC,QACzB,IAARA,IACAA,EAAMF,EAAUE,KAEpB,IAAIrF,EAAQpB,EAAOqB,KAAKlB,KAAMqG,GAAiB,WAC3C,OAAIG,EAAeC,UAAYD,EAAeC,WAAaxF,EAChDuF,EAAeC,SAASH,MAGxBA,QAETtG,KAIN,OAHAiB,EAAM+E,QAAU,GAChB/E,EAAMkD,QAAS,EACflD,EAAMyF,eAAYb,EACX5E,EAkCX,OAlDA,IAAkBuF,EAAgB3G,GAkBlC2G,EAAetG,UAAU0D,SAAW,SAAUkB,EAAMG,EAAOD,GAIvD,YAHc,IAAVC,IACAA,EAAQ,GAERuB,EAAeC,UAAYD,EAAeC,WAAazG,KAChDwG,EAAeC,SAAS7C,SAASkB,EAAMG,EAAOD,GAG9CnF,EAAOK,UAAU0D,SAAS1C,KAAKlB,KAAM8E,EAAMG,EAAOD,IAGjEwB,EAAetG,UAAUoF,MAAQ,SAAUqB,GACvC,IAAIX,EAAUhG,KAAKgG,QACnB,GAAIhG,KAAKmE,OACL6B,EAAQzB,KAAKoC,OADjB,CAIA,IAAInH,EACJQ,KAAKmE,QAAS,EACd,GACI,GAAI3E,EAAQmH,EAAOlB,QAAQkB,EAAO3B,MAAO2B,EAAO1B,OAC5C,YAEC0B,EAASX,EAAQY,SAE1B,GADA5G,KAAKmE,QAAS,EACV3E,EAAO,CACP,KAAOmH,EAASX,EAAQY,SACpBD,EAAOpF,cAEX,MAAM/B,KAGPgH,EAnDwB,CAoDjCJ,GDpD+B,CAAmB,GEC7C,SAASS,EAASC,EAAQrD,GCF1B,IAAmBsD,EDetB,YAZe,IAAXD,IACAA,EAAS,QAEK,IAAdrD,IACAA,EAAY,GCPMsD,EDSPD,GCRP,OAAAE,EAAA,GAAQD,MAASA,EAAME,WAAWF,GAAO,GAAM,IDQ7BD,EAAS,KAC/BA,EAAS,GAERrD,GAA2C,mBAAvBA,EAAUG,WAC/BH,EAAY,GAET,IAAIH,EAAA,GAAW,SAAU3B,GAE5B,OADAA,EAAWuB,IAAIO,EAAUG,SAASsD,EAAUJ,EAAQ,CAAEnF,WAAYA,EAAYwF,QAAS,EAAGL,OAAQA,KAC3FnF,KAGf,SAASuF,EAASlC,GACd,IAAIrD,EAAaqD,EAAMrD,WAAYwF,EAAUnC,EAAMmC,QAASL,EAAS9B,EAAM8B,OAC3EnF,EAAWjB,KAAKyG,GAChBnH,KAAK4D,SAAS,CAAEjC,WAAYA,EAAYwF,QAASA,EAAU,EAAGL,OAAQA,GAAUA,G,oIEV7E,MAAMM,EACXC,YAA6BC,GAA8B,KAA9BA,gBAA8B,kBAC/CC,IACV,IAAM,EAAEC,EAAF,GAAKC,EAAL,MAASC,GAAUH,EACzB,MAAO,CACLI,KAAMJ,EAAKI,KACXH,IACAC,KACAC,MAAOA,EAAME,IAAI5H,KAAK6H,qBAPiC,wBAUzCC,IAChB,OAAQA,EAAKH,MACX,IAAK,SACH,OAAOG,EACT,IAAK,KACH,OAAO9H,KAAK+H,eAAeD,GAC7B,IAAK,SACH,OAAO9H,KAAKgI,mBAAmBF,GACjC,IAAK,KACH,OAAO9H,KAAKiI,eAAeH,GAC7B,IAAK,QACH,OAAO9H,KAAKkI,kBAAkBJ,MArBuB,0BAwB/B,IAAiD,IAAjD,KAAEH,EAAMQ,KAAMC,EAAd,KAAkBC,GAA+B,EAC3E,MAAO,CACLV,OACAQ,KAAMC,EACNC,KAAMA,EAAKT,IAAI5H,KAAKsI,mBA5BmC,2BA+B9B,IAID,IAJC,KAC3BX,EAD2B,GAE3BY,EAF2B,SAG3BC,GAC0B,GACnBC,EAAGC,GAAKF,EAASZ,IAAI5H,KAAKsI,gBACjC,MAAO,CAAEX,OAAMY,KAAIC,SAAU,CAACC,EAAGC,MArCwB,wBAuCjC,IAAyC,IAAzC,KAAEf,EAAF,KAAQgB,EAAR,KAAcN,GAA2B,EACjE,MAAO,CACLV,OACAgB,OACAN,KAAMA,EAAKT,IAAI5H,KAAKiI,mBA3CmC,4BA8C7B,IAIA,IAJA,KAC5BN,EAD4B,GAE5BzC,EAF4B,MAG5B/D,GAC4B,EAC5B,MAAO,CAAEwG,OAAMzC,KAAI/D,MAAOnB,KAAKsI,eAAenH,MAnDW,wBAqDjC2G,IACxB,IAAM,GAAE5C,GAAO4C,EACf,OAAI5C,KAAMlF,KAAKsH,cACNtH,KAAKsI,eAAetI,KAAKsH,cAAcpC,IAEvC4C,K,oBCrEAc,EAA2B,CACtCC,MAAO,EACPC,OAAQ,EACRC,MAAO,GACPC,MAAO,GAQIC,EAAWC,G,yICfjB,MAAMC,EACX9B,YAAmB+B,EAAsBC,GAAe,KAArCD,QAAqC,KAAfC,S,mPAD9BF,E,SAGMG,GAAcC,KAAKC,MAAMF,EDOjB,K,ECVdH,E,SAKMG,GAAcA,EDKN,I,ECVdH,E,IAOCG,IACV,IAAMG,EAASN,EAASM,OAAOH,GACzBR,EAASK,EAASL,OAAOQ,GAG/B,OAFW,MAEC,GAAKG,EAASF,KAAKG,IAAI,EAAG,EDFf,KCEmCZ,ICLvD,MAAMa,EAQXtC,YACmBuC,EACjB3F,EACA4F,GACA,KAHiBD,MAGjB,eAsCM,IAAM5J,KAAK4J,IAAIE,SArCrB,IAAMjB,EAAQ,IAAIkB,iBAAiBH,EAAK,QAAS,CAC/CI,eAAgBf,EAChBgB,iBAAkB,WAClBC,aAAc,IAEhBrB,EAAMsB,KAAKC,UAAYC,IACjBC,IAAOC,IAAIlJ,MACbwI,EAAQnJ,KAAK2J,EAAIG,MAEjBX,EAAQnJ,KAAKkI,IAIjBC,EAAM4B,iBAAmBhL,IACvBD,EAAMC,GAEN6K,IAAOC,IAAIlJ,OAAQ,GAGrBwH,EAAM6B,QAAQd,EAAInJ,aAElB6J,IAAOK,WAAWC,OAAOrI,UAAW,IAA6B,IAA3BsI,UAAWC,EAAKC,IAAW,EAC/DlC,EAAMmC,WAAWC,IAAI,SAASC,eAAeJ,EAAKlB,EAAIuB,aACtDtC,EAAMmC,WAAWC,IAAI,SAASC,eAAeH,EAAKnB,EAAIuB,eAGxD,IAAK,IAAI7B,EAAI,EAAGA,EAAIL,EAAUK,IAAK,CACjC,IAAM8B,EAAIjC,EAASiC,EAAE9B,GACf+B,EAAS,IAAIC,iBAAiB1B,EAAK,CACvCzB,KAAM,WACNoD,UAAWH,EACXI,EAAGJ,EAAI,IAETnH,EAAOyG,QAAQW,GAAQX,QAAQ7B,EAAO,EAAGS,K,2HA9ClCK,E,+BACK,UAAO8B,EAA0B5B,GAC/C,IAAMD,EAAM,IAAI8B,mBACV9B,EAAI+B,aAAaC,UAAUC,KACjC,IAAM5H,EAAS,IAAI6H,2BAA2BlC,EAAK,CAAE6B,gBACrD,OAAO,IAAI9B,EAAWC,EAAK3F,EAAQ4F,I,wOCNvC,IAIIkC,EAJEC,EAASC,oBAAU,SAEnBpC,EAAU,IAAIqC,IAAuBtD,GAC9BuD,EAActC,EAAQuC,eAGnC9B,IAAOC,IAAIK,OAAOrI,UAAlB,e,EAAA,G,EAA4B,aAA+B,IAAxB,SAAEsI,EAAF,MAAYwB,GAAY,EACzD,GAAIxB,EAAU,CACZmB,EAAOM,KAAK,sBACZ,IAAM1B,QAAe2B,UAAUC,aAAaC,aAAa,CAAEC,OAAO,IAClEV,EAAOM,KAAK,4BACZP,QAAcpC,EAAWgD,OAAO/B,EAAQf,QAExCmC,EAAOM,KAAK,uBACRP,UAAaA,EAAMjC,SACvBD,EAAQnJ,KAAKkI,I,+KATjB,uDCTuBW,KAAKC,MAAMoD,K,upBCQlC,IAAM/C,GAAU,IAAIgD,IACPC,GAAejD,GAAQuC,e,gUAEpC,IAAC,YACC,IAAMW,EAAUC,IACd,IAGMzF,EAHa,IAAIH,EAAW,CAChC6F,MAAOD,EAAQC,QAEOC,SAASF,EAAQzF,MAEzC,MAAO,CACLA,OACA4F,M,gWAHmB,CAAH,CAAKC,EAAGJ,EAAQI,EAAGC,QAAK7F,EAAGD,EAAKC,GAAMwF,EAAQN,OAI9DY,GAAI,CACFC,EAAGP,EAAQO,EACXC,EAAGR,EAAQQ,KAKbC,EAAQ,EAENC,EAAI,qBAAG,UAAOhB,GAClB,IACE7C,GAAQnJ,KACNqM,EAAO,CACLxF,KAAM+C,IAAO/C,KAAKlG,MAClB4L,MAAO3C,IAAO2C,MAAM5L,MACpBqL,QACAa,EAAGjD,IAAOiD,EAAElM,MACZmM,EAAGlD,IAAOkD,EAAEnM,MACZ+L,EAAGK,ID3CM,MC8Cb,MAAOhO,GACPD,EAAMC,OAbA,4DAiBJiO,EAAK9E,GAEX,IAAM+E,EAAS,qBAAG,UAAOjB,GACnBpC,IAAOsD,QAAQvM,cACXqM,EAAKhB,OAFA,uDd9CV,WAEH,IADA,IAAIrI,EAAc,GACTwJ,EAAK,EAAGA,EAAK5N,UAAU6B,OAAQ+L,IACpCxJ,EAAYwJ,GAAM5N,UAAU4N,GAEhC,IeZwBxM,EfYpB2C,EAAiB,KACjBP,EAAY,KAUhB,OevBwBpC,EfcRgD,EAAYA,EAAYvC,OAAS,KebP,mBAAnBT,EAAMuC,WfczBH,EAAYY,EAAYyJ,OAEuB,mBAAxCzJ,EAAYA,EAAYvC,OAAS,KACxCkC,EAAiBK,EAAYyJ,OAEN,IAAvBzJ,EAAYvC,QAAgB,OAAAkF,EAAA,GAAQ3C,EAAY,MAChDA,EAAcA,EAAY,IAEvBd,EAAUc,EAAaZ,GAAWsK,KAAK,IAAIhK,EAAsBC,KcoC1EgK,CAAc7B,EAAatF,EAAS,ID3DnB,KC2DgCtE,UAC9C,IAAD,IAAEkG,GAAF,SAASkF,EAAUlF,IACnBjJ,KA9CJ,G,4CEJA,IAAMwM,GAASC,oBAAU,QACzBD,GAAOiC,gBAAgB,QACvB,IAAMpE,GAAU,IAAIgD,IAEPqB,GAAarE,GAAQuC,eAM5B+B,GAAe,qBAAG,YACtBC,QAAQ9B,KAAK,yCACP+B,cAIN,MAAO,CAAEC,QAFQvB,GAAmBwB,YAAYxB,GAAQrK,KAAK8L,IAAKC,gBAJ/C,qDASrB,IAAC,YACC,IACIC,GADE,QAAEJ,SAAkBH,KAEtBQ,EAAS,EAEb5B,GAAoBxK,UAApB,qBACE,UAAMwK,GACJ,IAAI2B,EAAJ,CACAE,YAAM,SAAU7B,GAChBf,GAAO4C,MAAM,8BAA+B7B,GACxCxG,KAAKD,MAAQqI,GAAU,MACzB3C,GAAO4C,MAAP,+CAAqDhP,YAAGmN,KACxD4B,EAASpI,KAAKD,OAGhBoI,EAAWJ,EAAQvB,GACnB,IACElD,GAAQnJ,WAAWgO,GACnB,MAAOjP,GACPD,EAAMC,GAHR,QAKEiP,EAAW,UAhBjB,sDAmBEjP,GAAOD,EAAMC,MAxBjB,I,mBC/BAoP,EAAOC,QAAU,IAA0B","file":"5.e924335ecb0b848834c9.js","sourcesContent":["import * as log from 'loglevel';\n\nimport { pp } from '../pp';\n\nexport const error = (err: any): void => {\n  if (err instanceof Error) {\n    log.error(err);\n  } else {\n    log.error(pp(err));\n  }\n};\n","/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscriber } from './Subscriber';\nvar OuterSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(OuterSubscriber, _super);\n    function OuterSubscriber() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    OuterSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        this.destination.next(innerValue);\n    };\n    OuterSubscriber.prototype.notifyError = function (error, innerSub) {\n        this.destination.error(error);\n    };\n    OuterSubscriber.prototype.notifyComplete = function (innerSub) {\n        this.destination.complete();\n    };\n    return OuterSubscriber;\n}(Subscriber));\nexport { OuterSubscriber };\n//# sourceMappingURL=OuterSubscriber.js.map\n","/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscriber } from './Subscriber';\nvar InnerSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(InnerSubscriber, _super);\n    function InnerSubscriber(parent, outerValue, outerIndex) {\n        var _this = _super.call(this) || this;\n        _this.parent = parent;\n        _this.outerValue = outerValue;\n        _this.outerIndex = outerIndex;\n        _this.index = 0;\n        return _this;\n    }\n    InnerSubscriber.prototype._next = function (value) {\n        this.parent.notifyNext(this.outerValue, value, this.outerIndex, this.index++, this);\n    };\n    InnerSubscriber.prototype._error = function (error) {\n        this.parent.notifyError(error, this);\n        this.unsubscribe();\n    };\n    InnerSubscriber.prototype._complete = function () {\n        this.parent.notifyComplete(this);\n        this.unsubscribe();\n    };\n    return InnerSubscriber;\n}(Subscriber));\nexport { InnerSubscriber };\n//# sourceMappingURL=InnerSubscriber.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport var subscribeToArray = function (array) {\n    return function (subscriber) {\n        for (var i = 0, len = array.length; i < len && !subscriber.closed; i++) {\n            subscriber.next(array[i]);\n        }\n        subscriber.complete();\n    };\n};\n//# sourceMappingURL=subscribeToArray.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function getSymbolIterator() {\n    if (typeof Symbol !== 'function' || !Symbol.iterator) {\n        return '@@iterator';\n    }\n    return Symbol.iterator;\n}\nexport var iterator = /*@__PURE__*/ getSymbolIterator();\nexport var $$iterator = iterator;\n//# sourceMappingURL=iterator.js.map\n","/** PURE_IMPORTS_START _subscribeToArray,_subscribeToPromise,_subscribeToIterable,_subscribeToObservable,_isArrayLike,_isPromise,_isObject,_symbol_iterator,_symbol_observable PURE_IMPORTS_END */\nimport { subscribeToArray } from './subscribeToArray';\nimport { subscribeToPromise } from './subscribeToPromise';\nimport { subscribeToIterable } from './subscribeToIterable';\nimport { subscribeToObservable } from './subscribeToObservable';\nimport { isArrayLike } from './isArrayLike';\nimport { isPromise } from './isPromise';\nimport { isObject } from './isObject';\nimport { iterator as Symbol_iterator } from '../symbol/iterator';\nimport { observable as Symbol_observable } from '../symbol/observable';\nexport var subscribeTo = function (result) {\n    if (!!result && typeof result[Symbol_observable] === 'function') {\n        return subscribeToObservable(result);\n    }\n    else if (isArrayLike(result)) {\n        return subscribeToArray(result);\n    }\n    else if (isPromise(result)) {\n        return subscribeToPromise(result);\n    }\n    else if (!!result && typeof result[Symbol_iterator] === 'function') {\n        return subscribeToIterable(result);\n    }\n    else {\n        var value = isObject(result) ? 'an invalid object' : \"'\" + result + \"'\";\n        var msg = \"You provided \" + value + \" where a stream was expected.\"\n            + ' You can provide an Observable, Promise, Array, or Iterable.';\n        throw new TypeError(msg);\n    }\n};\n//# sourceMappingURL=subscribeTo.js.map\n","/** PURE_IMPORTS_START _symbol_observable PURE_IMPORTS_END */\nimport { observable as Symbol_observable } from '../symbol/observable';\nexport var subscribeToObservable = function (obj) {\n    return function (subscriber) {\n        var obs = obj[Symbol_observable]();\n        if (typeof obs.subscribe !== 'function') {\n            throw new TypeError('Provided object does not correctly implement Symbol.observable');\n        }\n        else {\n            return obs.subscribe(subscriber);\n        }\n    };\n};\n//# sourceMappingURL=subscribeToObservable.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport var isArrayLike = (function (x) { return x && typeof x.length === 'number' && typeof x !== 'function'; });\n//# sourceMappingURL=isArrayLike.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function isPromise(value) {\n    return !!value && typeof value.subscribe !== 'function' && typeof value.then === 'function';\n}\n//# sourceMappingURL=isPromise.js.map\n","/** PURE_IMPORTS_START _hostReportError PURE_IMPORTS_END */\nimport { hostReportError } from './hostReportError';\nexport var subscribeToPromise = function (promise) {\n    return function (subscriber) {\n        promise.then(function (value) {\n            if (!subscriber.closed) {\n                subscriber.next(value);\n                subscriber.complete();\n            }\n        }, function (err) { return subscriber.error(err); })\n            .then(null, hostReportError);\n        return subscriber;\n    };\n};\n//# sourceMappingURL=subscribeToPromise.js.map\n","/** PURE_IMPORTS_START _symbol_iterator PURE_IMPORTS_END */\nimport { iterator as Symbol_iterator } from '../symbol/iterator';\nexport var subscribeToIterable = function (iterable) {\n    return function (subscriber) {\n        var iterator = iterable[Symbol_iterator]();\n        do {\n            var item = iterator.next();\n            if (item.done) {\n                subscriber.complete();\n                break;\n            }\n            subscriber.next(item.value);\n            if (subscriber.closed) {\n                break;\n            }\n        } while (true);\n        if (typeof iterator.return === 'function') {\n            subscriber.add(function () {\n                if (iterator.return) {\n                    iterator.return();\n                }\n            });\n        }\n        return subscriber;\n    };\n};\n//# sourceMappingURL=subscribeToIterable.js.map\n","/** PURE_IMPORTS_START _InnerSubscriber,_subscribeTo,_Observable PURE_IMPORTS_END */\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeTo } from './subscribeTo';\nimport { Observable } from '../Observable';\nexport function subscribeToResult(outerSubscriber, result, outerValue, outerIndex, destination) {\n    if (destination === void 0) {\n        destination = new InnerSubscriber(outerSubscriber, outerValue, outerIndex);\n    }\n    if (destination.closed) {\n        return undefined;\n    }\n    if (result instanceof Observable) {\n        return result.subscribe(destination);\n    }\n    return subscribeTo(result)(destination);\n}\n//# sourceMappingURL=subscribeToResult.js.map\n","/** PURE_IMPORTS_START _Observable,_util_subscribeToArray,_scheduled_scheduleArray PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { subscribeToArray } from '../util/subscribeToArray';\nimport { scheduleArray } from '../scheduled/scheduleArray';\nexport function fromArray(input, scheduler) {\n    if (!scheduler) {\n        return new Observable(subscribeToArray(input));\n    }\n    else {\n        return scheduleArray(input, scheduler);\n    }\n}\n//# sourceMappingURL=fromArray.js.map\n","/** PURE_IMPORTS_START _Observable,_Subscription PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { Subscription } from '../Subscription';\nexport function scheduleArray(input, scheduler) {\n    return new Observable(function (subscriber) {\n        var sub = new Subscription();\n        var i = 0;\n        sub.add(scheduler.schedule(function () {\n            if (i === input.length) {\n                subscriber.complete();\n                return;\n            }\n            subscriber.next(input[i++]);\n            if (!subscriber.closed) {\n                sub.add(this.schedule());\n            }\n        }));\n        return sub;\n    });\n}\n//# sourceMappingURL=scheduleArray.js.map\n","/** PURE_IMPORTS_START tslib,_util_isScheduler,_util_isArray,_OuterSubscriber,_util_subscribeToResult,_fromArray PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { isScheduler } from '../util/isScheduler';\nimport { isArray } from '../util/isArray';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { fromArray } from './fromArray';\nvar NONE = {};\nexport function combineLatest() {\n    var observables = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        observables[_i] = arguments[_i];\n    }\n    var resultSelector = null;\n    var scheduler = null;\n    if (isScheduler(observables[observables.length - 1])) {\n        scheduler = observables.pop();\n    }\n    if (typeof observables[observables.length - 1] === 'function') {\n        resultSelector = observables.pop();\n    }\n    if (observables.length === 1 && isArray(observables[0])) {\n        observables = observables[0];\n    }\n    return fromArray(observables, scheduler).lift(new CombineLatestOperator(resultSelector));\n}\nvar CombineLatestOperator = /*@__PURE__*/ (function () {\n    function CombineLatestOperator(resultSelector) {\n        this.resultSelector = resultSelector;\n    }\n    CombineLatestOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new CombineLatestSubscriber(subscriber, this.resultSelector));\n    };\n    return CombineLatestOperator;\n}());\nexport { CombineLatestOperator };\nvar CombineLatestSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(CombineLatestSubscriber, _super);\n    function CombineLatestSubscriber(destination, resultSelector) {\n        var _this = _super.call(this, destination) || this;\n        _this.resultSelector = resultSelector;\n        _this.active = 0;\n        _this.values = [];\n        _this.observables = [];\n        return _this;\n    }\n    CombineLatestSubscriber.prototype._next = function (observable) {\n        this.values.push(NONE);\n        this.observables.push(observable);\n    };\n    CombineLatestSubscriber.prototype._complete = function () {\n        var observables = this.observables;\n        var len = observables.length;\n        if (len === 0) {\n            this.destination.complete();\n        }\n        else {\n            this.active = len;\n            this.toRespond = len;\n            for (var i = 0; i < len; i++) {\n                var observable = observables[i];\n                this.add(subscribeToResult(this, observable, observable, i));\n            }\n        }\n    };\n    CombineLatestSubscriber.prototype.notifyComplete = function (unused) {\n        if ((this.active -= 1) === 0) {\n            this.destination.complete();\n        }\n    };\n    CombineLatestSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        var values = this.values;\n        var oldVal = values[outerIndex];\n        var toRespond = !this.toRespond\n            ? 0\n            : oldVal === NONE ? --this.toRespond : this.toRespond;\n        values[outerIndex] = innerValue;\n        if (toRespond === 0) {\n            if (this.resultSelector) {\n                this._tryResultSelector(values);\n            }\n            else {\n                this.destination.next(values.slice());\n            }\n        }\n    };\n    CombineLatestSubscriber.prototype._tryResultSelector = function (values) {\n        var result;\n        try {\n            result = this.resultSelector.apply(this, values);\n        }\n        catch (err) {\n            this.destination.error(err);\n            return;\n        }\n        this.destination.next(result);\n    };\n    return CombineLatestSubscriber;\n}(OuterSubscriber));\nexport { CombineLatestSubscriber };\n//# sourceMappingURL=combineLatest.js.map\n","/** PURE_IMPORTS_START tslib,_Action PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Action } from './Action';\nvar AsyncAction = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(AsyncAction, _super);\n    function AsyncAction(scheduler, work) {\n        var _this = _super.call(this, scheduler, work) || this;\n        _this.scheduler = scheduler;\n        _this.work = work;\n        _this.pending = false;\n        return _this;\n    }\n    AsyncAction.prototype.schedule = function (state, delay) {\n        if (delay === void 0) {\n            delay = 0;\n        }\n        if (this.closed) {\n            return this;\n        }\n        this.state = state;\n        var id = this.id;\n        var scheduler = this.scheduler;\n        if (id != null) {\n            this.id = this.recycleAsyncId(scheduler, id, delay);\n        }\n        this.pending = true;\n        this.delay = delay;\n        this.id = this.id || this.requestAsyncId(scheduler, this.id, delay);\n        return this;\n    };\n    AsyncAction.prototype.requestAsyncId = function (scheduler, id, delay) {\n        if (delay === void 0) {\n            delay = 0;\n        }\n        return setInterval(scheduler.flush.bind(scheduler, this), delay);\n    };\n    AsyncAction.prototype.recycleAsyncId = function (scheduler, id, delay) {\n        if (delay === void 0) {\n            delay = 0;\n        }\n        if (delay !== null && this.delay === delay && this.pending === false) {\n            return id;\n        }\n        clearInterval(id);\n        return undefined;\n    };\n    AsyncAction.prototype.execute = function (state, delay) {\n        if (this.closed) {\n            return new Error('executing a cancelled action');\n        }\n        this.pending = false;\n        var error = this._execute(state, delay);\n        if (error) {\n            return error;\n        }\n        else if (this.pending === false && this.id != null) {\n            this.id = this.recycleAsyncId(this.scheduler, this.id, null);\n        }\n    };\n    AsyncAction.prototype._execute = function (state, delay) {\n        var errored = false;\n        var errorValue = undefined;\n        try {\n            this.work(state);\n        }\n        catch (e) {\n            errored = true;\n            errorValue = !!e && e || new Error(e);\n        }\n        if (errored) {\n            this.unsubscribe();\n            return errorValue;\n        }\n    };\n    AsyncAction.prototype._unsubscribe = function () {\n        var id = this.id;\n        var scheduler = this.scheduler;\n        var actions = scheduler.actions;\n        var index = actions.indexOf(this);\n        this.work = null;\n        this.state = null;\n        this.pending = false;\n        this.scheduler = null;\n        if (index !== -1) {\n            actions.splice(index, 1);\n        }\n        if (id != null) {\n            this.id = this.recycleAsyncId(scheduler, id, null);\n        }\n        this.delay = null;\n    };\n    return AsyncAction;\n}(Action));\nexport { AsyncAction };\n//# sourceMappingURL=AsyncAction.js.map\n","/** PURE_IMPORTS_START tslib,_Subscription PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscription } from '../Subscription';\nvar Action = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(Action, _super);\n    function Action(scheduler, work) {\n        return _super.call(this) || this;\n    }\n    Action.prototype.schedule = function (state, delay) {\n        if (delay === void 0) {\n            delay = 0;\n        }\n        return this;\n    };\n    return Action;\n}(Subscription));\nexport { Action };\n//# sourceMappingURL=Action.js.map\n","var Scheduler = /*@__PURE__*/ (function () {\n    function Scheduler(SchedulerAction, now) {\n        if (now === void 0) {\n            now = Scheduler.now;\n        }\n        this.SchedulerAction = SchedulerAction;\n        this.now = now;\n    }\n    Scheduler.prototype.schedule = function (work, delay, state) {\n        if (delay === void 0) {\n            delay = 0;\n        }\n        return new this.SchedulerAction(this, work).schedule(state, delay);\n    };\n    Scheduler.now = function () { return Date.now(); };\n    return Scheduler;\n}());\nexport { Scheduler };\n//# sourceMappingURL=Scheduler.js.map\n","/** PURE_IMPORTS_START _AsyncAction,_AsyncScheduler PURE_IMPORTS_END */\nimport { AsyncAction } from './AsyncAction';\nimport { AsyncScheduler } from './AsyncScheduler';\nexport var async = /*@__PURE__*/ new AsyncScheduler(AsyncAction);\n//# sourceMappingURL=async.js.map\n","/** PURE_IMPORTS_START tslib,_Scheduler PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Scheduler } from '../Scheduler';\nvar AsyncScheduler = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(AsyncScheduler, _super);\n    function AsyncScheduler(SchedulerAction, now) {\n        if (now === void 0) {\n            now = Scheduler.now;\n        }\n        var _this = _super.call(this, SchedulerAction, function () {\n            if (AsyncScheduler.delegate && AsyncScheduler.delegate !== _this) {\n                return AsyncScheduler.delegate.now();\n            }\n            else {\n                return now();\n            }\n        }) || this;\n        _this.actions = [];\n        _this.active = false;\n        _this.scheduled = undefined;\n        return _this;\n    }\n    AsyncScheduler.prototype.schedule = function (work, delay, state) {\n        if (delay === void 0) {\n            delay = 0;\n        }\n        if (AsyncScheduler.delegate && AsyncScheduler.delegate !== this) {\n            return AsyncScheduler.delegate.schedule(work, delay, state);\n        }\n        else {\n            return _super.prototype.schedule.call(this, work, delay, state);\n        }\n    };\n    AsyncScheduler.prototype.flush = function (action) {\n        var actions = this.actions;\n        if (this.active) {\n            actions.push(action);\n            return;\n        }\n        var error;\n        this.active = true;\n        do {\n            if (error = action.execute(action.state, action.delay)) {\n                break;\n            }\n        } while (action = actions.shift());\n        this.active = false;\n        if (error) {\n            while (action = actions.shift()) {\n                action.unsubscribe();\n            }\n            throw error;\n        }\n    };\n    return AsyncScheduler;\n}(Scheduler));\nexport { AsyncScheduler };\n//# sourceMappingURL=AsyncScheduler.js.map\n","/** PURE_IMPORTS_START _Observable,_scheduler_async,_util_isNumeric PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { async } from '../scheduler/async';\nimport { isNumeric } from '../util/isNumeric';\nexport function interval(period, scheduler) {\n    if (period === void 0) {\n        period = 0;\n    }\n    if (scheduler === void 0) {\n        scheduler = async;\n    }\n    if (!isNumeric(period) || period < 0) {\n        period = 0;\n    }\n    if (!scheduler || typeof scheduler.schedule !== 'function') {\n        scheduler = async;\n    }\n    return new Observable(function (subscriber) {\n        subscriber.add(scheduler.schedule(dispatch, period, { subscriber: subscriber, counter: 0, period: period }));\n        return subscriber;\n    });\n}\nfunction dispatch(state) {\n    var subscriber = state.subscriber, counter = state.counter, period = state.period;\n    subscriber.next(counter);\n    this.schedule({ subscriber: subscriber, counter: counter + 1, period: period }, period);\n}\n//# sourceMappingURL=interval.js.map\n","/** PURE_IMPORTS_START _isArray PURE_IMPORTS_END */\nimport { isArray } from './isArray';\nexport function isNumeric(val) {\n    return !isArray(val) && (val - parseFloat(val) + 1) >= 0;\n}\n//# sourceMappingURL=isNumeric.js.map\n","import {\n  AccessNode,\n  ArithNode,\n  FnNode,\n  IdNode,\n  PipeNode,\n  Scalar,\n  StepNode\n} from './ast';\nimport { Defs } from './types';\n\nexport type Substitutions = {\n  [id in keyof Defs]: Scalar;\n};\n\nexport class Simplifier {\n  constructor(private readonly substitutions: Substitutions) {}\n  simplify = (pipe: PipeNode): PipeNode => {\n    const { n, d0, steps } = pipe;\n    return {\n      kind: pipe.kind,\n      n,\n      d0,\n      steps: steps.map(this.simplifyStepNode)\n    };\n  };\n  simplifyScalar = (node: Scalar): Scalar => {\n    switch (node.kind) {\n      case 'number':\n        return node;\n      case 'fn':\n        return this.simplifyFnNode(node);\n      case 'access':\n        return this.simplifyAccessNode(node);\n      case 'id':\n        return this.simplifyIdNode(node);\n      case 'arith':\n        return this.simplifyArithNode(node);\n    }\n  };\n  private simplifyStepNode = ({ kind, type: fn, args }: StepNode): StepNode => {\n    return {\n      kind,\n      type: fn,\n      args: args.map(this.simplifyScalar)\n    };\n  };\n  private simplifyArithNode = ({\n    kind,\n    op,\n    operands\n  }: ArithNode): ArithNode => {\n    const [a, b] = operands.map(this.simplifyScalar);\n    return { kind, op, operands: [a, b] };\n  };\n  private simplifyFnNode = ({ kind, name, args }: FnNode): FnNode => {\n    return {\n      kind,\n      name,\n      args: args.map(this.simplifyIdNode)\n    };\n  };\n  private simplifyAccessNode = ({\n    kind,\n    id,\n    index\n  }: AccessNode): AccessNode => {\n    return { kind, id, index: this.simplifyScalar(index) };\n  };\n  private simplifyIdNode = (node: IdNode): Scalar => {\n    const { id } = node;\n    if (id in this.substitutions) {\n      return this.simplifyScalar(this.substitutions[id]);\n    } else {\n      return node;\n    }\n  };\n}\n","import { Audio } from './types';\n\n/**\n * This defines the placeholder used for power and chroma when audio is not enabled.\n */\nexport const AUDIO_PLACEHOLDER: Audio = {\n  power: 1,\n  chroma: 0,\n  tempo: 0.5,\n  onset: 1\n};\n\nexport const chromaCount = 12;\nexport const octaveMin = 0;\nexport const octaveMax = 8;\nexport const octaveCount = octaveMax - octaveMin;\nexport const quantumSize = 128;\nexport const binCount = octaveCount * chromaCount;\n","import { chromaCount } from './constants';\n\nexport class Spectrum {\n  constructor(public dbMin: number, public dbMax: number) {}\n\n  static octave = (k: number) => Math.floor(k / chromaCount);\n\n  static chroma = (k: number) => k % chromaCount;\n\n  static f = (k: number): number => {\n    const octave = Spectrum.octave(k);\n    const chroma = Spectrum.chroma(k);\n    const c0 = 16.35; // c0 per https://pages.mtu.edu/~suits/notefreqs.html\n\n    return c0 * 2 ** octave * Math.pow(2, 1 / chromaCount) ** chroma;\n  };\n}\n","import { Subject } from 'rxjs';\n\nimport { error } from '../error';\nimport { inputs } from '../inputs';\nimport { AUDIO_PLACEHOLDER, binCount } from './constants';\nimport processorUrl from './power.worklet';\nimport { Spectrum } from './spectrum';\nimport { Audio } from './types';\n\nexport class AudioGraph {\n  static create = async (mediaStream: MediaStream, subject: Subject<Audio>) => {\n    const ctx = new AudioContext();\n    await ctx.audioWorklet.addModule(processorUrl);\n    const source = new MediaStreamAudioSourceNode(ctx, { mediaStream });\n    return new AudioGraph(ctx, source, subject);\n  };\n\n  constructor(\n    private readonly ctx: AudioContext,\n    source: AudioNode,\n    subject: Subject<Audio>\n  ) {\n    const power = new AudioWorkletNode(ctx, 'power', {\n      numberOfInputs: binCount,\n      channelCountMode: 'explicit',\n      channelCount: 1\n    });\n    power.port.onmessage = msg => {\n      if (inputs.mic.value) {\n        subject.next(msg.data as Audio);\n      } else {\n        subject.next(AUDIO_PLACEHOLDER);\n      }\n    };\n\n    power.onprocessorerror = err => {\n      error(err);\n      // processor dies after an error, so close the graph\n      inputs.mic.value = false;\n    };\n\n    power.connect(ctx.destination);\n\n    inputs.allowedDbs.stream.subscribe(({ newValue: [min, max] }) => {\n      power.parameters.get('dbMin').setValueAtTime(min, ctx.currentTime);\n      power.parameters.get('dbMax').setValueAtTime(max, ctx.currentTime);\n    });\n\n    for (let k = 0; k < binCount; k++) {\n      const f = Spectrum.f(k);\n      const filter = new BiquadFilterNode(ctx, {\n        type: 'bandpass',\n        frequency: f,\n        Q: f / 2\n      });\n      source.connect(filter).connect(power, 0, k);\n    }\n  }\n\n  close = () => this.ctx.close();\n}\n","import { getLogger } from 'loglevel';\nimport { BehaviorSubject, Observable, interval } from 'rxjs';\n\nimport { inputs } from '../inputs';\nimport { AUDIO_PLACEHOLDER } from './constants';\nimport { AudioGraph } from './graph';\nimport { Audio } from './types';\n\nconst logger = getLogger('Audio');\n\nconst subject = new BehaviorSubject<Audio>(AUDIO_PLACEHOLDER);\nexport const audioStream = subject.asObservable();\nlet graph: AudioGraph;\n\ninputs.mic.stream.subscribe(async ({ newValue, event }) => {\n  if (newValue) {\n    logger.info('getting user media');\n    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n    logger.info('starting new audio graph');\n    graph = await AudioGraph.create(stream, subject);\n  } else {\n    logger.info('closing audio graph');\n    if (graph) await graph.close();\n    subject.next(AUDIO_PLACEHOLDER);\n  }\n});\n","// TODO make these inputs :D\nexport const fps = 60;\nexport const dataSampleRate = fps / 1000;\nexport const audioSampleRate = 2 * dataSampleRate;\nexport const fftSize = 1024;\nexport const psdSize = Math.floor(fftSize / 2) + 1;\n","import { Subject, combineLatest, interval } from 'rxjs';\n\nimport { inf } from '../../constants';\nimport { Simplifier } from '../../pipe/simplifier';\nimport { Params, Scope } from '../../pipe/types';\nimport { audioStream } from '../audio';\nimport { AUDIO_PLACEHOLDER } from '../audio/constants';\nimport { Audio } from '../audio/types';\nimport { fps } from '../constants';\nimport { error } from '../error';\nimport { inputs } from '../inputs';\nimport { Options } from './options';\n\nconst subject = new Subject<Params>();\nexport const paramsStream = subject.asObservable();\n\n(async () => {\n  const params = (options: Options) => {\n    const simplifier = new Simplifier({\n      theta: options.theta\n    });\n    const pipe = simplifier.simplify(options.pipe);\n    const scope: Scope = { t: options.t, inf, n: pipe.n, ...options.audio };\n    return {\n      pipe,\n      scope,\n      hv: {\n        h: options.h,\n        v: options.v\n      }\n    };\n  };\n\n  let count = 0;\n\n  const emit = async (audio: Audio) => {\n    try {\n      subject.next(\n        params({\n          pipe: inputs.pipe.value,\n          theta: inputs.theta.value,\n          audio,\n          h: inputs.h.value,\n          v: inputs.v.value,\n          t: count++ / fps\n        })\n      );\n    } catch (err) {\n      error(err);\n    }\n  };\n\n  await emit(AUDIO_PLACEHOLDER);\n\n  const maybeEmit = async (audio: Audio) => {\n    if (inputs.animate.value) {\n      await emit(audio);\n    }\n  };\n\n  combineLatest(audioStream, interval(1000 / fps)).subscribe(\n    ([a]) => maybeEmit(a),\n    error\n  );\n})();\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function isScheduler(value) {\n    return value && typeof value.schedule === 'function';\n}\n//# sourceMappingURL=isScheduler.js.map\n","import { getLogger } from 'loglevel';\nimport { EMPTY, Observable, Subject, interval, timer } from 'rxjs';\nimport { delayWhen, repeatWhen, retryWhen, tap } from 'rxjs/operators';\n\nimport { Data } from '../data';\nimport { runPipeline, startPool } from '../pipe/pool';\nimport { Params } from '../pipe/types';\nimport { pp } from '../pp';\nimport debug from './debug';\nimport { error } from './error';\nimport * as params from './params';\n\nconst logger = getLogger('Data');\nlogger.setDefaultLevel('info');\nconst subject = new Subject<Data>();\n\nexport const dataStream = subject.asObservable();\n\ntype Source = {\n  getData(params: Params): Promise<Data>;\n};\n\nconst webWorkerSource = async (): Promise<Source> => {\n  console.info('starting web worker data source');\n  await startPool();\n\n  const getData = (params: Params) => runPipeline(params).then(Data.fromBuffer);\n\n  return { getData };\n};\n\n(async () => {\n  const { getData } = await webWorkerSource();\n  let inFlight: Promise<Data> | null;\n  let logged = 0;\n\n  params.paramsStream.subscribe(\n    async params => {\n      if (inFlight) return;\n      debug('params', params);\n      logger.debug('requesting data with params', params);\n      if (Date.now() - logged >= 1000) {\n        logger.debug(`sending request for data with params ${pp(params)}`);\n        logged = Date.now();\n      }\n      // TODO i feel like there's a more rx-y way to do this\n      inFlight = getData(params);\n      try {\n        subject.next(await inFlight);\n      } catch (err) {\n        error(err);\n      } finally {\n        inFlight = null;\n      }\n    },\n    err => error(err)\n  );\n})();\n","module.exports = __webpack_public_path__ + \"eb34d8c1f3aeee04efd5.worklet.js\";"],"sourceRoot":""}