{"version":3,"sources":["webpack:///./src/web/audio/constants.ts","webpack:///./src/web/audio/spectrum.ts","webpack:///./src/web/error.ts","webpack:///./src/web/audio/graph.ts","webpack:///./src/web/audio/index.ts","webpack:///./node_modules/rxjs/_esm5/internal/OuterSubscriber.js","webpack:///./node_modules/rxjs/_esm5/internal/InnerSubscriber.js","webpack:///./node_modules/rxjs/_esm5/internal/util/subscribeToArray.js","webpack:///./node_modules/rxjs/_esm5/internal/symbol/iterator.js","webpack:///./node_modules/rxjs/_esm5/internal/util/subscribeTo.js","webpack:///./node_modules/rxjs/_esm5/internal/util/subscribeToObservable.js","webpack:///./node_modules/rxjs/_esm5/internal/util/isArrayLike.js","webpack:///./node_modules/rxjs/_esm5/internal/util/isPromise.js","webpack:///./node_modules/rxjs/_esm5/internal/util/subscribeToPromise.js","webpack:///./node_modules/rxjs/_esm5/internal/util/subscribeToIterable.js","webpack:///./node_modules/rxjs/_esm5/internal/util/subscribeToResult.js","webpack:///./node_modules/rxjs/_esm5/internal/observable/fromArray.js","webpack:///./node_modules/rxjs/_esm5/internal/scheduled/scheduleArray.js","webpack:///./node_modules/rxjs/_esm5/internal/observable/combineLatest.js","webpack:///./node_modules/rxjs/_esm5/internal/scheduler/AsyncAction.js","webpack:///./node_modules/rxjs/_esm5/internal/scheduler/Action.js","webpack:///./node_modules/rxjs/_esm5/internal/Scheduler.js","webpack:///./node_modules/rxjs/_esm5/internal/scheduler/async.js","webpack:///./node_modules/rxjs/_esm5/internal/scheduler/AsyncScheduler.js","webpack:///./node_modules/rxjs/_esm5/internal/observable/interval.js","webpack:///./src/web/constants.ts","webpack:///./src/core/pipe/parser.ts","webpack:///./src/core/pipe/compiler.ts","webpack:///./src/web/params.ts","webpack:///./node_modules/rxjs/_esm5/internal/util/isNumeric.js","webpack:///./node_modules/rxjs/_esm5/internal/util/isScheduler.js","webpack:///./src/web/data.ts","webpack:///./src/web/audio/power.worklet.ts","webpack:///./src/core/pipe/grammar.pegjs"],"names":["AUDIO_PLACEHOLDER","power","chroma","tempo","onset","binCount","octaveCount","Spectrum","constructor","dbMin","dbMax","k","Math","floor","octave","pow","error","err","Error","log","pp","AudioGraph","ctx","source","subject","this","close","AudioWorkletNode","numberOfInputs","channelCountMode","channelCount","port","onmessage","msg","inputs","mic","value","next","data","onprocessorerror","connect","destination","allowedDbs","stream","subscribe","newValue","min","max","parameters","get","setValueAtTime","currentTime","f","filter","BiquadFilterNode","type","frequency","Q","mediaStream","AudioContext","audioWorklet","addModule","processorUrl","MediaStreamAudioSourceNode","graph","logger","getLogger","BehaviorSubject","audioStream","asObservable","event","info","navigator","mediaDevices","getUserMedia","audio","create","_super","OuterSubscriber","apply","arguments","prototype","notifyNext","outerValue","innerValue","outerIndex","innerIndex","innerSub","notifyError","notifyComplete","complete","Subscriber","InnerSubscriber","parent","_this","call","index","_next","_error","unsubscribe","_complete","subscribeToArray","array","subscriber","i","len","length","closed","getSymbolIterator","Symbol","iterator","subscribeTo","result","obj","obs","TypeError","x","then","isPromise","promise","hostReportError","iterable","item","done","return","add","isObject","subscribeToResult","outerSubscriber","Observable","fromArray","input","scheduler","sub","Subscription","schedule","scheduleArray","NONE","CombineLatestOperator","resultSelector","CombineLatestSubscriber","active","values","observables","observable","push","toRespond","unused","oldVal","_tryResultSelector","slice","AsyncAction","work","pending","state","delay","id","recycleAsyncId","requestAsyncId","setInterval","flush","bind","clearInterval","execute","_execute","errored","errorValue","undefined","e","_unsubscribe","actions","indexOf","splice","Action","Scheduler","SchedulerAction","now","Date","AsyncScheduler","delegate","scheduled","action","shift","dispatch","counter","period","fftSize","Parser","pipe","parse","expr","startRule","Compiler","defs","ast","simplifier","simplify","parsePipe","n","Interval","nPerLevel","d0","parseScalar","simplifyScalar","Simplifier","theta","compile","compilePipe","compileScalar","substitutions","steps","kind","map","simplifyStepNode","node","simplifyFnNode","simplifyAccessNode","simplifyIdNode","simplifyArithNode","fn","args","op","operands","a","b","name","params","t","compiler","scope","inf","hv","h","v","emit","Subject","val","paramsStream","count","_i","pop","isArray","lift","combineLatest","parseFloat","animate","setDefaultLevel","dataStream","webWorkerSource","console","startPool","getData","runPipeline","Data","fromBuffer","inFlight","logged","debug","module","exports","peg$SyntaxError","message","expected","found","location","captureStackTrace","child","ctor","peg$subclass","buildMessage","DESCRIBE_EXPECTATION_FNS","literal","expectation","literalEscape","text","escapedParts","parts","Array","classEscape","inverted","any","end","other","description","hex","ch","charCodeAt","toString","toUpperCase","s","replace","j","descriptions","sort","join","describeExpected","describeFound","SyntaxError","options","peg$result","peg$FAILED","peg$startRuleFunctions","peg$parsepipe","scalar","peg$parsescalar","peg$startRuleFunction","peg$c0","peg$c1","peg$otherExpectation","peg$c2","parseInt","peg$computeLocation","peg$savedPos","peg$currPos","peg$buildStructuredError","substring","peg$c3","head","tail","peg$c4","step","peg$c5","peg$c6","peg$c7","peg$literalExpectation","peg$c8","peg$c9","peg$c10","peg$c11","peg$c12","r","peg$c13","peg$c14","peg$c15","peg$c16","peg$c17","peg$c18","peg$c19","peg$c20","peg$c21","peg$c22","peg$c23","peg$c24","peg$c25","peg$c26","peg$c27","peg$c28","peg$c29","d1","peg$c30","f0","peg$c31","f1","peg$c32","peg$c33","peg$c34","peg$c35","to","peg$c36","arg","peg$c37","peg$c38","peg$c39","peg$c40","peg$c41","toLowerCase","peg$c42","peg$c43","peg$c44","peg$c45","peg$c46","peg$c47","peg$c48","peg$c49","peg$c50","peg$classExpectation","peg$c51","peg$c52","peg$c53","peg$c54","peg$c55","peg$c56","peg$c57","peg$c58","peg$c59","peg$c60","peg$c61","peg$c62","peg$c63","peg$c64","peg$c65","peg$c66","peg$c67","peg$c68","peg$c69","peg$c70","peg$c71","peg$c72","peg$c73","peg$c74","peg$c75","peg$c76","peg$c77","peg$c78","peg$c79","peg$c80","peg$c81","peg$c82","peg$c83","peg$c84","peg$c85","peg$c86","peg$c87","peg$c88","peg$c89","peg$c90","peg$c91","peg$c92","peg$c93","peg$c94","peg$c95","peg$c96","peg$c97","peg$c98","peg$c99","peg$c100","peg$c101","peg$posDetailsCache","line","column","peg$maxFailPos","peg$maxFailExpected","peg$silentFails","ignoreCase","peg$computePosDetails","pos","p","details","startPos","endPos","startPosDetails","endPosDetails","start","offset","peg$fail","s0","s1","s3","s5","peg$parsepint","peg$parseconnector","peg$parsesteps","peg$parsestep","peg$parseuint","s2","substr","peg$parselparen","peg$parserparen","peg$parsecube","peg$parsesphere","peg$parsecomma","peg$parsespiral","peg$parsetorus","peg$parsefucked_up_torus","s7","s8","s9","s10","s11","charAt","peg$parseid","peg$parserotate","peg$parsestereo","peg$parseterm","peg$parse_","peg$parseoperator","s4","s6","test","peg$parsemantissa","peg$parseint","peg$parsefloat","peg$parsenumber","peg$parseidentifier","peg$parsefn_args","peg$parselbrack","peg$parserbrack","peg$parse__"],"mappings":"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","file":"5.b8780a12987b89a631ec.js","sourcesContent":["import { Audio } from './types';\n\n/**\n * This defines the placeholder used for power and chroma when audio is not enabled.\n */\nexport const AUDIO_PLACEHOLDER: Audio = {\n  power: 1,\n  chroma: 0,\n  tempo: 0.5,\n  onset: 1,\n};\n\nexport const chromaCount = 12;\nexport const octaveMin = 0;\nexport const octaveMax = 8;\nexport const octaveCount = octaveMax - octaveMin;\nexport const quantumSize = 128;\nexport const binCount = octaveCount * chromaCount;\n","import { chromaCount } from './constants';\n\nexport class Spectrum {\n  constructor(public dbMin: number, public dbMax: number) {}\n\n  static octave = (k: number) => Math.floor(k / chromaCount);\n\n  static chroma = (k: number) => k % chromaCount;\n\n  static f = (k: number): number => {\n    const octave = Spectrum.octave(k);\n    const chroma = Spectrum.chroma(k);\n    const c0 = 16.35; // c0 per https://pages.mtu.edu/~suits/notefreqs.html\n\n    return c0 * 2 ** octave * Math.pow(2, 1 / chromaCount) ** chroma;\n  };\n}\n","import { pp } from '../core/pp';\nimport * as log from 'loglevel';\n\nexport const error = (err: any): void => {\n  if (err instanceof Error) {\n    log.error(err);\n  } else {\n    log.error(pp(err));\n  }\n};\n","import { Subject } from 'rxjs';\nimport { Audio } from './types';\nimport { Spectrum } from './spectrum';\nimport { binCount, AUDIO_PLACEHOLDER } from './constants';\nimport processorUrl from './power.worklet';\nimport { error } from '../error';\nimport { inputs } from '../inputs';\n\nexport class AudioGraph {\n  static create = async (mediaStream: MediaStream, subject: Subject<Audio>) => {\n    const ctx = new AudioContext();\n    await ctx.audioWorklet.addModule(processorUrl);\n    const source = new MediaStreamAudioSourceNode(ctx, { mediaStream });\n    return new AudioGraph(ctx, source, subject);\n  };\n\n  constructor(\n    private readonly ctx: AudioContext,\n    source: AudioNode,\n    subject: Subject<Audio>,\n  ) {\n    const power = new AudioWorkletNode(ctx, 'power', {\n      numberOfInputs: binCount,\n      channelCountMode: 'explicit',\n      channelCount: 1,\n    });\n    power.port.onmessage = msg => {\n      if (inputs.mic.value) {\n        subject.next(msg.data as Audio);\n      } else {\n        subject.next(AUDIO_PLACEHOLDER);\n      }\n    };\n\n    power.onprocessorerror = err => {\n      error(err);\n      // processor dies after an error, so close the graph\n      inputs.mic.value = false;\n    };\n\n    power.connect(ctx.destination);\n\n    inputs.allowedDbs.stream.subscribe(({ newValue: [min, max] }) => {\n      power.parameters.get('dbMin').setValueAtTime(min, ctx.currentTime);\n      power.parameters.get('dbMax').setValueAtTime(max, ctx.currentTime);\n    });\n\n    for (let k = 0; k < binCount; k++) {\n      const f = Spectrum.f(k);\n      const filter = new BiquadFilterNode(ctx, {\n        type: 'bandpass',\n        frequency: f,\n        Q: f / 2,\n      });\n      source.connect(filter).connect(power, 0, k);\n    }\n  }\n\n  close = () => this.ctx.close();\n}\n","import { BehaviorSubject, interval, Observable } from 'rxjs';\nimport { getLogger } from 'loglevel';\nimport { inputs } from '../inputs';\nimport { Audio } from './types';\nimport { AUDIO_PLACEHOLDER } from './constants';\nimport { AudioGraph } from './graph';\n\nconst logger = getLogger('Audio');\n\nconst subject = new BehaviorSubject<Audio>(AUDIO_PLACEHOLDER);\nexport const audioStream = subject.asObservable();\nlet graph: AudioGraph;\n\ninputs.mic.stream.subscribe(async ({ newValue, event }) => {\n  if (newValue) {\n    logger.info('getting user media');\n    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n    logger.info('starting new audio graph');\n    graph = await AudioGraph.create(stream, subject);\n  } else {\n    logger.info('closing audio graph');\n    if (graph) await graph.close();\n    subject.next(AUDIO_PLACEHOLDER);\n  }\n});\n","/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscriber } from './Subscriber';\nvar OuterSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(OuterSubscriber, _super);\n    function OuterSubscriber() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    OuterSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        this.destination.next(innerValue);\n    };\n    OuterSubscriber.prototype.notifyError = function (error, innerSub) {\n        this.destination.error(error);\n    };\n    OuterSubscriber.prototype.notifyComplete = function (innerSub) {\n        this.destination.complete();\n    };\n    return OuterSubscriber;\n}(Subscriber));\nexport { OuterSubscriber };\n//# sourceMappingURL=OuterSubscriber.js.map\n","/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscriber } from './Subscriber';\nvar InnerSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(InnerSubscriber, _super);\n    function InnerSubscriber(parent, outerValue, outerIndex) {\n        var _this = _super.call(this) || this;\n        _this.parent = parent;\n        _this.outerValue = outerValue;\n        _this.outerIndex = outerIndex;\n        _this.index = 0;\n        return _this;\n    }\n    InnerSubscriber.prototype._next = function (value) {\n        this.parent.notifyNext(this.outerValue, value, this.outerIndex, this.index++, this);\n    };\n    InnerSubscriber.prototype._error = function (error) {\n        this.parent.notifyError(error, this);\n        this.unsubscribe();\n    };\n    InnerSubscriber.prototype._complete = function () {\n        this.parent.notifyComplete(this);\n        this.unsubscribe();\n    };\n    return InnerSubscriber;\n}(Subscriber));\nexport { InnerSubscriber };\n//# sourceMappingURL=InnerSubscriber.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport var subscribeToArray = function (array) {\n    return function (subscriber) {\n        for (var i = 0, len = array.length; i < len && !subscriber.closed; i++) {\n            subscriber.next(array[i]);\n        }\n        subscriber.complete();\n    };\n};\n//# sourceMappingURL=subscribeToArray.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function getSymbolIterator() {\n    if (typeof Symbol !== 'function' || !Symbol.iterator) {\n        return '@@iterator';\n    }\n    return Symbol.iterator;\n}\nexport var iterator = /*@__PURE__*/ getSymbolIterator();\nexport var $$iterator = iterator;\n//# sourceMappingURL=iterator.js.map\n","/** PURE_IMPORTS_START _subscribeToArray,_subscribeToPromise,_subscribeToIterable,_subscribeToObservable,_isArrayLike,_isPromise,_isObject,_symbol_iterator,_symbol_observable PURE_IMPORTS_END */\nimport { subscribeToArray } from './subscribeToArray';\nimport { subscribeToPromise } from './subscribeToPromise';\nimport { subscribeToIterable } from './subscribeToIterable';\nimport { subscribeToObservable } from './subscribeToObservable';\nimport { isArrayLike } from './isArrayLike';\nimport { isPromise } from './isPromise';\nimport { isObject } from './isObject';\nimport { iterator as Symbol_iterator } from '../symbol/iterator';\nimport { observable as Symbol_observable } from '../symbol/observable';\nexport var subscribeTo = function (result) {\n    if (!!result && typeof result[Symbol_observable] === 'function') {\n        return subscribeToObservable(result);\n    }\n    else if (isArrayLike(result)) {\n        return subscribeToArray(result);\n    }\n    else if (isPromise(result)) {\n        return subscribeToPromise(result);\n    }\n    else if (!!result && typeof result[Symbol_iterator] === 'function') {\n        return subscribeToIterable(result);\n    }\n    else {\n        var value = isObject(result) ? 'an invalid object' : \"'\" + result + \"'\";\n        var msg = \"You provided \" + value + \" where a stream was expected.\"\n            + ' You can provide an Observable, Promise, Array, or Iterable.';\n        throw new TypeError(msg);\n    }\n};\n//# sourceMappingURL=subscribeTo.js.map\n","/** PURE_IMPORTS_START _symbol_observable PURE_IMPORTS_END */\nimport { observable as Symbol_observable } from '../symbol/observable';\nexport var subscribeToObservable = function (obj) {\n    return function (subscriber) {\n        var obs = obj[Symbol_observable]();\n        if (typeof obs.subscribe !== 'function') {\n            throw new TypeError('Provided object does not correctly implement Symbol.observable');\n        }\n        else {\n            return obs.subscribe(subscriber);\n        }\n    };\n};\n//# sourceMappingURL=subscribeToObservable.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport var isArrayLike = (function (x) { return x && typeof x.length === 'number' && typeof x !== 'function'; });\n//# sourceMappingURL=isArrayLike.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function isPromise(value) {\n    return !!value && typeof value.subscribe !== 'function' && typeof value.then === 'function';\n}\n//# sourceMappingURL=isPromise.js.map\n","/** PURE_IMPORTS_START _hostReportError PURE_IMPORTS_END */\nimport { hostReportError } from './hostReportError';\nexport var subscribeToPromise = function (promise) {\n    return function (subscriber) {\n        promise.then(function (value) {\n            if (!subscriber.closed) {\n                subscriber.next(value);\n                subscriber.complete();\n            }\n        }, function (err) { return subscriber.error(err); })\n            .then(null, hostReportError);\n        return subscriber;\n    };\n};\n//# sourceMappingURL=subscribeToPromise.js.map\n","/** PURE_IMPORTS_START _symbol_iterator PURE_IMPORTS_END */\nimport { iterator as Symbol_iterator } from '../symbol/iterator';\nexport var subscribeToIterable = function (iterable) {\n    return function (subscriber) {\n        var iterator = iterable[Symbol_iterator]();\n        do {\n            var item = iterator.next();\n            if (item.done) {\n                subscriber.complete();\n                break;\n            }\n            subscriber.next(item.value);\n            if (subscriber.closed) {\n                break;\n            }\n        } while (true);\n        if (typeof iterator.return === 'function') {\n            subscriber.add(function () {\n                if (iterator.return) {\n                    iterator.return();\n                }\n            });\n        }\n        return subscriber;\n    };\n};\n//# sourceMappingURL=subscribeToIterable.js.map\n","/** PURE_IMPORTS_START _InnerSubscriber,_subscribeTo,_Observable PURE_IMPORTS_END */\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeTo } from './subscribeTo';\nimport { Observable } from '../Observable';\nexport function subscribeToResult(outerSubscriber, result, outerValue, outerIndex, destination) {\n    if (destination === void 0) {\n        destination = new InnerSubscriber(outerSubscriber, outerValue, outerIndex);\n    }\n    if (destination.closed) {\n        return undefined;\n    }\n    if (result instanceof Observable) {\n        return result.subscribe(destination);\n    }\n    return subscribeTo(result)(destination);\n}\n//# sourceMappingURL=subscribeToResult.js.map\n","/** PURE_IMPORTS_START _Observable,_util_subscribeToArray,_scheduled_scheduleArray PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { subscribeToArray } from '../util/subscribeToArray';\nimport { scheduleArray } from '../scheduled/scheduleArray';\nexport function fromArray(input, scheduler) {\n    if (!scheduler) {\n        return new Observable(subscribeToArray(input));\n    }\n    else {\n        return scheduleArray(input, scheduler);\n    }\n}\n//# sourceMappingURL=fromArray.js.map\n","/** PURE_IMPORTS_START _Observable,_Subscription PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { Subscription } from '../Subscription';\nexport function scheduleArray(input, scheduler) {\n    return new Observable(function (subscriber) {\n        var sub = new Subscription();\n        var i = 0;\n        sub.add(scheduler.schedule(function () {\n            if (i === input.length) {\n                subscriber.complete();\n                return;\n            }\n            subscriber.next(input[i++]);\n            if (!subscriber.closed) {\n                sub.add(this.schedule());\n            }\n        }));\n        return sub;\n    });\n}\n//# sourceMappingURL=scheduleArray.js.map\n","/** PURE_IMPORTS_START tslib,_util_isScheduler,_util_isArray,_OuterSubscriber,_util_subscribeToResult,_fromArray PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { isScheduler } from '../util/isScheduler';\nimport { isArray } from '../util/isArray';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { fromArray } from './fromArray';\nvar NONE = {};\nexport function combineLatest() {\n    var observables = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        observables[_i] = arguments[_i];\n    }\n    var resultSelector = null;\n    var scheduler = null;\n    if (isScheduler(observables[observables.length - 1])) {\n        scheduler = observables.pop();\n    }\n    if (typeof observables[observables.length - 1] === 'function') {\n        resultSelector = observables.pop();\n    }\n    if (observables.length === 1 && isArray(observables[0])) {\n        observables = observables[0];\n    }\n    return fromArray(observables, scheduler).lift(new CombineLatestOperator(resultSelector));\n}\nvar CombineLatestOperator = /*@__PURE__*/ (function () {\n    function CombineLatestOperator(resultSelector) {\n        this.resultSelector = resultSelector;\n    }\n    CombineLatestOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new CombineLatestSubscriber(subscriber, this.resultSelector));\n    };\n    return CombineLatestOperator;\n}());\nexport { CombineLatestOperator };\nvar CombineLatestSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(CombineLatestSubscriber, _super);\n    function CombineLatestSubscriber(destination, resultSelector) {\n        var _this = _super.call(this, destination) || this;\n        _this.resultSelector = resultSelector;\n        _this.active = 0;\n        _this.values = [];\n        _this.observables = [];\n        return _this;\n    }\n    CombineLatestSubscriber.prototype._next = function (observable) {\n        this.values.push(NONE);\n        this.observables.push(observable);\n    };\n    CombineLatestSubscriber.prototype._complete = function () {\n        var observables = this.observables;\n        var len = observables.length;\n        if (len === 0) {\n            this.destination.complete();\n        }\n        else {\n            this.active = len;\n            this.toRespond = len;\n            for (var i = 0; i < len; i++) {\n                var observable = observables[i];\n                this.add(subscribeToResult(this, observable, observable, i));\n            }\n        }\n    };\n    CombineLatestSubscriber.prototype.notifyComplete = function (unused) {\n        if ((this.active -= 1) === 0) {\n            this.destination.complete();\n        }\n    };\n    CombineLatestSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        var values = this.values;\n        var oldVal = values[outerIndex];\n        var toRespond = !this.toRespond\n            ? 0\n            : oldVal === NONE ? --this.toRespond : this.toRespond;\n        values[outerIndex] = innerValue;\n        if (toRespond === 0) {\n            if (this.resultSelector) {\n                this._tryResultSelector(values);\n            }\n            else {\n                this.destination.next(values.slice());\n            }\n        }\n    };\n    CombineLatestSubscriber.prototype._tryResultSelector = function (values) {\n        var result;\n        try {\n            result = this.resultSelector.apply(this, values);\n        }\n        catch (err) {\n            this.destination.error(err);\n            return;\n        }\n        this.destination.next(result);\n    };\n    return CombineLatestSubscriber;\n}(OuterSubscriber));\nexport { CombineLatestSubscriber };\n//# sourceMappingURL=combineLatest.js.map\n","/** PURE_IMPORTS_START tslib,_Action PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Action } from './Action';\nvar AsyncAction = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(AsyncAction, _super);\n    function AsyncAction(scheduler, work) {\n        var _this = _super.call(this, scheduler, work) || this;\n        _this.scheduler = scheduler;\n        _this.work = work;\n        _this.pending = false;\n        return _this;\n    }\n    AsyncAction.prototype.schedule = function (state, delay) {\n        if (delay === void 0) {\n            delay = 0;\n        }\n        if (this.closed) {\n            return this;\n        }\n        this.state = state;\n        var id = this.id;\n        var scheduler = this.scheduler;\n        if (id != null) {\n            this.id = this.recycleAsyncId(scheduler, id, delay);\n        }\n        this.pending = true;\n        this.delay = delay;\n        this.id = this.id || this.requestAsyncId(scheduler, this.id, delay);\n        return this;\n    };\n    AsyncAction.prototype.requestAsyncId = function (scheduler, id, delay) {\n        if (delay === void 0) {\n            delay = 0;\n        }\n        return setInterval(scheduler.flush.bind(scheduler, this), delay);\n    };\n    AsyncAction.prototype.recycleAsyncId = function (scheduler, id, delay) {\n        if (delay === void 0) {\n            delay = 0;\n        }\n        if (delay !== null && this.delay === delay && this.pending === false) {\n            return id;\n        }\n        clearInterval(id);\n        return undefined;\n    };\n    AsyncAction.prototype.execute = function (state, delay) {\n        if (this.closed) {\n            return new Error('executing a cancelled action');\n        }\n        this.pending = false;\n        var error = this._execute(state, delay);\n        if (error) {\n            return error;\n        }\n        else if (this.pending === false && this.id != null) {\n            this.id = this.recycleAsyncId(this.scheduler, this.id, null);\n        }\n    };\n    AsyncAction.prototype._execute = function (state, delay) {\n        var errored = false;\n        var errorValue = undefined;\n        try {\n            this.work(state);\n        }\n        catch (e) {\n            errored = true;\n            errorValue = !!e && e || new Error(e);\n        }\n        if (errored) {\n            this.unsubscribe();\n            return errorValue;\n        }\n    };\n    AsyncAction.prototype._unsubscribe = function () {\n        var id = this.id;\n        var scheduler = this.scheduler;\n        var actions = scheduler.actions;\n        var index = actions.indexOf(this);\n        this.work = null;\n        this.state = null;\n        this.pending = false;\n        this.scheduler = null;\n        if (index !== -1) {\n            actions.splice(index, 1);\n        }\n        if (id != null) {\n            this.id = this.recycleAsyncId(scheduler, id, null);\n        }\n        this.delay = null;\n    };\n    return AsyncAction;\n}(Action));\nexport { AsyncAction };\n//# sourceMappingURL=AsyncAction.js.map\n","/** PURE_IMPORTS_START tslib,_Subscription PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscription } from '../Subscription';\nvar Action = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(Action, _super);\n    function Action(scheduler, work) {\n        return _super.call(this) || this;\n    }\n    Action.prototype.schedule = function (state, delay) {\n        if (delay === void 0) {\n            delay = 0;\n        }\n        return this;\n    };\n    return Action;\n}(Subscription));\nexport { Action };\n//# sourceMappingURL=Action.js.map\n","var Scheduler = /*@__PURE__*/ (function () {\n    function Scheduler(SchedulerAction, now) {\n        if (now === void 0) {\n            now = Scheduler.now;\n        }\n        this.SchedulerAction = SchedulerAction;\n        this.now = now;\n    }\n    Scheduler.prototype.schedule = function (work, delay, state) {\n        if (delay === void 0) {\n            delay = 0;\n        }\n        return new this.SchedulerAction(this, work).schedule(state, delay);\n    };\n    Scheduler.now = function () { return Date.now(); };\n    return Scheduler;\n}());\nexport { Scheduler };\n//# sourceMappingURL=Scheduler.js.map\n","/** PURE_IMPORTS_START _AsyncAction,_AsyncScheduler PURE_IMPORTS_END */\nimport { AsyncAction } from './AsyncAction';\nimport { AsyncScheduler } from './AsyncScheduler';\nexport var async = /*@__PURE__*/ new AsyncScheduler(AsyncAction);\n//# sourceMappingURL=async.js.map\n","/** PURE_IMPORTS_START tslib,_Scheduler PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Scheduler } from '../Scheduler';\nvar AsyncScheduler = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(AsyncScheduler, _super);\n    function AsyncScheduler(SchedulerAction, now) {\n        if (now === void 0) {\n            now = Scheduler.now;\n        }\n        var _this = _super.call(this, SchedulerAction, function () {\n            if (AsyncScheduler.delegate && AsyncScheduler.delegate !== _this) {\n                return AsyncScheduler.delegate.now();\n            }\n            else {\n                return now();\n            }\n        }) || this;\n        _this.actions = [];\n        _this.active = false;\n        _this.scheduled = undefined;\n        return _this;\n    }\n    AsyncScheduler.prototype.schedule = function (work, delay, state) {\n        if (delay === void 0) {\n            delay = 0;\n        }\n        if (AsyncScheduler.delegate && AsyncScheduler.delegate !== this) {\n            return AsyncScheduler.delegate.schedule(work, delay, state);\n        }\n        else {\n            return _super.prototype.schedule.call(this, work, delay, state);\n        }\n    };\n    AsyncScheduler.prototype.flush = function (action) {\n        var actions = this.actions;\n        if (this.active) {\n            actions.push(action);\n            return;\n        }\n        var error;\n        this.active = true;\n        do {\n            if (error = action.execute(action.state, action.delay)) {\n                break;\n            }\n        } while (action = actions.shift());\n        this.active = false;\n        if (error) {\n            while (action = actions.shift()) {\n                action.unsubscribe();\n            }\n            throw error;\n        }\n    };\n    return AsyncScheduler;\n}(Scheduler));\nexport { AsyncScheduler };\n//# sourceMappingURL=AsyncScheduler.js.map\n","/** PURE_IMPORTS_START _Observable,_scheduler_async,_util_isNumeric PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { async } from '../scheduler/async';\nimport { isNumeric } from '../util/isNumeric';\nexport function interval(period, scheduler) {\n    if (period === void 0) {\n        period = 0;\n    }\n    if (scheduler === void 0) {\n        scheduler = async;\n    }\n    if (!isNumeric(period) || period < 0) {\n        period = 0;\n    }\n    if (!scheduler || typeof scheduler.schedule !== 'function') {\n        scheduler = async;\n    }\n    return new Observable(function (subscriber) {\n        subscriber.add(scheduler.schedule(dispatch, period, { subscriber: subscriber, counter: 0, period: period }));\n        return subscriber;\n    });\n}\nfunction dispatch(state) {\n    var subscriber = state.subscriber, counter = state.counter, period = state.period;\n    subscriber.next(counter);\n    this.schedule({ subscriber: subscriber, counter: counter + 1, period: period }, period);\n}\n//# sourceMappingURL=interval.js.map\n","// TODO make these inputs :D\nexport const fps = 60;\nexport const dataSampleRate = fps / 1000;\nexport const audioSampleRate = 2 * dataSampleRate;\nexport const fftSize = 1024;\nexport const psdSize = Math.floor(fftSize / 2) + 1;\n","import { parse } from './grammar.pegjs';\nimport { PipeNode, Scalar } from './ast';\n\nexport class Parser {\n  static parsePipe = (pipe: string): PipeNode => parse(pipe);\n\n  static parseScalar = (expr: string): Scalar =>\n    parse(expr, { startRule: 'scalar' });\n}\n","import { Defs, Scope } from './types';\nimport { Parser } from './parser';\nimport {\n  PipeNode,\n  ArithNode,\n  Scalar,\n  StepNode,\n  FnNode,\n  IdNode,\n  AccessNode,\n} from './ast';\nimport { Resolver } from './resolver';\nimport Interval from '../fn/interval';\n\nexport class Compiler {\n  private readonly simplifier: Simplifier;\n\n  constructor(defs: Defs) {\n    this.simplifier = new Simplifier({\n      theta: Parser.parseScalar(defs.theta),\n    });\n  }\n\n  compile(expr: string): PipeNode;\n  compile(expr: string, startRule: 'scalar'): Scalar;\n  compile(expr: string, startRule?: string): any {\n    switch (startRule) {\n      default:\n        return this.compilePipe(expr);\n      case 'scalar':\n        return this.compileScalar(expr);\n    }\n  }\n\n  private compilePipe = (expr: string): PipeNode => {\n    const ast = this.simplifier.simplify(Parser.parsePipe(expr));\n    // Due to the way that sampling is implemented, the actual\n    // number of points generated will not be exactly the n specified\n    // by the user, unless n happens to be the dth power of some number.\n    // The below expression computes the exact number of points that will\n    // be generated.\n    ast.n = Interval.nPerLevel(ast.d0, ast.n) ** ast.d0;\n    return ast;\n  };\n\n  private compileScalar = (expr: string): Scalar => {\n    const ast = Parser.parseScalar(expr);\n    return this.simplifier.simplifyScalar(ast);\n  };\n}\n\ntype Substitutions = {\n  [id: string]: Scalar;\n};\n\nclass Simplifier {\n  constructor(private readonly substitutions: Substitutions) {}\n\n  simplify = (pipe: PipeNode): PipeNode => {\n    const { n, d0, steps } = pipe;\n\n    return {\n      kind: pipe.kind,\n      n,\n      d0,\n      steps: steps.map(this.simplifyStepNode),\n    };\n  };\n\n  simplifyScalar = (node: Scalar): Scalar => {\n    switch (node.kind) {\n      case 'number':\n        return node;\n      case 'fn':\n        return this.simplifyFnNode(node);\n      case 'access':\n        return this.simplifyAccessNode(node);\n      case 'id':\n        return this.simplifyIdNode(node);\n      case 'arith':\n        return this.simplifyArithNode(node);\n    }\n  };\n\n  private simplifyStepNode = ({ kind, type: fn, args }: StepNode): StepNode => {\n    return {\n      kind,\n      type: fn,\n      args: args.map(this.simplifyScalar),\n    };\n  };\n\n  private simplifyArithNode = ({\n    kind,\n    op,\n    operands,\n  }: ArithNode): ArithNode => {\n    const [a, b] = operands.map(this.simplifyScalar);\n    return { kind, op, operands: [a, b] };\n  };\n\n  private simplifyFnNode = ({ kind, name, args }: FnNode): FnNode => {\n    return {\n      kind,\n      name,\n      args: args.map(this.simplifyIdNode),\n    };\n  };\n\n  private simplifyAccessNode = ({\n    kind,\n    id,\n    index,\n  }: AccessNode): AccessNode => {\n    return { kind, id, index: this.simplifyScalar(index) };\n  };\n\n  private simplifyIdNode = (node: IdNode): Scalar => {\n    const { id } = node;\n    if (id in this.substitutions) {\n      return this.simplifyScalar(this.substitutions[id]);\n    } else {\n      return node;\n    }\n  };\n}\n","import { audioStream } from './audio';\nimport { Params, Scope } from '../core/pipe/types';\nimport { interval, BehaviorSubject, combineLatest, Subject } from 'rxjs';\nimport { inputs } from './inputs';\nimport { fps } from './constants';\nimport { Audio } from './audio/types';\nimport { error } from './error';\nimport { AUDIO_PLACEHOLDER } from './audio/constants';\nimport { Compiler } from '../core/pipe/compiler';\nimport { inf } from '../core/constants';\n\nconst params = (t: number, audio: Audio) => {\n  const compiler = new Compiler({ theta: inputs.theta.value });\n  const pipe = compiler.compile(inputs.pipe.value);\n  const scope: Scope = { t, inf, n: pipe.n, ...audio };\n  return {\n    pipe,\n    scope,\n    hv: {\n      h: compiler.compile(`360 * (${inputs.h.value})`, 'scalar'),\n      v: compiler.compile(`100 * (${inputs.v.value})`, 'scalar'),\n    },\n  };\n};\n\nconst emit = (t: number, audio: Audio) => {\n  try {\n    subject.next(params(t, audio));\n  } catch (err) {\n    error(err);\n  }\n};\n\nconst subject = new Subject<Params>();\nemit(0, AUDIO_PLACEHOLDER);\nexport const paramsStream = subject.asObservable();\nlet count = 0;\n\nconst maybeEmit = ([audio]: [Audio, number]) => {\n  if (inputs.animate.value) {\n    emit(count++ / fps, audio);\n  }\n};\n\ncombineLatest(audioStream, interval(1000 / fps)).subscribe(maybeEmit, error);\n","/** PURE_IMPORTS_START _isArray PURE_IMPORTS_END */\nimport { isArray } from './isArray';\nexport function isNumeric(val) {\n    return !isArray(val) && (val - parseFloat(val) + 1) >= 0;\n}\n//# sourceMappingURL=isNumeric.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function isScheduler(value) {\n    return value && typeof value.schedule === 'function';\n}\n//# sourceMappingURL=isScheduler.js.map\n","import { Observable, timer, Subject, interval, EMPTY } from 'rxjs';\nimport { retryWhen, delayWhen, repeatWhen, tap } from 'rxjs/operators';\nimport { Data } from '../core/data';\nimport { Params } from '../core/pipe/types';\nimport { startPool, runPipeline } from '../core/pipe/pool';\nimport * as params from './params';\nimport { getLogger } from 'loglevel';\nimport { pp } from '../core/pp';\nimport { error } from './error';\nimport debug from './debug';\n\nconst logger = getLogger('Data');\nlogger.setDefaultLevel('info');\nconst subject = new Subject<Data>();\n\nexport const dataStream = subject.asObservable();\n\ntype Source = {\n  getData(params: Params): Promise<Data>;\n};\n\nconst webWorkerSource = async (): Promise<Source> => {\n  console.info('starting web worker data source');\n  await startPool();\n\n  const getData = (params: Params) => runPipeline(params).then(Data.fromBuffer);\n\n  return { getData };\n};\n\n(async () => {\n  const { getData } = await webWorkerSource();\n  let inFlight: Promise<Data> | null;\n  let logged = 0;\n\n  params.paramsStream.subscribe(\n    async params => {\n      if (inFlight) return;\n      debug('params', params);\n      logger.debug('requesting data with params', params);\n      if (Date.now() - logged >= 1000) {\n        logger.debug(`sending request for data with params ${pp(params)}`);\n        logged = Date.now();\n      }\n      // TODO i feel like there's a more rx-y way to do this\n      inFlight = getData(params);\n      try {\n        subject.next(await inFlight);\n      } catch (err) {\n        error(err);\n      } finally {\n        inFlight = null;\n      }\n    },\n    err => error(err),\n  );\n})();\n","module.exports = __webpack_public_path__ + \"ee535caaa9d379b9b466.worklet.js\";","/*\n * Generated by PEG.js 0.10.0.\n *\n * http://pegjs.org/\n */\n\n\"use strict\";\n\nfunction peg$subclass(child, parent) {\n  function ctor() { this.constructor = child; }\n  ctor.prototype = parent.prototype;\n  child.prototype = new ctor();\n}\n\nfunction peg$SyntaxError(message, expected, found, location) {\n  this.message  = message;\n  this.expected = expected;\n  this.found    = found;\n  this.location = location;\n  this.name     = \"SyntaxError\";\n\n  if (typeof Error.captureStackTrace === \"function\") {\n    Error.captureStackTrace(this, peg$SyntaxError);\n  }\n}\n\npeg$subclass(peg$SyntaxError, Error);\n\npeg$SyntaxError.buildMessage = function(expected, found) {\n  var DESCRIBE_EXPECTATION_FNS = {\n        literal: function(expectation) {\n          return \"\\\"\" + literalEscape(expectation.text) + \"\\\"\";\n        },\n\n        \"class\": function(expectation) {\n          var escapedParts = \"\",\n              i;\n\n          for (i = 0; i < expectation.parts.length; i++) {\n            escapedParts += expectation.parts[i] instanceof Array\n              ? classEscape(expectation.parts[i][0]) + \"-\" + classEscape(expectation.parts[i][1])\n              : classEscape(expectation.parts[i]);\n          }\n\n          return \"[\" + (expectation.inverted ? \"^\" : \"\") + escapedParts + \"]\";\n        },\n\n        any: function(expectation) {\n          return \"any character\";\n        },\n\n        end: function(expectation) {\n          return \"end of input\";\n        },\n\n        other: function(expectation) {\n          return expectation.description;\n        }\n      };\n\n  function hex(ch) {\n    return ch.charCodeAt(0).toString(16).toUpperCase();\n  }\n\n  function literalEscape(s) {\n    return s\n      .replace(/\\\\/g, '\\\\\\\\')\n      .replace(/\"/g,  '\\\\\"')\n      .replace(/\\0/g, '\\\\0')\n      .replace(/\\t/g, '\\\\t')\n      .replace(/\\n/g, '\\\\n')\n      .replace(/\\r/g, '\\\\r')\n      .replace(/[\\x00-\\x0F]/g,          function(ch) { return '\\\\x0' + hex(ch); })\n      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return '\\\\x'  + hex(ch); });\n  }\n\n  function classEscape(s) {\n    return s\n      .replace(/\\\\/g, '\\\\\\\\')\n      .replace(/\\]/g, '\\\\]')\n      .replace(/\\^/g, '\\\\^')\n      .replace(/-/g,  '\\\\-')\n      .replace(/\\0/g, '\\\\0')\n      .replace(/\\t/g, '\\\\t')\n      .replace(/\\n/g, '\\\\n')\n      .replace(/\\r/g, '\\\\r')\n      .replace(/[\\x00-\\x0F]/g,          function(ch) { return '\\\\x0' + hex(ch); })\n      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return '\\\\x'  + hex(ch); });\n  }\n\n  function describeExpectation(expectation) {\n    return DESCRIBE_EXPECTATION_FNS[expectation.type](expectation);\n  }\n\n  function describeExpected(expected) {\n    var descriptions = new Array(expected.length),\n        i, j;\n\n    for (i = 0; i < expected.length; i++) {\n      descriptions[i] = describeExpectation(expected[i]);\n    }\n\n    descriptions.sort();\n\n    if (descriptions.length > 0) {\n      for (i = 1, j = 1; i < descriptions.length; i++) {\n        if (descriptions[i - 1] !== descriptions[i]) {\n          descriptions[j] = descriptions[i];\n          j++;\n        }\n      }\n      descriptions.length = j;\n    }\n\n    switch (descriptions.length) {\n      case 1:\n        return descriptions[0];\n\n      case 2:\n        return descriptions[0] + \" or \" + descriptions[1];\n\n      default:\n        return descriptions.slice(0, -1).join(\", \")\n          + \", or \"\n          + descriptions[descriptions.length - 1];\n    }\n  }\n\n  function describeFound(found) {\n    return found ? \"\\\"\" + literalEscape(found) + \"\\\"\" : \"end of input\";\n  }\n\n  return \"Expected \" + describeExpected(expected) + \" but \" + describeFound(found) + \" found.\";\n};\n\nfunction peg$parse(input, options) {\n  options = options !== void 0 ? options : {};\n\n  var peg$FAILED = {},\n\n      peg$startRuleFunctions = { pipe: peg$parsepipe, scalar: peg$parsescalar },\n      peg$startRuleFunction  = peg$parsepipe,\n\n      peg$c0 = function(n, d0, steps) {\n        return {kind: 'pipe', n, d0, steps};\n      },\n      peg$c1 = peg$otherExpectation(\"positive integer\"),\n      peg$c2 = function(x) {\n        x = parseInt(x);\n        if (x <= 0) {\n          expected(`a positive integer`);\n        }\n        return x;\n      },\n      peg$c3 = function(head, tail) { return [head, ...tail]; },\n      peg$c4 = function(step) { return [step]; },\n      peg$c5 = peg$otherExpectation(\"cube\"),\n      peg$c6 = \"cube\",\n      peg$c7 = peg$literalExpectation(\"cube\", true),\n      peg$c8 = function(type, length) {\n          return {kind: 'step', type, args: [length]};\n        },\n      peg$c9 = peg$otherExpectation(\"sphere\"),\n      peg$c10 = \"sphere\",\n      peg$c11 = peg$literalExpectation(\"sphere\", true),\n      peg$c12 = function(type, r) {\n          return {kind: 'step', type, args: [r]};\n        },\n      peg$c13 = peg$otherExpectation(\"spiral\"),\n      peg$c14 = \"spiral\",\n      peg$c15 = peg$literalExpectation(\"spiral\", true),\n      peg$c16 = function(type, a, k) {\n          return {kind: 'step', type, args: [a, k]};\n        },\n      peg$c17 = peg$otherExpectation(\"torus\"),\n      peg$c18 = \"torus\",\n      peg$c19 = peg$literalExpectation(\"torus\", true),\n      peg$c20 = function(type, r, t) {\n          return {kind: 'step', type, args: [r, t]};\n        },\n      peg$c21 = peg$otherExpectation(\"fucked_up_torus\"),\n      peg$c22 = \"fucked_up_torus\",\n      peg$c23 = peg$literalExpectation(\"fucked_up_torus\", true),\n      peg$c24 = peg$otherExpectation(\"rotate\"),\n      peg$c25 = \"r\",\n      peg$c26 = peg$literalExpectation(\"r\", true),\n      peg$c27 = \"rotate\",\n      peg$c28 = peg$literalExpectation(\"rotate\", true),\n      peg$c29 = function(theta, d0, d1, id) { return id},\n      peg$c30 = function(theta, d0, d1, f0, id) { return id},\n      peg$c31 = function(theta, d0, d1, f0, f1) {\n          const args = [theta, d0, d1];\n          if (f0) args.push(f0);\n          if (f1) args.push(f1);\n          return {kind: 'step', type: 'rotate', args};\n        },\n      peg$c32 = peg$otherExpectation(\"stereo\"),\n      peg$c33 = \"stereo\",\n      peg$c34 = peg$literalExpectation(\"stereo\", true),\n      peg$c35 = function(type, to) {\n          return {kind: 'step', type, args: [to]};\n        },\n      peg$c36 = function(arg) { return [arg]; },\n      peg$c37 = peg$otherExpectation(\"scalar\"),\n      peg$c38 = function(s, op, a) {\n           return {kind: 'arith', op, operands: [s, a]};\n        },\n      peg$c39 = peg$otherExpectation(\"term\"),\n      peg$c40 = function(value) { return {kind: 'number', value}; },\n      peg$c41 = function(name, args) {\n          return {kind: 'fn', name: name.toLowerCase(), args};\n        },\n      peg$c42 = function(id, index) { return {kind: 'access', id, index}; },\n      peg$c43 = function(a) { return a; },\n      peg$c44 = function(id) { return {kind: 'id', id: id.toLowerCase()}; },\n      peg$c45 = peg$otherExpectation(\"number\"),\n      peg$c46 = function(f) { return parseFloat(f); },\n      peg$c47 = function(i) { return parseInt(i); },\n      peg$c48 = peg$otherExpectation(\"identifier\"),\n      peg$c49 = /^[a-zA-Z]/,\n      peg$c50 = peg$classExpectation([[\"a\", \"z\"], [\"A\", \"Z\"]], false, false),\n      peg$c51 = /^[a-zA-Z0-9]/,\n      peg$c52 = peg$classExpectation([[\"a\", \"z\"], [\"A\", \"Z\"], [\"0\", \"9\"]], false, false),\n      peg$c53 = function(id) { return id; },\n      peg$c54 = peg$otherExpectation(\"float\"),\n      peg$c55 = /^[+\\-]/,\n      peg$c56 = peg$classExpectation([\"+\", \"-\"], false, false),\n      peg$c57 = /^[0-9]/,\n      peg$c58 = peg$classExpectation([[\"0\", \"9\"]], false, false),\n      peg$c59 = /^[eE]/,\n      peg$c60 = peg$classExpectation([\"e\", \"E\"], false, false),\n      peg$c61 = peg$otherExpectation(\"integer\"),\n      peg$c62 = peg$otherExpectation(\"unsigned integer\"),\n      peg$c63 = \".\",\n      peg$c64 = peg$literalExpectation(\".\", false),\n      peg$c65 = peg$otherExpectation(\"arithmetic operator\"),\n      peg$c66 = \"+\",\n      peg$c67 = peg$literalExpectation(\"+\", false),\n      peg$c68 = \"-\",\n      peg$c69 = peg$literalExpectation(\"-\", false),\n      peg$c70 = \"*\",\n      peg$c71 = peg$literalExpectation(\"*\", false),\n      peg$c72 = \"/\",\n      peg$c73 = peg$literalExpectation(\"/\", false),\n      peg$c74 = \"**\",\n      peg$c75 = peg$literalExpectation(\"**\", false),\n      peg$c76 = \"^\",\n      peg$c77 = peg$literalExpectation(\"^\", false),\n      peg$c78 = function(op) { return op; },\n      peg$c79 = peg$otherExpectation(\"lparen\"),\n      peg$c80 = \"(\",\n      peg$c81 = peg$literalExpectation(\"(\", false),\n      peg$c82 = peg$otherExpectation(\"rparen\"),\n      peg$c83 = \")\",\n      peg$c84 = peg$literalExpectation(\")\", false),\n      peg$c85 = peg$otherExpectation(\"lbrack\"),\n      peg$c86 = \"[\",\n      peg$c87 = peg$literalExpectation(\"[\", false),\n      peg$c88 = peg$otherExpectation(\"rbrack\"),\n      peg$c89 = \"]\",\n      peg$c90 = peg$literalExpectation(\"]\", false),\n      peg$c91 = peg$otherExpectation(\"comma\"),\n      peg$c92 = \",\",\n      peg$c93 = peg$literalExpectation(\",\", false),\n      peg$c94 = peg$otherExpectation(\"connector\"),\n      peg$c95 = \"->\",\n      peg$c96 = peg$literalExpectation(\"->\", false),\n      peg$c97 = \"=>\",\n      peg$c98 = peg$literalExpectation(\"=>\", false),\n      peg$c99 = peg$otherExpectation(\"whitespace\"),\n      peg$c100 = /^[ \\t\\n\\r]/,\n      peg$c101 = peg$classExpectation([\" \", \"\\t\", \"\\n\", \"\\r\"], false, false),\n\n      peg$currPos          = 0,\n      peg$savedPos         = 0,\n      peg$posDetailsCache  = [{ line: 1, column: 1 }],\n      peg$maxFailPos       = 0,\n      peg$maxFailExpected  = [],\n      peg$silentFails      = 0,\n\n      peg$result;\n\n  if (\"startRule\" in options) {\n    if (!(options.startRule in peg$startRuleFunctions)) {\n      throw new Error(\"Can't start parsing from rule \\\"\" + options.startRule + \"\\\".\");\n    }\n\n    peg$startRuleFunction = peg$startRuleFunctions[options.startRule];\n  }\n\n  function text() {\n    return input.substring(peg$savedPos, peg$currPos);\n  }\n\n  function location() {\n    return peg$computeLocation(peg$savedPos, peg$currPos);\n  }\n\n  function expected(description, location) {\n    location = location !== void 0 ? location : peg$computeLocation(peg$savedPos, peg$currPos)\n\n    throw peg$buildStructuredError(\n      [peg$otherExpectation(description)],\n      input.substring(peg$savedPos, peg$currPos),\n      location\n    );\n  }\n\n  function error(message, location) {\n    location = location !== void 0 ? location : peg$computeLocation(peg$savedPos, peg$currPos)\n\n    throw peg$buildSimpleError(message, location);\n  }\n\n  function peg$literalExpectation(text, ignoreCase) {\n    return { type: \"literal\", text: text, ignoreCase: ignoreCase };\n  }\n\n  function peg$classExpectation(parts, inverted, ignoreCase) {\n    return { type: \"class\", parts: parts, inverted: inverted, ignoreCase: ignoreCase };\n  }\n\n  function peg$anyExpectation() {\n    return { type: \"any\" };\n  }\n\n  function peg$endExpectation() {\n    return { type: \"end\" };\n  }\n\n  function peg$otherExpectation(description) {\n    return { type: \"other\", description: description };\n  }\n\n  function peg$computePosDetails(pos) {\n    var details = peg$posDetailsCache[pos], p;\n\n    if (details) {\n      return details;\n    } else {\n      p = pos - 1;\n      while (!peg$posDetailsCache[p]) {\n        p--;\n      }\n\n      details = peg$posDetailsCache[p];\n      details = {\n        line:   details.line,\n        column: details.column\n      };\n\n      while (p < pos) {\n        if (input.charCodeAt(p) === 10) {\n          details.line++;\n          details.column = 1;\n        } else {\n          details.column++;\n        }\n\n        p++;\n      }\n\n      peg$posDetailsCache[pos] = details;\n      return details;\n    }\n  }\n\n  function peg$computeLocation(startPos, endPos) {\n    var startPosDetails = peg$computePosDetails(startPos),\n        endPosDetails   = peg$computePosDetails(endPos);\n\n    return {\n      start: {\n        offset: startPos,\n        line:   startPosDetails.line,\n        column: startPosDetails.column\n      },\n      end: {\n        offset: endPos,\n        line:   endPosDetails.line,\n        column: endPosDetails.column\n      }\n    };\n  }\n\n  function peg$fail(expected) {\n    if (peg$currPos < peg$maxFailPos) { return; }\n\n    if (peg$currPos > peg$maxFailPos) {\n      peg$maxFailPos = peg$currPos;\n      peg$maxFailExpected = [];\n    }\n\n    peg$maxFailExpected.push(expected);\n  }\n\n  function peg$buildSimpleError(message, location) {\n    return new peg$SyntaxError(message, null, null, location);\n  }\n\n  function peg$buildStructuredError(expected, found, location) {\n    return new peg$SyntaxError(\n      peg$SyntaxError.buildMessage(expected, found),\n      expected,\n      found,\n      location\n    );\n  }\n\n  function peg$parsepipe() {\n    var s0, s1, s2, s3, s4, s5;\n\n    s0 = peg$currPos;\n    s1 = peg$parsepint();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseconnector();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parsepint();\n        if (s3 !== peg$FAILED) {\n          s4 = peg$parseconnector();\n          if (s4 !== peg$FAILED) {\n            s5 = peg$parsesteps();\n            if (s5 !== peg$FAILED) {\n              peg$savedPos = s0;\n              s1 = peg$c0(s1, s3, s5);\n              s0 = s1;\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parsepint() {\n    var s0, s1;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parseuint();\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c2(s1);\n    }\n    s0 = s1;\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c1); }\n    }\n\n    return s0;\n  }\n\n  function peg$parsesteps() {\n    var s0, s1, s2, s3;\n\n    s0 = peg$currPos;\n    s1 = peg$parsestep();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseconnector();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parsesteps();\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c3(s1, s3);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parsestep();\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c4(s1);\n      }\n      s0 = s1;\n    }\n\n    return s0;\n  }\n\n  function peg$parsestep() {\n    var s0;\n\n    s0 = peg$parsecube();\n    if (s0 === peg$FAILED) {\n      s0 = peg$parsesphere();\n      if (s0 === peg$FAILED) {\n        s0 = peg$parsespiral();\n        if (s0 === peg$FAILED) {\n          s0 = peg$parsetorus();\n          if (s0 === peg$FAILED) {\n            s0 = peg$parsefucked_up_torus();\n            if (s0 === peg$FAILED) {\n              s0 = peg$parserotate();\n              if (s0 === peg$FAILED) {\n                s0 = peg$parsestereo();\n              }\n            }\n          }\n        }\n      }\n    }\n\n    return s0;\n  }\n\n  function peg$parsecube() {\n    var s0, s1, s2, s3, s4;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$currPos;\n    if (input.substr(peg$currPos, 4).toLowerCase() === peg$c6) {\n      s2 = input.substr(peg$currPos, 4);\n      peg$currPos += 4;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c7); }\n    }\n    if (s2 !== peg$FAILED) {\n      s1 = input.substring(s1, peg$currPos);\n    } else {\n      s1 = s2;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parselparen();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parsescalar();\n        if (s3 !== peg$FAILED) {\n          s4 = peg$parserparen();\n          if (s4 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c8(s1, s3);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c5); }\n    }\n\n    return s0;\n  }\n\n  function peg$parsesphere() {\n    var s0, s1, s2, s3, s4;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$currPos;\n    if (input.substr(peg$currPos, 6).toLowerCase() === peg$c10) {\n      s2 = input.substr(peg$currPos, 6);\n      peg$currPos += 6;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c11); }\n    }\n    if (s2 !== peg$FAILED) {\n      s1 = input.substring(s1, peg$currPos);\n    } else {\n      s1 = s2;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parselparen();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parsescalar();\n        if (s3 !== peg$FAILED) {\n          s4 = peg$parserparen();\n          if (s4 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c12(s1, s3);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c9); }\n    }\n\n    return s0;\n  }\n\n  function peg$parsespiral() {\n    var s0, s1, s2, s3, s4, s5, s6;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$currPos;\n    if (input.substr(peg$currPos, 6).toLowerCase() === peg$c14) {\n      s2 = input.substr(peg$currPos, 6);\n      peg$currPos += 6;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c15); }\n    }\n    if (s2 !== peg$FAILED) {\n      s1 = input.substring(s1, peg$currPos);\n    } else {\n      s1 = s2;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parselparen();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parsescalar();\n        if (s3 !== peg$FAILED) {\n          s4 = peg$parsecomma();\n          if (s4 !== peg$FAILED) {\n            s5 = peg$parsescalar();\n            if (s5 !== peg$FAILED) {\n              s6 = peg$parserparen();\n              if (s6 !== peg$FAILED) {\n                peg$savedPos = s0;\n                s1 = peg$c16(s1, s3, s5);\n                s0 = s1;\n              } else {\n                peg$currPos = s0;\n                s0 = peg$FAILED;\n              }\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c13); }\n    }\n\n    return s0;\n  }\n\n  function peg$parsetorus() {\n    var s0, s1, s2, s3, s4, s5, s6;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$currPos;\n    if (input.substr(peg$currPos, 5).toLowerCase() === peg$c18) {\n      s2 = input.substr(peg$currPos, 5);\n      peg$currPos += 5;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c19); }\n    }\n    if (s2 !== peg$FAILED) {\n      s1 = input.substring(s1, peg$currPos);\n    } else {\n      s1 = s2;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parselparen();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parsescalar();\n        if (s3 !== peg$FAILED) {\n          s4 = peg$parsecomma();\n          if (s4 !== peg$FAILED) {\n            s5 = peg$parsescalar();\n            if (s5 !== peg$FAILED) {\n              s6 = peg$parserparen();\n              if (s6 !== peg$FAILED) {\n                peg$savedPos = s0;\n                s1 = peg$c20(s1, s3, s5);\n                s0 = s1;\n              } else {\n                peg$currPos = s0;\n                s0 = peg$FAILED;\n              }\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c17); }\n    }\n\n    return s0;\n  }\n\n  function peg$parsefucked_up_torus() {\n    var s0, s1, s2, s3, s4, s5, s6;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$currPos;\n    if (input.substr(peg$currPos, 15).toLowerCase() === peg$c22) {\n      s2 = input.substr(peg$currPos, 15);\n      peg$currPos += 15;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c23); }\n    }\n    if (s2 !== peg$FAILED) {\n      s1 = input.substring(s1, peg$currPos);\n    } else {\n      s1 = s2;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parselparen();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parsescalar();\n        if (s3 !== peg$FAILED) {\n          s4 = peg$parsecomma();\n          if (s4 !== peg$FAILED) {\n            s5 = peg$parsescalar();\n            if (s5 !== peg$FAILED) {\n              s6 = peg$parserparen();\n              if (s6 !== peg$FAILED) {\n                peg$savedPos = s0;\n                s1 = peg$c20(s1, s3, s5);\n                s0 = s1;\n              } else {\n                peg$currPos = s0;\n                s0 = peg$FAILED;\n              }\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c21); }\n    }\n\n    return s0;\n  }\n\n  function peg$parserotate() {\n    var s0, s1, s2, s3, s4, s5, s6, s7, s8, s9, s10, s11;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    if (input.substr(peg$currPos, 1).toLowerCase() === peg$c25) {\n      s1 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c26); }\n    }\n    if (s1 === peg$FAILED) {\n      if (input.substr(peg$currPos, 6).toLowerCase() === peg$c27) {\n        s1 = input.substr(peg$currPos, 6);\n        peg$currPos += 6;\n      } else {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c28); }\n      }\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parselparen();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parsescalar();\n        if (s3 !== peg$FAILED) {\n          s4 = peg$parsecomma();\n          if (s4 !== peg$FAILED) {\n            s5 = peg$parsescalar();\n            if (s5 !== peg$FAILED) {\n              s6 = peg$parsecomma();\n              if (s6 !== peg$FAILED) {\n                s7 = peg$parsescalar();\n                if (s7 !== peg$FAILED) {\n                  s8 = peg$currPos;\n                  s9 = peg$parsecomma();\n                  if (s9 !== peg$FAILED) {\n                    s10 = peg$parseid();\n                    if (s10 !== peg$FAILED) {\n                      peg$savedPos = s8;\n                      s9 = peg$c29(s3, s5, s7, s10);\n                      s8 = s9;\n                    } else {\n                      peg$currPos = s8;\n                      s8 = peg$FAILED;\n                    }\n                  } else {\n                    peg$currPos = s8;\n                    s8 = peg$FAILED;\n                  }\n                  if (s8 === peg$FAILED) {\n                    s8 = null;\n                  }\n                  if (s8 !== peg$FAILED) {\n                    s9 = peg$currPos;\n                    s10 = peg$parsecomma();\n                    if (s10 !== peg$FAILED) {\n                      s11 = peg$parseid();\n                      if (s11 !== peg$FAILED) {\n                        peg$savedPos = s9;\n                        s10 = peg$c30(s3, s5, s7, s8, s11);\n                        s9 = s10;\n                      } else {\n                        peg$currPos = s9;\n                        s9 = peg$FAILED;\n                      }\n                    } else {\n                      peg$currPos = s9;\n                      s9 = peg$FAILED;\n                    }\n                    if (s9 === peg$FAILED) {\n                      s9 = null;\n                    }\n                    if (s9 !== peg$FAILED) {\n                      s10 = peg$parserparen();\n                      if (s10 !== peg$FAILED) {\n                        peg$savedPos = s0;\n                        s1 = peg$c31(s3, s5, s7, s8, s9);\n                        s0 = s1;\n                      } else {\n                        peg$currPos = s0;\n                        s0 = peg$FAILED;\n                      }\n                    } else {\n                      peg$currPos = s0;\n                      s0 = peg$FAILED;\n                    }\n                  } else {\n                    peg$currPos = s0;\n                    s0 = peg$FAILED;\n                  }\n                } else {\n                  peg$currPos = s0;\n                  s0 = peg$FAILED;\n                }\n              } else {\n                peg$currPos = s0;\n                s0 = peg$FAILED;\n              }\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c24); }\n    }\n\n    return s0;\n  }\n\n  function peg$parsestereo() {\n    var s0, s1, s2, s3, s4;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$currPos;\n    if (input.substr(peg$currPos, 6).toLowerCase() === peg$c33) {\n      s2 = input.substr(peg$currPos, 6);\n      peg$currPos += 6;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c34); }\n    }\n    if (s2 !== peg$FAILED) {\n      s1 = input.substring(s1, peg$currPos);\n    } else {\n      s1 = s2;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parselparen();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parsescalar();\n        if (s3 !== peg$FAILED) {\n          s4 = peg$parserparen();\n          if (s4 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c35(s1, s3);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c32); }\n    }\n\n    return s0;\n  }\n\n  function peg$parsestep_args() {\n    var s0, s1, s2, s3;\n\n    s0 = peg$currPos;\n    s1 = peg$parsescalar();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parsecomma();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parsestep_args();\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c3(s1, s3);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parsescalar();\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c36(s1);\n      }\n      s0 = s1;\n    }\n\n    return s0;\n  }\n\n  function peg$parsescalar() {\n    var s0, s1, s2, s3;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parseterm();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseoperator();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parsescalar();\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c38(s1, s2, s3);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$parseterm();\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c37); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseterm() {\n    var s0, s1, s2, s3, s4;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parsenumber();\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c40(s1);\n    }\n    s0 = s1;\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parseidentifier();\n      if (s1 !== peg$FAILED) {\n        s2 = peg$parselparen();\n        if (s2 !== peg$FAILED) {\n          s3 = peg$parsefn_args();\n          if (s3 !== peg$FAILED) {\n            s4 = peg$parserparen();\n            if (s4 !== peg$FAILED) {\n              peg$savedPos = s0;\n              s1 = peg$c41(s1, s3);\n              s0 = s1;\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        s1 = peg$parseidentifier();\n        if (s1 !== peg$FAILED) {\n          s2 = peg$parselbrack();\n          if (s2 !== peg$FAILED) {\n            s3 = peg$parsescalar();\n            if (s3 !== peg$FAILED) {\n              s4 = peg$parserbrack();\n              if (s4 !== peg$FAILED) {\n                peg$savedPos = s0;\n                s1 = peg$c42(s1, s3);\n                s0 = s1;\n              } else {\n                peg$currPos = s0;\n                s0 = peg$FAILED;\n              }\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n        if (s0 === peg$FAILED) {\n          s0 = peg$parseid();\n          if (s0 === peg$FAILED) {\n            s0 = peg$currPos;\n            s1 = peg$parselparen();\n            if (s1 !== peg$FAILED) {\n              s2 = peg$parsescalar();\n              if (s2 !== peg$FAILED) {\n                s3 = peg$parserparen();\n                if (s3 !== peg$FAILED) {\n                  peg$savedPos = s0;\n                  s1 = peg$c43(s2);\n                  s0 = s1;\n                } else {\n                  peg$currPos = s0;\n                  s0 = peg$FAILED;\n                }\n              } else {\n                peg$currPos = s0;\n                s0 = peg$FAILED;\n              }\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          }\n        }\n      }\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c39); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseid() {\n    var s0, s1;\n\n    s0 = peg$currPos;\n    s1 = peg$parseidentifier();\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c44(s1);\n    }\n    s0 = s1;\n\n    return s0;\n  }\n\n  function peg$parsefn_args() {\n    var s0, s1, s2, s3;\n\n    s0 = peg$currPos;\n    s1 = peg$parsescalar();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parsecomma();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parsefn_args();\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c3(s1, s3);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parsescalar();\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c36(s1);\n      }\n      s0 = s1;\n    }\n\n    return s0;\n  }\n\n  function peg$parsenumber() {\n    var s0, s1, s2, s3;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parse_();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parsefloat();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parse_();\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c46(s2);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parse_();\n      if (s1 !== peg$FAILED) {\n        s2 = peg$parseint();\n        if (s2 !== peg$FAILED) {\n          s3 = peg$parse_();\n          if (s3 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c47(s2);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c45); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseidentifier() {\n    var s0, s1, s2, s3, s4, s5, s6;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parse_();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$currPos;\n      s3 = peg$currPos;\n      if (peg$c49.test(input.charAt(peg$currPos))) {\n        s4 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s4 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c50); }\n      }\n      if (s4 !== peg$FAILED) {\n        s5 = [];\n        if (peg$c51.test(input.charAt(peg$currPos))) {\n          s6 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s6 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c52); }\n        }\n        while (s6 !== peg$FAILED) {\n          s5.push(s6);\n          if (peg$c51.test(input.charAt(peg$currPos))) {\n            s6 = input.charAt(peg$currPos);\n            peg$currPos++;\n          } else {\n            s6 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c52); }\n          }\n        }\n        if (s5 !== peg$FAILED) {\n          s4 = [s4, s5];\n          s3 = s4;\n        } else {\n          peg$currPos = s3;\n          s3 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s3;\n        s3 = peg$FAILED;\n      }\n      if (s3 !== peg$FAILED) {\n        s2 = input.substring(s2, peg$currPos);\n      } else {\n        s2 = s3;\n      }\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parse_();\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c53(s2);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c48); }\n    }\n\n    return s0;\n  }\n\n  function peg$parsefloat() {\n    var s0, s1, s2, s3, s4, s5, s6;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$currPos;\n    if (peg$c55.test(input.charAt(peg$currPos))) {\n      s2 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c56); }\n    }\n    if (s2 === peg$FAILED) {\n      s2 = null;\n    }\n    if (s2 !== peg$FAILED) {\n      if (peg$c57.test(input.charAt(peg$currPos))) {\n        s3 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s3 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c58); }\n      }\n      if (s3 !== peg$FAILED) {\n        s4 = peg$parsemantissa();\n        if (s4 !== peg$FAILED) {\n          if (peg$c59.test(input.charAt(peg$currPos))) {\n            s5 = input.charAt(peg$currPos);\n            peg$currPos++;\n          } else {\n            s5 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c60); }\n          }\n          if (s5 !== peg$FAILED) {\n            s6 = peg$parseint();\n            if (s6 !== peg$FAILED) {\n              s2 = [s2, s3, s4, s5, s6];\n              s1 = s2;\n            } else {\n              peg$currPos = s1;\n              s1 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s1;\n            s1 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s1;\n          s1 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s1;\n        s1 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s1;\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s0 = input.substring(s0, peg$currPos);\n    } else {\n      s0 = s1;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$currPos;\n      s2 = peg$parseint();\n      if (s2 === peg$FAILED) {\n        s2 = null;\n      }\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parsemantissa();\n        if (s3 !== peg$FAILED) {\n          s2 = [s2, s3];\n          s1 = s2;\n        } else {\n          peg$currPos = s1;\n          s1 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s1;\n        s1 = peg$FAILED;\n      }\n      if (s1 !== peg$FAILED) {\n        s0 = input.substring(s0, peg$currPos);\n      } else {\n        s0 = s1;\n      }\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c54); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseint() {\n    var s0, s1, s2, s3;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$currPos;\n    if (peg$c55.test(input.charAt(peg$currPos))) {\n      s2 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c56); }\n    }\n    if (s2 === peg$FAILED) {\n      s2 = null;\n    }\n    if (s2 !== peg$FAILED) {\n      s3 = peg$parseuint();\n      if (s3 !== peg$FAILED) {\n        s2 = [s2, s3];\n        s1 = s2;\n      } else {\n        peg$currPos = s1;\n        s1 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s1;\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s0 = input.substring(s0, peg$currPos);\n    } else {\n      s0 = s1;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c61); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseuint() {\n    var s0, s1, s2;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = [];\n    if (peg$c57.test(input.charAt(peg$currPos))) {\n      s2 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c58); }\n    }\n    if (s2 !== peg$FAILED) {\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        if (peg$c57.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c58); }\n        }\n      }\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s0 = input.substring(s0, peg$currPos);\n    } else {\n      s0 = s1;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c62); }\n    }\n\n    return s0;\n  }\n\n  function peg$parsemantissa() {\n    var s0, s1, s2, s3;\n\n    s0 = peg$currPos;\n    s1 = peg$currPos;\n    if (input.charCodeAt(peg$currPos) === 46) {\n      s2 = peg$c63;\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c64); }\n    }\n    if (s2 !== peg$FAILED) {\n      s3 = peg$parseuint();\n      if (s3 !== peg$FAILED) {\n        s2 = [s2, s3];\n        s1 = s2;\n      } else {\n        peg$currPos = s1;\n        s1 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s1;\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s0 = input.substring(s0, peg$currPos);\n    } else {\n      s0 = s1;\n    }\n\n    return s0;\n  }\n\n  function peg$parseoperator() {\n    var s0, s1, s2, s3;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parse_();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$currPos;\n      if (input.charCodeAt(peg$currPos) === 43) {\n        s3 = peg$c66;\n        peg$currPos++;\n      } else {\n        s3 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c67); }\n      }\n      if (s3 === peg$FAILED) {\n        if (input.charCodeAt(peg$currPos) === 45) {\n          s3 = peg$c68;\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c69); }\n        }\n        if (s3 === peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 42) {\n            s3 = peg$c70;\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c71); }\n          }\n          if (s3 === peg$FAILED) {\n            if (input.charCodeAt(peg$currPos) === 47) {\n              s3 = peg$c72;\n              peg$currPos++;\n            } else {\n              s3 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c73); }\n            }\n            if (s3 === peg$FAILED) {\n              if (input.substr(peg$currPos, 2) === peg$c74) {\n                s3 = peg$c74;\n                peg$currPos += 2;\n              } else {\n                s3 = peg$FAILED;\n                if (peg$silentFails === 0) { peg$fail(peg$c75); }\n              }\n              if (s3 === peg$FAILED) {\n                if (input.charCodeAt(peg$currPos) === 94) {\n                  s3 = peg$c76;\n                  peg$currPos++;\n                } else {\n                  s3 = peg$FAILED;\n                  if (peg$silentFails === 0) { peg$fail(peg$c77); }\n                }\n              }\n            }\n          }\n        }\n      }\n      if (s3 !== peg$FAILED) {\n        s2 = input.substring(s2, peg$currPos);\n      } else {\n        s2 = s3;\n      }\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parse_();\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c78(s2);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c65); }\n    }\n\n    return s0;\n  }\n\n  function peg$parselparen() {\n    var s0, s1, s2, s3;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parse_();\n    if (s1 !== peg$FAILED) {\n      if (input.charCodeAt(peg$currPos) === 40) {\n        s2 = peg$c80;\n        peg$currPos++;\n      } else {\n        s2 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c81); }\n      }\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parse_();\n        if (s3 !== peg$FAILED) {\n          s1 = [s1, s2, s3];\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c79); }\n    }\n\n    return s0;\n  }\n\n  function peg$parserparen() {\n    var s0, s1, s2, s3;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parse_();\n    if (s1 !== peg$FAILED) {\n      if (input.charCodeAt(peg$currPos) === 41) {\n        s2 = peg$c83;\n        peg$currPos++;\n      } else {\n        s2 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c84); }\n      }\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parse_();\n        if (s3 !== peg$FAILED) {\n          s1 = [s1, s2, s3];\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c82); }\n    }\n\n    return s0;\n  }\n\n  function peg$parselbrack() {\n    var s0, s1, s2, s3;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parse_();\n    if (s1 !== peg$FAILED) {\n      if (input.charCodeAt(peg$currPos) === 91) {\n        s2 = peg$c86;\n        peg$currPos++;\n      } else {\n        s2 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c87); }\n      }\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parse_();\n        if (s3 !== peg$FAILED) {\n          s1 = [s1, s2, s3];\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c85); }\n    }\n\n    return s0;\n  }\n\n  function peg$parserbrack() {\n    var s0, s1, s2, s3;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parse_();\n    if (s1 !== peg$FAILED) {\n      if (input.charCodeAt(peg$currPos) === 93) {\n        s2 = peg$c89;\n        peg$currPos++;\n      } else {\n        s2 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c90); }\n      }\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parse_();\n        if (s3 !== peg$FAILED) {\n          s1 = [s1, s2, s3];\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c88); }\n    }\n\n    return s0;\n  }\n\n  function peg$parsecomma() {\n    var s0, s1, s2, s3;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parse_();\n    if (s1 !== peg$FAILED) {\n      if (input.charCodeAt(peg$currPos) === 44) {\n        s2 = peg$c92;\n        peg$currPos++;\n      } else {\n        s2 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c93); }\n      }\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parse_();\n        if (s3 !== peg$FAILED) {\n          s1 = [s1, s2, s3];\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c91); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseconnector() {\n    var s0, s1, s2, s3;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parse_();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$currPos;\n      if (input.substr(peg$currPos, 2) === peg$c95) {\n        s3 = peg$c95;\n        peg$currPos += 2;\n      } else {\n        s3 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c96); }\n      }\n      if (s3 === peg$FAILED) {\n        s3 = peg$parse__();\n        if (s3 === peg$FAILED) {\n          if (input.substr(peg$currPos, 2) === peg$c97) {\n            s3 = peg$c97;\n            peg$currPos += 2;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c98); }\n          }\n        }\n      }\n      if (s3 !== peg$FAILED) {\n        s2 = input.substring(s2, peg$currPos);\n      } else {\n        s2 = s3;\n      }\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parse_();\n        if (s3 !== peg$FAILED) {\n          s1 = [s1, s2, s3];\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c94); }\n    }\n\n    return s0;\n  }\n\n  function peg$parse_() {\n    var s0, s1;\n\n    peg$silentFails++;\n    s0 = [];\n    if (peg$c100.test(input.charAt(peg$currPos))) {\n      s1 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c101); }\n    }\n    while (s1 !== peg$FAILED) {\n      s0.push(s1);\n      if (peg$c100.test(input.charAt(peg$currPos))) {\n        s1 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c101); }\n      }\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c99); }\n    }\n\n    return s0;\n  }\n\n  function peg$parse__() {\n    var s0, s1, s2;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = [];\n    if (peg$c100.test(input.charAt(peg$currPos))) {\n      s2 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c101); }\n    }\n    if (s2 !== peg$FAILED) {\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        if (peg$c100.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c101); }\n        }\n      }\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s0 = input.substring(s0, peg$currPos);\n    } else {\n      s0 = s1;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c99); }\n    }\n\n    return s0;\n  }\n\n  peg$result = peg$startRuleFunction();\n\n  if (peg$result !== peg$FAILED && peg$currPos === input.length) {\n    return peg$result;\n  } else {\n    if (peg$result !== peg$FAILED && peg$currPos < input.length) {\n      peg$fail(peg$endExpectation());\n    }\n\n    throw peg$buildStructuredError(\n      peg$maxFailExpected,\n      peg$maxFailPos < input.length ? input.charAt(peg$maxFailPos) : null,\n      peg$maxFailPos < input.length\n        ? peg$computeLocation(peg$maxFailPos, peg$maxFailPos + 1)\n        : peg$computeLocation(peg$maxFailPos, peg$maxFailPos)\n    );\n  }\n}\n\nmodule.exports = {\n  SyntaxError: peg$SyntaxError,\n  parse:       peg$parse\n};\n"],"sourceRoot":""}