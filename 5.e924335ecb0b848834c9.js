(self.webpackJsonp=self.webpackJsonp||[]).push([[5],{11:function(e,t,n){"use strict";n.r(t);var r=n(8),i=n(73),o=n(33),s=n(34),u=n(24),a=n(2),c=e=>{e instanceof Error?r.error(e):r.error(Object(u.a)(e))},l=n(13);var f=n(28),h=n(14),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l.a(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(h.a),p=function(e){function t(t,n,r){var i=e.call(this)||this;return i.parent=t,i.outerValue=n,i.outerIndex=r,i.index=0,i}return l.a(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(h.a),v=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}},y=n(26);function b(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var m=b(),w=n(29);var g=n(44),x=function(e){if(e&&"function"==typeof e[w.a])return i=e,function(e){var t=i[w.a]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if((r=e)&&"number"==typeof r.length&&"function"!=typeof r)return v(e);if(function(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}(e))return n=e,function(e){return n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,y.a),e};if(e&&"function"==typeof e[m])return t=e,function(e){for(var n=t[m]();;){var r=n.next();if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add((function(){n.return&&n.return()})),e};var t,n,r,i,o=Object(g.a)(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+o+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")},O=n(15);function j(e,t,n,r,i){if(void 0===i&&(i=new p(e,n,r)),!i.closed)return t instanceof O.a?t.subscribe(i):x(t)(i)}var S=n(16);function k(e,t){return t?function(e,t){return new O.a((function(n){var r=new S.a,i=0;return r.add(t.schedule((function(){i!==e.length?(n.next(e[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}(e,t):new O.a(v(e))}var P={};var A=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new N(e,this.resultSelector))},e}(),N=function(e){function t(t,n){var r=e.call(this,t)||this;return r.resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return l.a(t,e),t.prototype._next=function(e){this.values.push(P),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var n=0;n<t;n++){var r=e[n];this.add(j(this,r,r,n))}}},t.prototype.notifyComplete=function(e){0==(this.active-=1)&&this.destination.complete()},t.prototype.notifyNext=function(e,t,n,r,i){var o=this.values,s=o[n],u=this.toRespond?s===P?--this.toRespond:this.toRespond:0;o[n]=t,0===u&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))},t.prototype._tryResultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(d),I=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return l.a(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(e){n=!0,r=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,n){return e.call(this)||this}return l.a(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(S.a)),D=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}(),M=new(function(e){function t(n,r){void 0===r&&(r=D.now);var i=e.call(this,n,(function(){return t.delegate&&t.delegate!==i?t.delegate.now():r()}))||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return l.a(t,e),t.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,r,i):e.prototype.schedule.call(this,n,r,i)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(D))(I);function _(e,t){var n;return void 0===e&&(e=0),void 0===t&&(t=M),n=e,(Object(f.a)(n)||!(n-parseFloat(n)+1>=0)||e<0)&&(e=0),t&&"function"==typeof t.schedule||(t=M),new O.a((function(n){return n.add(t.schedule(E,e,{subscriber:n,counter:0,period:e})),n}))}function E(e){var t=e.subscriber,n=e.counter,r=e.period;t.next(n),this.schedule({subscriber:t,counter:n+1,period:r},r)}var q=n(39);function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class R{constructor(e){this.substitutions=e,C(this,"simplify",e=>{var{n:t,d0:n,steps:r}=e;return{kind:e.kind,n:t,d0:n,steps:r.map(this.simplifyStepNode)}}),C(this,"simplifyScalar",e=>{switch(e.kind){case"number":return e;case"fn":return this.simplifyFnNode(e);case"access":return this.simplifyAccessNode(e);case"id":return this.simplifyIdNode(e);case"arith":return this.simplifyArithNode(e)}}),C(this,"simplifyStepNode",e=>{var{kind:t,type:n,args:r}=e;return{kind:t,type:n,args:r.map(this.simplifyScalar)}}),C(this,"simplifyArithNode",e=>{var{kind:t,op:n,operands:r}=e,[i,o]=r.map(this.simplifyScalar);return{kind:t,op:n,operands:[i,o]}}),C(this,"simplifyFnNode",e=>{var{kind:t,name:n,args:r}=e;return{kind:t,name:n,args:r.map(this.simplifyIdNode)}}),C(this,"simplifyAccessNode",e=>{var{kind:t,id:n,index:r}=e;return{kind:t,id:n,index:this.simplifyScalar(r)}}),C(this,"simplifyIdNode",e=>{var{id:t}=e;return t in this.substitutions?this.simplifyScalar(this.substitutions[t]):e})}}var T=n(74),V=n(20),F={power:1,chroma:0,tempo:.5,onset:1},L=96,B=n(68),J=n.n(B);function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Y{constructor(e,t){this.dbMin=e,this.dbMax=t}}function Q(e,t,n,r,i,o,s){try{var u=e[o](s),a=u.value}catch(e){return void n(e)}u.done?t(a):Promise.resolve(a).then(r,i)}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}W(Y,"octave",e=>Math.floor(e/12)),W(Y,"chroma",e=>e%12),W(Y,"f",e=>{var t=Y.octave(e),n=Y.chroma(e);return 16.35*2**t*Math.pow(2,1/12)**n});class z{constructor(e,t,n){this.ctx=e,U(this,"close",()=>this.ctx.close());var r=new AudioWorkletNode(e,"power",{numberOfInputs:L,channelCountMode:"explicit",channelCount:1});r.port.onmessage=e=>{V.a.mic.value?n.next(e.data):n.next(F)},r.onprocessorerror=e=>{c(e),V.a.mic.value=!1},r.connect(e.destination),V.a.allowedDbs.stream.subscribe(t=>{var{newValue:[n,i]}=t;r.parameters.get("dbMin").setValueAtTime(n,e.currentTime),r.parameters.get("dbMax").setValueAtTime(i,e.currentTime)});for(var i=0;i<L;i++){var o=Y.f(i),s=new BiquadFilterNode(e,{type:"bandpass",frequency:o,Q:o/2});t.connect(s).connect(r,0,i)}}}function G(e,t,n,r,i,o,s){try{var u=e[o](s),a=u.value}catch(e){return void n(e)}u.done?t(a):Promise.resolve(a).then(r,i)}U(z,"create",function(){var e,t=(e=function*(e,t){var n=new AudioContext;yield n.audioWorklet.addModule(J.a);var r=new MediaStreamAudioSourceNode(n,{mediaStream:e});return new z(n,r,t)},function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){Q(o,r,i,s,u,"next",e)}function u(e){Q(o,r,i,s,u,"throw",e)}s(void 0)}))});return function(e,n){return t.apply(this,arguments)}}());var H,K=Object(r.getLogger)("Audio"),X=new T.a(F),Z=X.asObservable();V.a.mic.stream.subscribe(function(){var e,t=(e=function*(e){var{newValue:t,event:n}=e;if(t){K.info("getting user media");var r=yield navigator.mediaDevices.getUserMedia({audio:!0});K.info("starting new audio graph"),H=yield z.create(r,X)}else K.info("closing audio graph"),H&&(yield H.close()),X.next(F)},function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){G(o,r,i,s,u,"next",e)}function u(e){G(o,r,i,s,u,"throw",e)}s(void 0)}))});return function(e){return t.apply(this,arguments)}}());Math.floor(512);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function te(e,t,n,r,i,o,s){try{var u=e[o](s),a=u.value}catch(e){return void n(e)}u.done?t(a):Promise.resolve(a).then(r,i)}function ne(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){te(o,r,i,s,u,"next",e)}function u(e){te(o,r,i,s,u,"throw",e)}s(void 0)}))}}var re=new i.a,ie=re.asObservable();function oe(e,t,n,r,i,o,s){try{var u=e[o](s),a=u.value}catch(e){return void n(e)}u.done?t(a):Promise.resolve(a).then(r,i)}function se(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){oe(o,r,i,s,u,"next",e)}function u(e){oe(o,r,i,s,u,"throw",e)}s(void 0)}))}}ne((function*(){var e=e=>{var t=new R({theta:e.theta}).simplify(e.pipe);return{pipe:t,scope:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){ee(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({t:e.t,inf:q.a,n:t.n},e.audio),hv:{h:e.h,v:e.v}}},t=0,n=function(){var n=ne((function*(n){try{re.next(e({pipe:V.a.pipe.value,theta:V.a.theta.value,audio:n,h:V.a.h.value,v:V.a.v.value,t:t++/60}))}catch(e){c(e)}}));return function(e){return n.apply(this,arguments)}}();yield n(F);var r=function(){var e=ne((function*(e){V.a.animate.value&&(yield n(e))}));return function(t){return e.apply(this,arguments)}}();(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,r=null,i=null;return(n=e[e.length-1])&&"function"==typeof n.schedule&&(i=e.pop()),"function"==typeof e[e.length-1]&&(r=e.pop()),1===e.length&&Object(f.a)(e[0])&&(e=e[0]),k(e,i).lift(new A(r))})(Z,_(1e3/60)).subscribe(e=>{var[t]=e;return r(t)},c)}))(),n.d(t,"dataStream",(function(){return ce}));var ue=Object(r.getLogger)("Data");ue.setDefaultLevel("info");var ae=new i.a,ce=ae.asObservable(),le=function(){var e=se((function*(){console.info("starting web worker data source"),yield Object(s.c)();return{getData:e=>Object(s.b)(e).then(o.a.fromBuffer)}}));return function(){return e.apply(this,arguments)}}();se((function*(){var e,{getData:t}=yield le(),n=0;ie.subscribe(function(){var r=se((function*(r){if(!e){Object(a.a)("params",r),ue.debug("requesting data with params",r),Date.now()-n>=1e3&&(ue.debug("sending request for data with params ".concat(Object(u.a)(r))),n=Date.now()),e=t(r);try{ae.next(yield e)}catch(e){c(e)}finally{e=null}}}));return function(e){return r.apply(this,arguments)}}(),e=>c(e))}))()},68:function(e,t,n){e.exports=n.p+"eb34d8c1f3aeee04efd5.worklet.js"}}]);
//# sourceMappingURL=5.e924335ecb0b848834c9.js.map